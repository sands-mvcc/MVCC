<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diffie-Hellman Key Exchange - Interactive Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #ffffff;
            color: #000000;
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, #1e7e34 0%, #0056b3 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        nav {
            background-color: #f8f9fa;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
            padding: 0 1rem;
        }

        nav a {
            color: #0056b3;
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
        }

        nav a:hover {
            background-color: #1e7e34;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        section {
            margin-bottom: 4rem;
            padding: 2rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #1e7e34;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            border-bottom: 3px solid #0056b3;
            padding-bottom: 0.5rem;
        }

        h3 {
            color: #0056b3;
            font-size: 1.5rem;
            margin: 1.5rem 0 1rem;
        }

        .highlight-box {
            background-color: #e7f4e4;
            border-left: 4px solid #1e7e34;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box {
            background-color: #e3f2fd;
            border-left: 4px solid #0056b3;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ff9800;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .paint-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .paint-container {
            text-align: center;
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }

        .paint-box {
            width: 100%;
            height: 150px;
            border-radius: 8px;
            margin: 1rem 0;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #000;
            text-shadow: 1px 1px 2px white;
        }

        .color-picker-group {
            margin: 1rem 0;
        }

        .color-picker-group input[type="color"] {
            width: 100%;
            height: 60px;
            border: 2px solid #000;
            border-radius: 4px;
            cursor: pointer;
        }

        .color-picker-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .math-steps {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
        }

        .step-by-step {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #1e7e34;
        }

        .step-number {
            background-color: #1e7e34;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .calculator {
            background-color: #f8f9fa;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
        }

        .input-group {
            margin: 1rem 0;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #0056b3;
        }

        input[type="number"] {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #dee2e6;
            border-radius: 4px;
            font-size: 1rem;
        }

        button {
            background-color: #1e7e34;
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }

        button:hover {
            background-color: #155d27;
        }

        .reset-btn {
            background-color: #0056b3;
        }

        .reset-btn:hover {
            background-color: #004085;
        }

        .result-box {
            background-color: #d4edda;
            border: 2px solid #1e7e34;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .result-box h4 {
            color: #1e7e34;
            margin-bottom: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            background-color: #1e7e34;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .concept-card {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-top: 4px solid #0056b3;
        }

        .concept-card h4 {
            color: #1e7e34;
            margin-bottom: 0.5rem;
        }

        .security-indicator {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin: 0.5rem 0;
        }

        .indicator-icon {
            font-size: 2rem;
        }

        footer {
            background-color: #1e7e34;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            nav ul {
                flex-direction: column;
                gap: 0.5rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .paint-demo {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>üîê Diffie-Hellman Key Exchange</h1>
        <p>Secure Key Establishment Over Insecure Channels</p>
    </header>

    <nav>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#analogy">Paint Analogy</a></li>
            <li><a href="#mathematics">Mathematics</a></li>
            <li><a href="#steps">Step-by-Step</a></li>
            <li><a href="#calculator">Interactive Calculator</a></li>
            <li><a href="#applications">Real-World Uses</a></li>
            <li><a href="#security">Security</a></li>
        </ul>
    </nav>

    <div class="container">
        <section id="overview">
            <h2>What is Diffie-Hellman Key Exchange?</h2>
            
            <p>The Diffie-Hellman Key Exchange is a revolutionary cryptographic protocol published in 1976 by Whitfield Diffie and Martin Hellman. It allows two parties who have never met before to establish a shared secret key over an insecure communication channel.</p>

            <div class="highlight-box">
                <h3>üéØ Key Problem It Solves</h3>
                <p><strong>The Challenge:</strong> How can Alice and Bob create a shared secret key for encrypted communication when they can only communicate over a public channel that may be monitored by eavesdroppers?</p>
                <p><strong>The Solution:</strong> They exchange public information that allows each to independently calculate the same shared secret, without ever transmitting that secret.</p>
            </div>

            <div class="concept-grid">
                <div class="concept-card">
                    <h4>üîì Public Information</h4>
                    <p>Information that can be shared openly without compromising security (like the base color in paint mixing).</p>
                </div>
                <div class="concept-card">
                    <h4>üîê Private Keys</h4>
                    <p>Secret values known only to each party (like each person's secret color).</p>
                </div>
                <div class="concept-card">
                    <h4>üîë Shared Secret</h4>
                    <p>The final value that both parties compute independently but arrive at the same result.</p>
                </div>
                <div class="concept-card">
                    <h4>‚ö° One-Way Function</h4>
                    <p>Mathematical operations that are easy to compute but extremely difficult to reverse.</p>
                </div>
            </div>
        </section>

        <section id="analogy">
            <h2>Understanding Through Paint Mixing</h2>
            
            <p>The best way to understand Diffie-Hellman is through a paint mixing analogy. Imagine mixing paint colors is easy, but separating mixed colors back to their original components is nearly impossible.</p>

            <h3>The Scenario</h3>
            <p>Alice and Bob want to create a shared secret color, but Eve (an eavesdropper) is watching everything they send to each other.</p>

            <div class="info-box">
                <h4>üé® Try it yourself!</h4>
                <p>Select colors below to see how the mixing works. Notice how both Alice and Bob arrive at the same final color!</p>
            </div>

            <div id="paintDemo" class="paint-demo">
                <!-- Will be populated by JavaScript -->
            </div>

            <div class="step-by-step">
                <div class="step">
                    <div class="step-number">1</div>
                    <div>
                        <h4>Agree on Public Color</h4>
                        <p>Alice and Bob publicly agree on a common starting color (e.g., yellow). This is shared openly, and Eve knows it too.</p>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">2</div>
                    <div>
                        <h4>Choose Secret Colors</h4>
                        <p>Alice secretly chooses red. Bob secretly chooses blue. They never share these secret colors with anyone.</p>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">3</div>
                    <div>
                        <h4>Mix and Exchange</h4>
                        <p>Alice mixes yellow + red = orange, sends orange to Bob. Bob mixes yellow + blue = green, sends green to Alice. Eve sees both mixtures but can't easily determine the secret colors.</p>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">4</div>
                    <div>
                        <h4>Final Mix - Shared Secret!</h4>
                        <p>Alice adds her secret red to Bob's green = brown. Bob adds his secret blue to Alice's orange = brown. They both arrive at the same color without ever directly sharing it!</p>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <strong>Why Eve Can't Figure It Out:</strong> Even though Eve saw the public yellow, the orange from Alice, and the green from Bob, she cannot easily "unmix" these colors to find Alice's red or Bob's blue. Therefore, she cannot recreate the final brown color.
            </div>
        </section>

        <section id="mathematics">
            <h2>The Mathematics Behind It</h2>
            
            <p>Diffie-Hellman uses <strong>modular exponentiation</strong> and relies on the difficulty of the <strong>discrete logarithm problem</strong> to ensure security.</p>

            <h3>üî¢ Core Concepts</h3>
            
            <div class="concept-grid">
                <div class="concept-card">
                    <h4>Prime Number (p)</h4>
                    <p>A large prime number that defines the modulus for all calculations. Typical size: 2048 bits or larger.</p>
                </div>
                <div class="concept-card">
                    <h4>Generator (g)</h4>
                    <p>A primitive root modulo p. A smaller number (often 2 or 5) used as the base for exponentials.</p>
                </div>
                <div class="concept-card">
                    <h4>Private Keys (a, b)</h4>
                    <p>Secret random numbers chosen independently by Alice and Bob.</p>
                </div>
                <div class="concept-card">
                    <h4>Public Keys (A, B)</h4>
                    <p>Values calculated and shared publicly: A = g^a mod p, B = g^b mod p</p>
                </div>
            </div>

            <h3>üìê Mathematical Process</h3>
            
            <div class="math-steps">
                <p><strong>Public Parameters (agreed by both parties):</strong></p>
                <p>‚Ä¢ p = large prime number (e.g., 23)</p>
                <p>‚Ä¢ g = generator (e.g., 5)</p>
                <br>
                <p><strong>Alice's Calculations:</strong></p>
                <p>1. Choose secret: a = 6 (private)</p>
                <p>2. Calculate: A = g^a mod p = 5^6 mod 23 = 8 (public)</p>
                <p>3. Receive B from Bob</p>
                <p>4. Calculate shared secret: s = B^a mod p</p>
                <br>
                <p><strong>Bob's Calculations:</strong></p>
                <p>1. Choose secret: b = 15 (private)</p>
                <p>2. Calculate: B = g^b mod p = 5^15 mod 23 = 19 (public)</p>
                <p>3. Receive A from Alice</p>
                <p>4. Calculate shared secret: s = A^b mod p</p>
                <br>
                <p><strong>The Magic:</strong></p>
                <p>Both calculate the same value!</p>
                <p>Alice: s = B^a mod p = 19^6 mod 23 = 2</p>
                <p>Bob: s = A^b mod p = 8^15 mod 23 = 2</p>
                <p><strong>Because: (g^a)^b = (g^b)^a = g^(ab) mod p</strong></p>
            </div>

            <div class="highlight-box">
                <h4>üõ°Ô∏è The Discrete Logarithm Problem</h4>
                <p>The security relies on this being hard: Given g, p, and A = g^a mod p, find the secret value 'a'.</p>
                <p>For small numbers this is easy, but with 2048-bit primes, it's computationally infeasible with current technology (except quantum computers).</p>
            </div>
        </section>

        <section id="steps">
            <h2>Step-by-Step Protocol</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Step</th>
                        <th>Action</th>
                        <th>Public Knowledge</th>
                        <th>Secret Knowledge</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Alice and Bob agree on p and g</td>
                        <td>p, g</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Alice chooses secret a</td>
                        <td>p, g</td>
                        <td>Alice knows: a</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Bob chooses secret b</td>
                        <td>p, g</td>
                        <td>Alice knows: a<br>Bob knows: b</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Alice calculates A = g^a mod p</td>
                        <td>p, g</td>
                        <td>Alice knows: a, A<br>Bob knows: b</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Bob calculates B = g^b mod p</td>
                        <td>p, g</td>
                        <td>Alice knows: a, A<br>Bob knows: b, B</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Alice sends A to Bob</td>
                        <td>p, g, A</td>
                        <td>Alice knows: a, A<br>Bob knows: b, B</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>Bob sends B to Alice</td>
                        <td>p, g, A, B</td>
                        <td>Alice knows: a, A, B<br>Bob knows: b, A, B</td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>Alice calculates s = B^a mod p</td>
                        <td>p, g, A, B</td>
                        <td>Alice knows: a, s<br>Bob knows: b</td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>Bob calculates s = A^b mod p</td>
                        <td>p, g, A, B</td>
                        <td>Alice knows: a, s<br>Bob knows: b, s</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>Shared secret established!</td>
                        <td>p, g, A, B</td>
                        <td>Both know: s (same value!)</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>‚ö†Ô∏è What Eve (Eavesdropper) Knows:</strong> Eve can see p, g, A, and B. However, to find the shared secret s, she would need to solve for either 'a' or 'b', which requires solving the discrete logarithm problem - computationally infeasible for large numbers.
            </div>
        </section>

        <section id="calculator">
            <h2>Interactive Diffie-Hellman Calculator</h2>
            
            <p>Try it yourself! Enter small numbers to see how the algorithm works. In practice, much larger numbers (2048+ bits) are used for security.</p>

            <div class="calculator">
                <h3>Public Parameters</h3>
                <div class="input-group">
                    <label for="prime">Prime Number (p):</label>
                    <input type="number" id="prime" value="23" min="2">
                    <small>Choose a prime number (e.g., 23, 29, 31, 37, 41)</small>
                </div>
                
                <div class="input-group">
                    <label for="generator">Generator (g):</label>
                    <input type="number" id="generator" value="5" min="2">
                    <small>Choose a generator (e.g., 2, 3, 5)</small>
                </div>

                <h3>Private Keys</h3>
                <div class="input-group">
                    <label for="aliceSecret">Alice's Secret (a):</label>
                    <input type="number" id="aliceSecret" value="6" min="1">
                    <small>Alice's private random number</small>
                </div>
                
                <div class="input-group">
                    <label for="bobSecret">Bob's Secret (b):</label>
                    <input type="number" id="bobSecret" value="15" min="1">
                    <small>Bob's private random number</small>
                </div>

                <button onclick="calculate()">Calculate Exchange</button>
                <button class="reset-btn" onclick="resetCalculator()">Reset</button>

                <div id="results"></div>
            </div>
        </section>

        <section id="applications">
            <h2>Real-World Applications</h2>
            
            <p>Diffie-Hellman is fundamental to modern internet security and is used in many protocols you interact with daily:</p>

            <div class="concept-grid">
                <div class="concept-card">
                    <h4>üåê TLS/SSL (HTTPS)</h4>
                    <p>Secures web browsing by establishing encryption keys between your browser and websites.</p>
                </div>
                <div class="concept-card">
                    <h4>üîí VPNs (IPsec)</h4>
                    <p>Creates secure tunnels for corporate networks and private internet access.</p>
                </div>
                <div class="concept-card">
                    <h4>üí¨ Secure Messaging</h4>
                    <p>WhatsApp, Signal, and other apps use variants (like ECDH) for end-to-end encryption.</p>
                </div>
                <div class="concept-card">
                    <h4>üîë SSH</h4>
                    <p>Secures remote server access and file transfers (SFTP).</p>
                </div>
                <div class="concept-card">
                    <h4>üìß Email Encryption</h4>
                    <p>PGP and S/MIME protocols use DH for secure key exchange.</p>
                </div>
                <div class="concept-card">
                    <h4>üìû VoIP</h4>
                    <p>Secures voice and video calls over the internet.</p>
                </div>
            </div>

            <h3>üöÄ Modern Variants</h3>
            <div class="info-box">
                <p><strong>Elliptic Curve Diffie-Hellman (ECDH):</strong> Uses elliptic curve mathematics instead of modular exponentiation. Provides equivalent security with much smaller key sizes (256-bit ECDH ‚âà 3072-bit DH), making it faster and more efficient.</p>
                <p><strong>Ephemeral Diffie-Hellman (DHE/EDH):</strong> Generates new key pairs for each session, providing forward secrecy - even if long-term keys are compromised, past sessions remain secure.</p>
            </div>
        </section>

        <section id="security">
            <h2>Security Considerations</h2>
            
            <h3>‚úÖ Strengths</h3>
            <div class="security-indicator">
                <div class="indicator-icon">üõ°Ô∏è</div>
                <div>
                    <strong>Forward Secrecy</strong>
                    <p>When using ephemeral keys, compromising one session doesn't affect others.</p>
                </div>
            </div>

            <div class="security-indicator">
                <div class="indicator-icon">üîê</div>
                <div>
                    <strong>No Prior Communication Required</strong>
                    <p>Two parties who've never met can establish a shared secret.</p>
                </div>
            </div>

            <div class="security-indicator">
                <div class="indicator-icon">‚ö°</div>
                <div>
                    <strong>Computationally Efficient</strong>
                    <p>Fast to compute, even with large numbers.</p>
                </div>
            </div>

            <h3>‚ö†Ô∏è Vulnerabilities and Limitations</h3>
            
            <div class="warning-box">
                <h4>1. Man-in-the-Middle (MITM) Attacks</h4>
                <p><strong>The Problem:</strong> Basic Diffie-Hellman provides no authentication. An attacker could intercept communications and establish separate key exchanges with both parties.</p>
                <p><strong>The Solution:</strong> Use authentication mechanisms like digital signatures (RSA), certificates (PKI), or pre-shared keys (PSK) to verify identities.</p>
            </div>

            <div class="warning-box">
                <h4>2. Small Subgroup Attacks</h4>
                <p><strong>The Problem:</strong> If parameters are chosen poorly, attackers can exploit mathematical weaknesses.</p>
                <p><strong>The Solution:</strong> Use standardized DH groups (RFC 3526, RFC 7919) with validated parameters.</p>
            </div>

            <div class="warning-box">
                <h4>3. Quantum Computing Threat</h4>
                <p><strong>The Problem:</strong> Quantum computers running Shor's algorithm could solve the discrete logarithm problem efficiently.</p>
                <p><strong>The Solution:</strong> Post-quantum cryptography research is developing quantum-resistant alternatives.</p>
            </div>

            <div class="warning-box">
                <h4>4. Weak Parameters</h4>
                <p><strong>The Problem:</strong> Keys under 2048 bits are vulnerable to specialized attacks (like Logjam).</p>
                <p><strong>The Solution:</strong> Use minimum 2048-bit keys; 3072-bit or 4096-bit for high-security applications.</p>
            </div>

            <h3>üîí Best Practices</h3>
            <ul style="margin-left: 2rem; margin-top: 1rem;">
                <li>Use standardized DH groups with proven security properties</li>
                <li>Implement authentication to prevent MITM attacks</li>
                <li>Use ephemeral keys (DHE/ECDHE) for forward secrecy</li>
                <li>Prefer ECDH when performance matters (mobile, IoT)</li>
                <li>Use minimum 2048-bit keys for classical DH</li>
                <li>Regularly update cryptographic libraries</li>
                <li>Consider post-quantum alternatives for long-term security</li>
            </ul>
        </section>

        <section>
            <h2>Key Takeaways</h2>
            
            <div class="highlight-box">
                <h3>üéì What You Should Remember</h3>
                <ol style="margin-left: 2rem; line-height: 2;">
                    <li><strong>Purpose:</strong> Diffie-Hellman enables two parties to create a shared secret over an insecure channel</li>
                    <li><strong>Security:</strong> Based on the difficulty of discrete logarithm problem</li>
                    <li><strong>Process:</strong> Exchange public values, compute shared secret independently</li>
                    <li><strong>Limitation:</strong> Doesn't provide authentication - must be combined with other methods</li>
                    <li><strong>Applications:</strong> Foundation of modern secure communications (TLS, VPNs, messaging)</li>
                    <li><strong>Evolution:</strong> Modern variants like ECDH provide better efficiency</li>
                </ol>
            </div>

            <div class="info-box">
                <h4>üìö Further Learning</h4>
                <p>To deepen your understanding, explore these topics:</p>
                <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                    <li>Modular arithmetic and number theory</li>
                    <li>Cyclic groups and primitive roots</li>
                    <li>Elliptic curve cryptography</li>
                    <li>Public Key Infrastructure (PKI)</li>
                    <li>Post-quantum cryptography</li>
                </ul>
            </div>
        </section>
    </div>

    <footer>
        <p>&copy; 2025 Diffie-Hellman Educational Resource | Cybersecurity & AI Training</p>
        <p>Created for educational purposes in cryptography and network security</p>
    </footer>

    <script>
        // Paint mixing demo with interactive colors
        let publicColor = '#FFD700'; // Yellow
        let aliceSecret = '#DC143C'; // Red
        let bobSecret = '#1E90FF'; // Blue

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        function mixColors(color1, color2) {
            const rgb1 = hexToRgb(color1);
            const rgb2 = hexToRgb(color2);
            
            // Average the RGB values
            const r = Math.round((rgb1.r + rgb2.r) / 2);
            const g = Math.round((rgb1.g + rgb2.g) / 2);
            const b = Math.round((rgb1.b + rgb2.b) / 2);
            
            return rgbToHex(r, g, b);
        }

        function getContrastColor(hexColor) {
            const rgb = hexToRgb(hexColor);
            const brightness = (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
            return brightness > 128 ? '#000000' : '#FFFFFF';
        }

        function updatePaintDemo() {
            // Calculate mixed colors
            const aliceMix = mixColors(publicColor, aliceSecret);
            const bobMix = mixColors(publicColor, bobSecret);
            const aliceFinal = mixColors(bobMix, aliceSecret);
            const bobFinal = mixColors(aliceMix, bobSecret);

            const demoHTML = `
                <div class="paint-container">
                    <h4>üé® Public Color</h4>
                    <div class="color-picker-group">
                        <label>Choose public color:</label>
                        <input type="color" id="publicColorPicker" value="${publicColor}">
                    </div>
                    <div class="paint-box" style="background-color: ${publicColor}; color: ${getContrastColor(publicColor)};">
                        Public Color
                    </div>
                    <p><strong>Everyone knows this</strong></p>
                </div>
                
                <div class="paint-container">
                    <h4>üë§ Alice</h4>
                    <div class="color-picker-group">
                        <label>Alice's secret color:</label>
                        <input type="color" id="aliceColorPicker" value="${aliceSecret}">
                    </div>
                    <div class="paint-box" style="background-color: ${aliceSecret}; color: ${getContrastColor(aliceSecret)};">
                        Alice's Secret
                    </div>
                    <p><strong>Only Alice knows ‚Üì</strong></p>
                    <div class="paint-box" style="background-color: ${aliceMix}; color: ${getContrastColor(aliceMix)};">
                        Public + Alice's Secret
                    </div>
                    <p><strong>Sends to Bob ‚Üí</strong></p>
                </div>
                
                <div class="paint-container">
                    <h4>üë§ Bob</h4>
                    <div class="color-picker-group">
                        <label>Bob's secret color:</label>
                        <input type="color" id="bobColorPicker" value="${bobSecret}">
                    </div>
                    <div class="paint-box" style="background-color: ${bobSecret}; color: ${getContrastColor(bobSecret)};">
                        Bob's Secret
                    </div>
                    <p><strong>Only Bob knows ‚Üì</strong></p>
                    <div class="paint-box" style="background-color: ${bobMix}; color: ${getContrastColor(bobMix)};">
                        Public + Bob's Secret
                    </div>
                    <p><strong>Sends to Alice ‚Üí</strong></p>
                </div>
                
                <div class="paint-container">
                    <h4>üîê Shared Secret</h4>
                    <div class="paint-box" style="background-color: ${aliceFinal}; color: ${getContrastColor(aliceFinal)};">
                        Alice's Final Mix
                    </div>
                    <p><strong>Alice:</strong> Bob's Mix + Alice's Secret</p>
                    <div class="paint-box" style="background-color: ${bobFinal}; color: ${getContrastColor(bobFinal)};">
                        Bob's Final Mix
                    </div>
                    <p><strong>Bob:</strong> Alice's Mix + Bob's Secret</p>
                    ${aliceFinal === bobFinal ? 
                        '<p style="color: #1e7e34; font-weight: bold; font-size: 1.1rem;">‚úÖ Same color! Shared secret established! üéâ</p>' : 
                        '<p style="color: #dc3545; font-weight: bold;">‚ö†Ô∏è Colors are very similar (due to mixing algorithm)</p>'}
                </div>
            `;
            
            document.getElementById('paintDemo').innerHTML = demoHTML;

            // Add event listeners to color pickers
            setTimeout(() => {
                document.getElementById('publicColorPicker').addEventListener('input', (e) => {
                    publicColor = e.target.value;
                    updatePaintDemo();
                });
                
                document.getElementById('aliceColorPicker').addEventListener('input', (e) => {
                    aliceSecret = e.target.value;
                    updatePaintDemo();
                });
                
                document.getElementById('bobColorPicker').addEventListener('input', (e) => {
                    bobSecret = e.target.value;
                    updatePaintDemo();
                });
            }, 0);
        }

        function initPaintDemo() {
            updatePaintDemo();
        }

        // Modular exponentiation function
        function modPow(base, exponent, modulus) {
            if (modulus === 1) return 0;
            let result = 1;
            base = base % modulus;
            while (exponent > 0) {
                if (exponent % 2 === 1) {
                    result = (result * base) % modulus;
                }
                exponent = Math.floor(exponent / 2);
                base = (base * base) % modulus;
            }
            return result;
        }

        // Check if number is prime
        function isPrime(n) {
            if (n <= 1) return false;
            if (n <= 3) return true;
            if (n % 2 === 0 || n % 3 === 0) return false;
            for (let i = 5; i * i <= n; i += 6) {
                if (n % i === 0 || n % (i + 2) === 0) return false;
            }
            return true;
        }

        function calculate() {
            const p = parseInt(document.getElementById('prime').value);
            const g = parseInt(document.getElementById('generator').value);
            const a = parseInt(document.getElementById('aliceSecret').value);
            const b = parseInt(document.getElementById('bobSecret').value);

            // Validation
            if (!isPrime(p)) {
                alert('Please enter a prime number for p!');
                return;
            }

            if (g >= p || g < 2) {
                alert('Generator g must be between 2 and p-1!');
                return;
            }

            if (a >= p || a < 1) {
                alert('Alice\'s secret must be between 1 and p-1!');
                return;
            }

            if (b >= p || b < 1) {
                alert('Bob\'s secret must be between 1 and p-1!');
                return;
            }

            // Calculate public keys
            const A = modPow(g, a, p);
            const B = modPow(g, b, p);

            // Calculate shared secrets
            const aliceShared = modPow(B, a, p);
            const bobShared = modPow(A, b, p);

            // Display results
            const resultsHTML = `
                <div class="result-box">
                    <h4>üìä Calculation Results</h4>
                    
                    <h4 style="color: #0056b3; margin-top: 1.5rem;">Public Parameters:</h4>
                    <p><strong>Prime (p):</strong> ${p}</p>
                    <p><strong>Generator (g):</strong> ${g}</p>
                    
                    <h4 style="color: #0056b3; margin-top: 1.5rem;">Alice's Calculations:</h4>
                    <p><strong>Private Key (a):</strong> ${a} üîí</p>
                    <p><strong>Public Key (A):</strong> g^a mod p = ${g}^${a} mod ${p} = <strong>${A}</strong> üì¢</p>
                    <p><strong>Shared Secret:</strong> B^a mod p = ${B}^${a} mod ${p} = <strong>${aliceShared}</strong> üéØ</p>
                    
                    <h4 style="color: #0056b3; margin-top: 1.5rem;">Bob's Calculations:</h4>
                    <p><strong>Private Key (b):</strong> ${b} üîí</p>
                    <p><strong>Public Key (B):</strong> g^b mod p = ${g}^${b} mod ${p} = <strong>${B}</strong> üì¢</p>
                    <p><strong>Shared Secret:</strong> A^b mod p = ${A}^${b} mod ${p} = <strong>${bobShared}</strong> üéØ</p>
                    
                    <h4 style="color: #1e7e34; margin-top: 1.5rem;">‚úÖ Result:</h4>
                    ${aliceShared === bobShared ? 
                        `<p style="font-size: 1.2rem; color: #1e7e34;"><strong>SUCCESS! Both parties computed the same shared secret: ${aliceShared}</strong></p>
                        <p>This shared secret can now be used as an encryption key! üîê</p>` :
                        `<p style="color: red;"><strong>ERROR: Shared secrets don't match!</strong></p>`
                    }
                    
                    <h4 style="color: #ff9800; margin-top: 1.5rem;">üïµÔ∏è What Eve Knows:</h4>
                    <p>Eve (eavesdropper) can see: p = ${p}, g = ${g}, A = ${A}, B = ${B}</p>
                    <p>But Eve does NOT know: a = ${a}, b = ${b}, or shared secret = ${aliceShared}</p>
                    <p>To find the shared secret, Eve would need to solve the discrete logarithm problem!</p>
                </div>
            `;

            document.getElementById('results').innerHTML = resultsHTML;
        }

        function resetCalculator() {
            document.getElementById('prime').value = 23;
            document.getElementById('generator').value = 5;
            document.getElementById('aliceSecret').value = 6;
            document.getElementById('bobSecret').value = 15;
            document.getElementById('results').innerHTML = '';
        }

        // Initialize on page load
        window.onload = function() {
            initPaintDemo();
        };

        // Smooth scrolling for navigation
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });
    </script>
</body>
</html>
