<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reed-Kellogg Master Lab</title>
    <style>
        :root { --green: #2e7d32; --black: #1a1a1a; --white: #ffffff; --gray: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: var(--white); color: var(--black); }
        
        header { background: var(--black); color: white; padding: 1rem; border-bottom: 5px solid var(--green); text-align: center; }
        
        /* Layout */
        .app-wrapper { display: grid; grid-template-columns: 320px 1fr; height: 90vh; }
        
        /* Left Glossary Sidebar */
        .sidebar { background: var(--gray); border-right: 2px solid var(--black); overflow-y: auto; padding: 1rem; }
        .comp-item { background: white; border: 1px solid #ccc; margin-bottom: 10px; padding: 10px; border-radius: 4px; }
        .comp-item h4 { margin: 0 0 5px 0; color: var(--green); font-size: 0.9rem; }
        .symbol { font-family: monospace; font-weight: bold; background: #eee; padding: 2px 4px; }

        /* Main Workspace */
        .workspace { display: flex; flex-direction: column; padding: 1.5rem; position: relative; }
        
        /* Mode Switcher */
        .mode-nav { display: flex; gap: 5px; margin-bottom: 1rem; }
        .mode-btn { flex: 1; padding: 12px; border: 1px solid var(--black); cursor: pointer; font-weight: bold; background: white; }
        .mode-btn.active { background: var(--green); color: white; border: none; }

        #canvas-container { 
            flex: 1; border: 2px solid var(--black); position: relative; background: white;
            background-image: radial-gradient(#ccc 1px, transparent 1px); background-size: 30px 30px;
        }
        
        /* Diagram Elements */
        .drop-target { position: absolute; border: 2px dashed #aaa; width: 120px; height: 40px; pointer-events: none; opacity: 0.5; display: none; }
        .word-token { position: absolute; padding: 8px 15px; background: white; border: 2px solid var(--black); cursor: grab; font-weight: bold; z-index: 100; }
        
        /* Control Bar */
        .controls { padding: 1rem; background: var(--gray); border-top: 1px solid #ccc; display: flex; justify-content: space-between; align-items: center; }
        .msg { font-weight: bold; color: var(--green); }
        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <h1>The Syntax Architect: Reed-Kellogg Laboratory</h1>
</header>

<div class="app-wrapper">
    <aside class="sidebar">
        <h3>Glossary of Symbols</h3>
        <div class="comp-item">
            <h4>Main Baseline <span class="symbol">━</span></h4>
            <p>Horizontal spine for Subject/Verb/Object.</p>
        </div>
        <div class="comp-item">
            <h4>Subj/Pred Divider <span class="symbol">┼</span></h4>
            <p>Full vertical line crossing the baseline.</p>
        </div>
        <div class="comp-item">
            <h4>Direct Object <span class="symbol">┬</span></h4>
            <p>Vertical line stopping at the baseline.</p>
        </div>
        <div class="comp-item">
            <h4>Predicate Adj/Noun <span class="symbol">\</span></h4>
            <p>Slanted line leaning toward the subject.</p>
        </div>
        <div class="comp-item">
            <h4>Indirect Object <span class="symbol">└</span></h4>
            <p>A "shelf" suspended below the verb.</p>
        </div>
        <div class="comp-item">
            <h4>Gerund Structure <span class="symbol">⎴</span></h4>
            <p>A pedestal "step" for -ing verbals.</p>
        </div>
        <div class="comp-item">
            <h4>Infinitive <span class="symbol">/\</span></h4>
            <p>A stilt structure for "to + verb".</p>
        </div>
    </aside>

    <main class="workspace">
        <div class="mode-nav">
            <button class="mode-btn active" onclick="setMode('tutorial')">1. TUTORIAL</button>
            <button class="mode-btn" onclick="setMode('build')">2. BUILD</button>
            <button class="mode-btn" onclick="setMode('assess')">3. ASSESSMENT</button>
        </div>

        <div id="instruction-bar" style="background:#e8f5e9; padding:10px; border:1px solid var(--green); margin-bottom:10px;">
            <strong>Guide:</strong> <span id="guide-text">Welcome! Click the modes above to begin.</span>
        </div>

        <div id="canvas-container">
            <svg id="svg-layer" style="position:absolute; width:100%; height:100%;">
                <line x1="50" y1="250" x2="700" y2="250" stroke="black" stroke-width="3" /> <line id="div-full" x1="300" y1="210" x2="300" y2="290" stroke="black" stroke-width="2" />
                <line id="div-half" x1="500" y1="210" x2="500" y2="250" stroke="black" stroke-width="2" class="hidden" />
            </svg>
            
            <div id="zone-subj" class="drop-target" style="top:205px; left:120px;">SUBJECT</div>
            <div id="zone-verb" class="drop-target" style="top:205px; left:350px;">VERB</div>
            <div id="zone-obj" class="drop-target" style="top:205px; left:550px;">OBJECT</div>

            <div id="word-bank"></div>
        </div>

        <div class="controls">
            <div id="feedback-msg" class="msg"></div>
            <div>
                <button class="mode-btn" style="width:auto; padding:8px 20px;" onclick="checkDiagram()">Verify Structure</button>
                <button class="mode-btn" style="width:auto; padding:8px 20px;" onclick="resetWords()">Reset Words</button>
            </div>
        </div>
    </main>
</div>

<script>
    const state = {
        mode: 'tutorial',
        currentSentence: {
            text: "Professor teaches AI.",
            words: ["Professor", "teaches", "AI"],
            targets: { "Professor": "zone-subj", "teaches": "zone-verb", "AI": "zone-obj" }
        }
    };

    function setMode(m) {
        state.mode = m;
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        
        const targets = document.querySelectorAll('.drop-target');
        const guide = document.getElementById('guide-text');
        
        if(m === 'tutorial') {
            guide.innerText = "In Reed-Kellogg, the Subject is left of the divider, Verb is right. This sentence is SVO.";
            targets.forEach(t => t.style.display = 'none');
            document.getElementById('div-half').classList.remove('hidden');
        } else if (m === 'build') {
            guide.innerText = "Drag the words to the dashed boxes. Notice the Direct Object line stops at the baseline.";
            targets.forEach(t => t.style.display = 'flex');
            document.getElementById('div-half').classList.remove('hidden');
        } else {
            guide.innerText = "ASSESSMENT: The guide lines and boxes are now hidden. Place the words correctly!";
            targets.forEach(t => t.style.display = 'none');
            document.getElementById('div-half').classList.remove('hidden');
        }
        resetWords();
    }

    function resetWords() {
        const bank = document.getElementById('word-bank');
        bank.innerHTML = '';
        state.currentSentence.words.forEach((w, i) => {
            const div = document.createElement('div');
            div.className = 'word-token';
            div.innerText = w;
            div.id = 'word-' + w;
            div.style.top = (50 + (i * 50)) + 'px';
            div.style.left = '50px';
            makeDraggable(div);
            bank.appendChild(div);
        });
        document.getElementById('feedback-msg').innerText = "";
    }

    function checkDiagram() {
        let correctCount = 0;
        const total = Object.keys(state.currentSentence.targets).length;
        
        for (let word in state.currentSentence.targets) {
            const wordEl = document.getElementById('word-' + word);
            const targetEl = document.getElementById(state.currentSentence.targets[word]);
            
            const wRect = wordEl.getBoundingClientRect();
            const tRect = targetEl.getBoundingClientRect();
            
            // Check if center of word is within target area
            if (wRect.left > tRect.left - 50 && wRect.left < tRect.left + 50 &&
                wRect.top > tRect.top - 50 && wRect.top < tRect.top + 50) {
                correctCount++;
            }
        }

        const msg = document.getElementById('feedback-msg');
        if(correctCount === total) {
            msg.style.color = "green";
            msg.innerText = "Structure Correct! You have mastered this pattern.";
        } else {
            msg.style.color = "red";
            msg.innerText = "Structure Incomplete. Review the Glossary symbols.";
        }
    }

    function makeDraggable(el) {
        let p1 = 0, p2 = 0, p3 = 0, p4 = 0;
        el.onmousedown = (e) => {
            e.preventDefault();
            p3 = e.clientX; p4 = e.clientY;
            document.onmouseup = () => { document.onmouseup = null; document.onmousemove = null; };
            document.onmousemove = (e) => {
                p1 = p3 - e.clientX; p2 = p4 - e.clientY;
                p3 = e.clientX; p4 = e.clientY;
                el.style.top = (el.offsetTop - p2) + "px";
                el.style.left = (el.offsetLeft - p1) + "px";
            };
        };
    }

    // Init
    resetWords();
</script>

</body>
</html>
