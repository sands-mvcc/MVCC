<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WannaCry Ransomware Attack: Interactive Learning Module</title>
    <style>
        /* CSS Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-color: #ecf0f1;
            --text-color: #2c3e50;
            --border-color: #bdc3c7;
            --hover-color: #34495e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--hover-color));
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: var(--secondary-color);
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Navigation Tab Styles */
        .tab-navigation {
            background-color: var(--primary-color);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 0;
            list-style: none;
            border-bottom: 3px solid var(--secondary-color);
        }

        .tab-button {
            background: none;
            border: none;
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-bottom: -3px;
        }

        .tab-button:hover {
            background-color: var(--hover-color);
        }

        .tab-button:focus {
            outline: 2px solid var(--warning-color);
            outline-offset: -2px;
        }

        .tab-button.active {
            background-color: white;
            color: var(--primary-color);
            border-bottom-color: var(--secondary-color);
            font-weight: bold;
        }

        /* Content Area Styles */
        .content-area {
            padding: 30px;
            min-height: 400px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typography */
        h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-color);
        }

        h3 {
            color: var(--hover-color);
            margin-top: 25px;
            margin-bottom: 15px;
        }

        h4 {
            color: var(--primary-color);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
        }

        /* Timeline Styles */
        .timeline {
            position: relative;
            padding-left: 30px;
            margin: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--accent-color);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 25px;
            padding-left: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -33px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--secondary-color);
            border: 3px solid white;
            box-shadow: 0 0 0 3px var(--accent-color);
        }

        .timeline-date {
            font-weight: bold;
            color: var(--secondary-color);
            margin-bottom: 5px;
        }

        .timeline-content {
            background: var(--bg-color);
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid var(--accent-color);
        }

        /* Collapsible Sections */
        .collapsible {
            background-color: var(--accent-color);
            color: white;
            cursor: pointer;
            padding: 12px 20px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1em;
            margin-top: 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .collapsible:hover {
            background-color: var(--hover-color);
        }

        .collapsible:focus {
            outline: 2px solid var(--warning-color);
        }

        .collapsible::after {
            content: '▼';
            font-size: 0.8em;
            transition: transform 0.3s;
        }

        .collapsible.active::after {
            transform: rotate(-180deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background-color: #f8f9fa;
            border-left: 3px solid var(--accent-color);
            margin-bottom: 10px;
        }

        .collapsible-content-inner {
            padding: 15px 20px;
        }

        /* Info Boxes */
        .info-box {
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }

        .info-box.critical {
            background-color: #fee;
            border-color: var(--secondary-color);
        }

        .info-box.warning {
            background-color: #fef8e7;
            border-color: var(--warning-color);
        }

        .info-box.info {
            background-color: #e8f4f8;
            border-color: var(--accent-color);
        }

        .info-box.success {
            background-color: #e8f8f0;
            border-color: var(--success-color);
        }

        /* Code and Technical Blocks */
        .code-block {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
        }

        .code-block code {
            display: block;
            white-space: pre;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: var(--bg-color);
        }

        /* Lists */
        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 8px 0;
        }

        /* Interactive Map */
        .map-container {
            margin: 20px 0;
            padding: 20px;
            background: var(--bg-color);
            border-radius: 5px;
        }

        .region {
            cursor: pointer;
            transition: all 0.3s;
        }

        .region:hover {
            opacity: 0.7;
        }

        .region:focus {
            outline: 2px solid var(--warning-color);
        }

        .map-legend {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
        }

        .legend-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 10px;
        }

        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: middle;
            border-radius: 3px;
        }

        /* Quiz Styles */
        .quiz-container {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .question {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid var(--accent-color);
        }

        .question h4 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .quiz-option {
            display: block;
            margin: 10px 0;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .quiz-option:hover {
            background-color: var(--bg-color);
        }

        .quiz-option input[type="radio"] {
            margin-right: 10px;
            cursor: pointer;
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .quiz-feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .quiz-feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .submit-quiz {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .submit-quiz:hover {
            background-color: var(--hover-color);
        }

        .submit-quiz:focus {
            outline: 2px solid var(--warning-color);
        }

        .quiz-results {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 5px;
            text-align: center;
            display: none;
        }

        .quiz-score {
            font-size: 3em;
            font-weight: bold;
            color: var(--accent-color);
            margin: 20px 0;
        }

        /* Checklist */
        .checklist {
            list-style: none;
            margin: 20px 0;
        }

        .checklist li {
            padding: 10px;
            margin: 8px 0;
            background: var(--bg-color);
            border-radius: 5px;
            border-left: 4px solid var(--success-color);
        }

        .checklist li::before {
            content: '✓';
            color: var(--success-color);
            font-weight: bold;
            margin-right: 10px;
        }

        /* Links */
        a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        a:hover {
            color: var(--hover-color);
            text-decoration: underline;
        }

        a:focus {
            outline: 2px solid var(--warning-color);
        }

        /* Footer */
        footer {
            background: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
            margin-top: 0;
        }

        footer p {
            margin: 5px 0;
            font-size: 0.9em;
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .tab-navigation {
                display: none;
            }

            .tab-content {
                display: block !important;
                page-break-after: always;
            }

            .collapsible-content {
                max-height: none !important;
                display: block !important;
            }

            .collapsible::after {
                display: none;
            }

            a {
                color: black;
                text-decoration: underline;
            }

            footer {
                page-break-before: always;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            header h1 {
                font-size: 1.8em;
            }

            .header-stats {
                gap: 20px;
            }

            .stat-number {
                font-size: 1.5em;
            }

            .tab-button {
                font-size: 0.85em;
                padding: 12px 15px;
            }

            .content-area {
                padding: 20px;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 8px;
            }

            .timeline {
                padding-left: 20px;
            }

            .timeline-item {
                padding-left: 15px;
            }
        }

        /* Accessibility - Keyboard Navigation Indicator */
        .keyboard-nav *:focus {
            outline: 3px solid var(--warning-color);
            outline-offset: 2px;
        }

        /* SVG text styling */
        svg text {
            font-family: 'Segoe UI', sans-serif;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>WannaCry Ransomware Attack</h1>
            <p>Interactive Learning Module | May 2017 Global Cyber Incident</p>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-number">200,000+</div>
                    <div class="stat-label">Infected Systems</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">150+</div>
                    <div class="stat-label">Countries Affected</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">$4-8B</div>
                    <div class="stat-label">Economic Impact</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">May 12, 2017</div>
                    <div class="stat-label">Attack Date</div>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav>
            <ul class="tab-navigation" role="tablist" aria-label="Learning module navigation">
                <li role="presentation"><button class="tab-button active" role="tab" aria-selected="true" aria-controls="overview-tab" id="tab-overview" data-tab="overview">Overview</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="targets-tab" id="tab-targets" data-tab="targets">Target Organizations</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="attackers-tab" id="tab-attackers" data-tab="attackers">Attackers</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="method-tab" id="tab-method" data-tab="method">Method of Attack</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="vulnerabilities-tab" id="tab-vulnerabilities" data-tab="vulnerabilities">Vulnerabilities</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="detection-tab" id="tab-detection" data-tab="detection">Detection</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="response-tab" id="tab-response" data-tab="response">Response</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="impact-tab" id="tab-impact" data-tab="impact">Impact</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="lessons-tab" id="tab-lessons" data-tab="lessons">Lessons Learned</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="references-tab" id="tab-references" data-tab="references">References</button></li>
                <li role="presentation"><button class="tab-button" role="tab" aria-selected="false" aria-controls="quiz-tab" id="tab-quiz" data-tab="quiz">Quiz</button></li>
            </ul>
        </nav>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Overview Tab -->
            <div id="overview-tab" class="tab-content active" role="tabpanel" aria-labelledby="tab-overview">
                <h2>Overview: WannaCry Ransomware Attack</h2>
                
                <div class="info-box critical">
                    <strong>Attack Summary:</strong> WannaCry (also known as WannaCrypt, WanaCrypt0r 2.0, and Wana Decrypt0r 2.0) was a worldwide cyberattack that occurred in May 2017, leveraging the EternalBlue exploit to propagate ransomware across networks. The attack infected over 200,000 computers across 150 countries in a matter of hours, causing billions of dollars in damages.
                </div>

                <h3>Quick Statistics</h3>
                <ul>
                    <li><strong>Infection Scale:</strong> 200,000+ computers in 150+ countries</li>
                    <li><strong>Duration:</strong> Peak activity May 12-15, 2017</li>
                    <li><strong>Ransom Demand:</strong> $300-$600 USD in Bitcoin per infected system</li>
                    <li><strong>Total Ransom Collected:</strong> Approximately $140,000 USD</li>
                    <li><strong>Estimated Economic Impact:</strong> $4-8 billion globally</li>
                    <li><strong>Primary Vulnerability:</strong> CVE-2017-0144 (EternalBlue - SMBv1 Remote Code Execution)</li>
                </ul>

                <h3>Timeline of Key Events</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">March 14, 2017</div>
                        <div class="timeline-content">
                            Microsoft releases security bulletin MS17-010 patching the EternalBlue vulnerability (CVE-2017-0144) for supported Windows versions.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">April 14, 2017</div>
                        <div class="timeline-content">
                            The Shadow Brokers hacker group leaks NSA exploit tools including EternalBlue, DoublePulsar, and other SMB-targeting exploits.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 12, 2017 - 07:44 UTC</div>
                        <div class="timeline-content">
                            First WannaCry infections detected in Asia, rapidly spreading westward. The attack begins affecting Spain's Telefónica and other major organizations.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 12, 2017 - Afternoon</div>
                        <div class="timeline-content">
                            UK's National Health Service (NHS) severely impacted with 80 NHS trusts affected, forcing ambulance diversions and cancellation of thousands of appointments and operations.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 12, 2017 - 15:03 UTC</div>
                        <div class="timeline-content">
                            Marcus Hutchins (MalwareTech), a 22-year-old British security researcher, discovers and registers the unregistered kill switch domain (iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com), significantly slowing the spread.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 13, 2017</div>
                        <div class="timeline-content">
                            Microsoft takes unprecedented step of releasing emergency patches (MS17-010) for unsupported legacy systems including Windows XP, Windows 8, and Windows Server 2003.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 14, 2017</div>
                        <div class="timeline-content">
                            WannaCry variant 2.0 detected without the kill switch domain check, though it spreads less effectively than the original variant.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 15, 2017</div>
                        <div class="timeline-content">
                            Infection rate drops significantly as organizations implement patches and network segmentation. Global coordination of incident response begins.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">December 18, 2017</div>
                        <div class="timeline-content">
                            United States, United Kingdom, Australia, Canada, New Zealand, and Japan formally attribute the attack to North Korea's Lazarus Group.
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">September 2018</div>
                        <div class="timeline-content">
                            U.S. Department of Justice charges Park Jin Hyok, a North Korean programmer, for his role in the WannaCry attack and other cybercrimes.
                        </div>
                    </div>
                </div>

                <button class="collapsible">Technical Overview (Expand for Details)</button>
                <div class="collapsible-content">
                    <div class="collapsible-content-inner">
                        <p>WannaCry combined worm-like propagation capabilities with ransomware payload delivery, making it particularly devastating. The attack chain consisted of:</p>
                        <ol>
                            <li><strong>Initial Infection:</strong> Exploitation of unpatched SMBv1 vulnerabilities (CVE-2017-0144) using the EternalBlue exploit leaked from NSA tools</li>
                            <li><strong>Backdoor Installation:</strong> Deployment of DoublePulsar backdoor for persistent access</li>
                            <li><strong>Payload Execution:</strong> Download and execution of WannaCry ransomware dropper</li>
                            <li><strong>Lateral Movement:</strong> Autonomous scanning of networks for vulnerable systems, creating worm-like propagation</li>
                            <li><strong>Encryption:</strong> File encryption using AES-128 and RSA-2048 cryptography</li>
                            <li><strong>Ransom Demand:</strong> Display of ransom note demanding Bitcoin payment with countdown timer</li>
                        </ol>
                        <p>The malware checked for the existence of a specific unregistered domain before proceeding with encryption. This was likely intended as an anti-sandbox mechanism but inadvertently created a kill switch when the domain was registered by security researchers.</p>
                    </div>
                </div>
            </div>

            <!-- Target Organizations Tab -->
            <div id="targets-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-targets">
                <h2>Target Organizations and Affected Sectors</h2>

                <div class="info-box warning">
                    <strong>Important Note:</strong> WannaCry was an indiscriminate attack that did not specifically target particular organizations or sectors. Instead, it exploited a widespread vulnerability, affecting any unpatched Windows system with SMBv1 enabled and accessible. However, certain sectors were disproportionately impacted due to legacy systems and operational constraints.
                </div>

                <h3>Most Severely Affected Sectors</h3>

                <div class="map-container">
                    <h4>Global Impact Distribution</h4>
                    <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="World map showing WannaCry infection distribution">
                        <!-- Simplified world map -->
                        <rect width="800" height="400" fill="#e8f4f8"/>
                        
                        <!-- Europe - Heavily Affected -->
                        <path class="region" id="europe" d="M 350,120 L 380,115 L 420,125 L 450,130 L 470,140 L 480,160 L 470,180 L 450,185 L 420,180 L 390,175 L 360,165 L 340,145 Z" 
                              fill="#e74c3c" stroke="#2c3e50" stroke-width="1" opacity="0.8" role="button" tabindex="0" aria-label="Europe region - heavily affected"/>
                        
                        <!-- Asia - Heavily Affected -->
                        <path class="region" id="asia" d="M 520,140 L 580,135 L 640,145 L 680,160 L 700,180 L 690,210 L 650,220 L 600,215 L 550,200 L 520,175 Z" 
                              fill="#e74c3c" stroke="#2c3e50" stroke-width="1" opacity="0.8" role="button" tabindex="0" aria-label="Asia region - heavily affected"/>
                        
                        <!-- North America - Moderately Affected -->
                        <path class="region" id="northamerica" d="M 120,100 L 180,95 L 240,105 L 280,120 L 290,150 L 270,180 L 230,185 L 180,175 L 140,160 L 110,130 Z" 
                              fill="#f39c12" stroke="#2c3e50" stroke-width="1" opacity="0.8" role="button" tabindex="0" aria-label="North America region - moderately affected"/>
                        
                        <!-- South America - Less Affected -->
                        <path class="region" id="southamerica" d="M 220,220 L 250,215 L 270,230 L 280,260 L 270,300 L 250,320 L 230,310 L 215,280 L 210,250 Z" 
                              fill="#3498db" stroke="#2c3e50" stroke-width="1" opacity="0.6" role="button" tabindex="0" aria-label="South America region - less affected"/>
                        
                        <!-- Africa - Moderately Affected -->
                        <path class="region" id="africa" d="M 380,210 L 420,205 L 450,220 L 460,250 L 450,280 L 420,295 L 390,290 L 370,270 L 365,240 Z" 
                              fill="#f39c12" stroke="#2c3e50" stroke-width="1" opacity="0.7" role="button" tabindex="0" aria-label="Africa region - moderately affected"/>
                        
                        <!-- Australia - Less Affected -->
                        <path class="region" id="australia" d="M 640,280 L 680,275 L 710,285 L 720,310 L 705,330 L 670,335 L 640,325 L 630,300 Z" 
                              fill="#3498db" stroke="#2c3e50" stroke-width="1" opacity="0.6" role="button" tabindex="0" aria-label="Australia region - less affected"/>
                        
                        <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#2c3e50">
                            WannaCry Global Impact Map
                        </text>
                    </svg>
                    
                    <div class="map-legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #e74c3c;"></span>
                            <span>Heavily Affected (10,000+ infections)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #f39c12;"></span>
                            <span>Moderately Affected (1,000-10,000 infections)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #3498db;"></span>
                            <span>Less Affected (<1,000 infections)</span>
                        </div>
                    </div>
                </div>

                <h3>Healthcare Sector</h3>
                <div class="info-box critical">
                    <h4>United Kingdom - National Health Service (NHS)</h4>
                    <ul>
                        <li><strong>Scope:</strong> 80 out of 236 NHS trusts affected, plus 603 primary care and other NHS organizations</li>
                        <li><strong>Impact:</strong> 19,494 appointments cancelled, ambulances diverted, emergency departments closed</li>
                        <li><strong>Why Affected:</strong> Many NHS systems ran Windows XP (end-of-life since April 2014) and Windows 7 without recent patches due to compatibility concerns with critical medical equipment and software</li>
                        <li><strong>Notable Incidents:</strong> East and North Hertfordshire NHS Trust had to divert emergency patients; patients turned away from A&E departments</li>
                        <li><strong>Recovery Time:</strong> Several days to weeks for full restoration of services</li>
                    </ul>
                </div>

                <h4>Other Healthcare Organizations Affected:</h4>
                <ul>
                    <li>Bayer AG (Germany) - pharmaceutical and medical device manufacturer</li>
                    <li>Multiple hospitals in Romania, Indonesia, and other countries</li>
                    <li>Various healthcare providers across Asia, including several hospitals in South Korea</li>
                </ul>

                <h3>Telecommunications</h3>
                <ul>
                    <li><strong>Telefónica (Spain):</strong> One of the first major victims, with internal systems encrypted. Employees sent home as IT staff worked to contain the spread.</li>
                    <li><strong>Megafon (Russia):</strong> Major telecommunications provider affected</li>
                    <li><strong>Deutsche Telekom (Germany):</strong> Customer routers affected, though impact less severe</li>
                </ul>

                <h3>Transportation and Logistics</h3>
                <ul>
                    <li><strong>Deutsche Bahn (German Rail):</strong> Display boards and ticketing systems affected at multiple stations</li>
                    <li><strong>FedEx:</strong> Windows subsidiary TNT Express severely impacted with operational disruptions lasting weeks</li>
                    <li><strong>Renault (France):</strong> Manufacturing facilities forced to halt production temporarily</li>
                    <li><strong>Nissan (UK):</strong> Manufacturing plant in Sunderland forced to stop production</li>
                </ul>

                <h3>Government and Public Sector</h3>
                <ul>
                    <li><strong>Russian Ministry of Interior:</strong> Approximately 1,000 computers affected</li>
                    <li><strong>Chinese Universities:</strong> Multiple institutions including educational networks affected</li>
                    <li><strong>Spain's Infrastructure Ministry (Fomento):</strong> Some systems impacted</li>
                    <li><strong>Andhra Pradesh Police (India):</strong> Systems encrypted</li>
                </ul>

                <h3>Geographic Distribution</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Region/Country</th>
                            <th>Estimated Infections</th>
                            <th>Notable Impacts</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Russia</td>
                            <td>~50,000</td>
                            <td>Interior Ministry, Megafon, Railway systems</td>
                        </tr>
                        <tr>
                            <td>United Kingdom</td>
                            <td>~20,000</td>
                            <td>NHS, Nissan manufacturing</td>
                        </tr>
                        <tr>
                            <td>China</td>
                            <td>~30,000</td>
                            <td>Universities, PetroChina, government systems</td>
                        </tr>
                        <tr>
                            <td>Spain</td>
                            <td>~15,000</td>
                            <td>Telefónica, Gas Natural, government ministries</td>
                        </tr>
                        <tr>
                            <td>United States</td>
                            <td>~10,000</td>
                            <td>FedEx/TNT, various enterprises</td>
                        </tr>
                        <tr>
                            <td>India</td>
                            <td>~10,000</td>
                            <td>Andhra Pradesh Police, various organizations</td>
                        </tr>
                        <tr>
                            <td>Other (144+ countries)</td>
                            <td>~65,000</td>
                            <td>Distributed across Europe, Asia, Americas, Africa</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Attackers Tab -->
            <div id="attackers-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-attackers">
                <h2>Attribution: Attackers Behind WannaCry</h2>

                <div class="info-box info">
                    <strong>Attribution Context:</strong> Cybersecurity attribution is complex and rarely provides absolute certainty. Multiple intelligence agencies, private security firms, and governments contributed to the attribution analysis of WannaCry, converging on North Korea's Lazarus Group as the most likely perpetrator.
                </div>

                <h3>Official Government Attribution</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">December 18, 2017</div>
                        <div class="timeline-content">
                            <strong>United States, United Kingdom, Australia, Canada, New Zealand, and Japan</strong> jointly attribute WannaCry to North Korea. The U.S. Homeland Security Advisor Tom Bossert publicly stated: "We do not make this allegation lightly. It is based on evidence."
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">September 6, 2018</div>
                        <div class="timeline-content">
                            <strong>U.S. Department of Justice</strong> files criminal charges against Park Jin Hyok, alleging he was a North Korean programmer working for the Reconnaissance General Bureau (RGB), North Korea's primary intelligence agency, and was part of the conspiracy behind WannaCry.
                        </div>
                    </div>
                </div>

                <h3>The Lazarus Group</h3>
                <p><strong>Background:</strong> Lazarus Group (also known as Guardians of Peace, HIDDEN COBRA, Zinc) is a North Korean state-sponsored advanced persistent threat (APT) group believed to operate under the Reconnaissance General Bureau. The group has been active since at least 2009 and is attributed to multiple high-profile cyberattacks.</p>

                <h4>Notable Lazarus Group Operations</h4>
                <ul>
                    <li><strong>2014 - Sony Pictures Entertainment:</strong> Destructive attack in response to the film "The Interview"</li>
                    <li><strong>2016 - Bangladesh Bank Heist:</strong> Attempted theft of $951 million via SWIFT network (successfully stole $81 million)</li>
                    <li><strong>2017 - WannaCry:</strong> Global ransomware attack</li>
                    <li><strong>2018-Present - Cryptocurrency Exchanges:</strong> Multiple targeted attacks on exchanges</li>
                </ul>

                <h3>Attribution Confidence Assessment</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Attribution Aspect</th>
                            <th>Confidence Level</th>
                            <th>Supporting Evidence</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>State-Sponsored Operation</td>
                            <td>High</td>
                            <td>Sophistication, infrastructure, resources required</td>
                        </tr>
                        <tr>
                            <td>North Korean Origin</td>
                            <td>High</td>
                            <td>Code overlap, TTPs, intelligence assessments</td>
                        </tr>
                        <tr>
                            <td>Lazarus Group Involvement</td>
                            <td>High</td>
                            <td>Technical similarities, pattern analysis</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Method of Attack Tab -->
            <div id="method-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-method">
                <h2>Method of Attack: Technical Analysis</h2>

                <div class="info-box critical">
                    <strong>Attack Classification:</strong> WannaCry is a wormable ransomware cryptoworm that combines network worm propagation capabilities with file-encrypting ransomware payload.
                </div>

                <h3>Attack Chain Overview</h3>
                <svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="WannaCry attack chain flowchart">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#2c3e50" />
                        </marker>
                    </defs>
                    
                    <!-- Step 1 -->
                    <rect x="50" y="30" width="180" height="60" fill="#e74c3c" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="140" y="55" text-anchor="middle" fill="white" font-size="12" font-weight="bold">1. Initial Infection</text>
                    <text x="140" y="73" text-anchor="middle" fill="white" font-size="10">EternalBlue Exploit</text>
                    <line x1="140" y1="90" x2="140" y2="120" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 2 -->
                    <rect x="50" y="120" width="180" height="60" fill="#e67e22" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="140" y="145" text-anchor="middle" fill="white" font-size="12" font-weight="bold">2. Backdoor Installation</text>
                    <text x="140" y="163" text-anchor="middle" fill="white" font-size="10">DoublePulsar Implant</text>
                    <line x1="140" y1="180" x2="140" y2="210" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 3 -->
                    <rect x="50" y="210" width="180" height="60" fill="#f39c12" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="140" y="235" text-anchor="middle" fill="white" font-size="12" font-weight="bold">3. Payload Delivery</text>
                    <text x="140" y="253" text-anchor="middle" fill="white" font-size="10">WannaCry Dropper</text>
                    <line x1="140" y1="270" x2="140" y2="300" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 4 -->
                    <rect x="50" y="300" width="180" height="60" fill="#3498db" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="140" y="325" text-anchor="middle" fill="white" font-size="12" font-weight="bold">4. Kill Switch Check</text>
                    <text x="140" y="343" text-anchor="middle" fill="white" font-size="10">Domain Resolution Test</text>
                    
                    <!-- Branching -->
                    <line x1="230" y1="330" x2="320" y2="330" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="275" y="325" text-anchor="middle" font-size="10" fill="#27ae60" font-weight="bold">Domain exists</text>
                    
                    <line x1="140" y1="360" x2="140" y2="390" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="185" y="380" text-anchor="start" font-size="10" fill="#e74c3c" font-weight="bold">Domain not found</text>
                    
                    <!-- Exit path -->
                    <rect x="320" y="300" width="180" height="60" fill="#27ae60" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="410" y="325" text-anchor="middle" fill="white" font-size="12" font-weight="bold">Exit (No Encryption)</text>
                    <text x="410" y="343" text-anchor="middle" fill="white" font-size="10">Malware Terminates</text>
                    
                    <!-- Step 5 -->
                    <rect x="50" y="390" width="180" height="60" fill="#9b59b6" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="140" y="415" text-anchor="middle" fill="white" font-size="12" font-weight="bold">5. Worm Propagation</text>
                    <text x="140" y="433" text-anchor="middle" fill="white" font-size="10">Network Scanning</text>
                    
                    <!-- Parallel Step 6 -->
                    <line x1="230" y1="420" x2="290" y2="420" stroke="#2c3e50" stroke-width="2"/>
                    <line x1="290" y1="420" x2="290" y2="120" stroke="#2c3e50" stroke-width="2"/>
                    <line x1="290" y1="120" x2="230" y2="120" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="295" y="270" text-anchor="start" font-size="9" fill="#2c3e50">Infect new hosts</text>
                    
                    <!-- Step 7 -->
                    <rect x="520" y="120" width="180" height="60" fill="#c0392b" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="610" y="145" text-anchor="middle" fill="white" font-size="12" font-weight="bold">6. File Encryption</text>
                    <text x="610" y="163" text-anchor="middle" fill="white" font-size="10">AES-128 / RSA-2048</text>
                    <line x1="610" y1="180" x2="610" y2="210" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <line x1="140" y1="450" x2="520" y2="150" stroke="#2c3e50" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 8 -->
                    <rect x="520" y="210" width="180" height="60" fill="#8e44ad" stroke="#2c3e50" stroke-width="2" rx="5"/>
                    <text x="610" y="235" text-anchor="middle" fill="white" font-size="12" font-weight="bold">7. Ransom Demand</text>
                    <text x="610" y="253" text-anchor="middle" fill="white" font-size="10">Display Payment Note</text>
                </svg>

                <h3>MITRE ATT&CK Framework Mapping</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tactic</th>
                            <th>Technique ID</th>
                            <th>Technique Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Initial Access</td>
                            <td>T1190</td>
                            <td>Exploit Public-Facing Application</td>
                        </tr>
                        <tr>
                            <td>Execution</td>
                            <td>T1569.002</td>
                            <td>Service Execution</td>
                        </tr>
                        <tr>
                            <td>Lateral Movement</td>
                            <td>T1210</td>
                            <td>Exploitation of Remote Services</td>
                        </tr>
                        <tr>
                            <td>Impact</td>
                            <td>T1486</td>
                            <td>Data Encrypted for Impact</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Vulnerabilities Tab -->
            <div id="vulnerabilities-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-vulnerabilities">
                <h2>Vulnerabilities Exploited by WannaCry</h2>

                <h3>Primary Vulnerability: EternalBlue (CVE-2017-0144)</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Attribute</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>CVE ID</strong></td>
                            <td>CVE-2017-0144</td>
                        </tr>
                        <tr>
                            <td><strong>Vulnerability Type</strong></td>
                            <td>Remote Code Execution via Buffer Overflow</td>
                        </tr>
                        <tr>
                            <td><strong>Affected Component</strong></td>
                            <td>Server Message Block 1.0 (SMBv1)</td>
                        </tr>
                        <tr>
                            <td><strong>CVSS v3 Score</strong></td>
                            <td>8.1 (High) / 9.8 (Critical when internet accessible)</td>
                        </tr>
                    </tbody>
                </table>

                <h3>System and Configuration Weaknesses</h3>
                <ul>
                    <li>Unpatched systems (MS17-010 not applied)</li>
                    <li>End-of-life operating systems (Windows XP, Server 2003)</li>
                    <li>SMBv1 protocol enabled</li>
                    <li>Flat network architecture without segmentation</li>
                    <li>Inadequate backup and recovery capabilities</li>
                </ul>

                <h3>Patch Timeline</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">March 14, 2017</div>
                        <div class="timeline-content">
                            Microsoft releases MS17-010 for supported Windows versions
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 12, 2017</div>
                        <div class="timeline-content">
                            WannaCry attack begins (58 days after patch release)
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">May 13, 2017</div>
                        <div class="timeline-content">
                            Microsoft releases emergency patches for unsupported systems (XP, Server 2003)
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detection Tab -->
            <div id="detection-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-detection">
                <h2>Detection: Indicators of Compromise</h2>

                <h3>File-Based Indicators</h3>
                <h4>Known File Hashes (SHA-256)</h4>
                <div class="code-block">
                    <code>ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa
09a46b3e1be080745a6d8d88d6b5bd351b1c7586ae0dc94d0c238ee36421cafa
24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c</code>
                </div>

                <h4>File Names and Paths</h4>
                <table>
                    <thead>
                        <tr>
                            <th>File Name</th>
                            <th>Typical Location</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>mssecsvc.exe</td>
                            <td>C:\Windows\</td>
                            <td>Initial dropper executable</td>
                        </tr>
                        <tr>
                            <td>tasksche.exe</td>
                            <td>C:\Windows\</td>
                            <td>Dropper variant</td>
                        </tr>
                        <tr>
                            <td>@WanaDecryptor@.exe</td>
                            <td>Desktop</td>
                            <td>Ransom GUI application</td>
                        </tr>
                        <tr>
                            <td>*.WNCRY</td>
                            <td>Various</td>
                            <td>Encrypted file extension</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Network Indicators</h3>
                <h4>Kill Switch Domain</h4>
                <div class="code-block">
                    <code>iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</code>
                </div>

                <h4>Bitcoin Wallet Addresses</h4>
                <div class="code-block">
                    <code>13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94
12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw
115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn</code>
                </div>
            </div>

            <!-- Response Tab -->
            <div id="response-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-response">
                <h2>Response: Containment and Remediation</h2>

                <h3>Immediate Containment Steps</h3>
                <ol>
                    <li><strong>Network Segmentation:</strong> Block SMB ports (445, 139) at firewalls</li>
                    <li><strong>System Isolation:</strong> Disconnect infected systems from network</li>
                    <li><strong>Kill Switch Implementation:</strong> Configure DNS to resolve kill switch domain</li>
                    <li><strong>Emergency Patching:</strong> Deploy MS17-010 to all vulnerable systems</li>
                    <li><strong>SMBv1 Disablement:</strong> Disable SMBv1 protocol globally</li>
                </ol>

                <h3>Remediation Procedures</h3>
                <div class="info-box warning">
                    <strong>Important:</strong> File decryption without the attacker's private key is not possible. Focus on containment, eradication, and restoration from backups.
                </div>

                <ul>
                    <li>Create memory dumps for forensic analysis</li>
                    <li>Remove malware using updated antivirus tools</li>
                    <li>Restore systems from clean backups</li>
                    <li>Rebuild systems if necessary</li>
                    <li>Verify patches before reconnecting to network</li>
                </ul>

                <div class="info-box critical">
                    <strong>Do NOT Pay Ransom:</strong> Government agencies and security experts recommend against paying ransom. There's no guarantee of file recovery, and payment funds criminal activities.
                </div>
            </div>

            <!-- Impact Tab -->
            <div id="impact-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-impact">
                <h2>Impact: Consequences of the WannaCry Attack</h2>

                <h3>Global Statistics</h3>
                <div class="info-box critical">
                    <ul>
                        <li><strong>Infected Systems:</strong> ~200,000 computers across 150+ countries</li>
                        <li><strong>Economic Impact:</strong> Estimated $4-8 billion USD globally</li>
                        <li><strong>Ransom Collected:</strong> Approximately $140,000 USD (327 payments)</li>
                        <li><strong>Recovery Time:</strong> Days to weeks for most organizations</li>
                    </ul>
                </div>

                <h3>Financial Impact Analysis</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Impact Category</th>
                            <th>Estimated Cost</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Direct IT Remediation</td>
                            <td>$500M - $1B</td>
                        </tr>
                        <tr>
                            <td>Business Disruption</td>
                            <td>$2B - $3B</td>
                        </tr>
                        <tr>
                            <td>Recovery and Restoration</td>
                            <td>$1B - $2B</td>
                        </tr>
                        <tr>
                            <td>Security Improvements</td>
                            <td>$500M - $1B</td>
                        </tr>
                        <tr>
                            <td><strong>Total Estimated Impact</strong></td>
                            <td><strong>$4B - $8B</strong></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Sector-Specific Impacts</h3>
                <h4>Healthcare (NHS UK)</h4>
                <ul>
                    <li>19,494 appointments cancelled</li>
                    <li>80 NHS trusts affected</li>
                    <li>Ambulance diversions</li>
                    <li>Emergency department closures</li>
                    <li>Estimated £92 million cost</li>
                </ul>

                <h4>Transportation & Logistics</h4>
                <ul>
                    <li>FedEx/TNT Express: $300 million loss</li>
                    <li>Renault and Nissan: Production halts</li>
                    <li>Deutsche Bahn: Display systems affected</li>
                </ul>
            </div>

            <!-- Lessons Learned Tab -->
            <div id="lessons-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-lessons">
                <h2>Lessons Learned: Strategic Recommendations</h2>

                <div class="info-box success">
                    <strong>Purpose:</strong> These recommendations are prioritized for maximum security improvement and apply to organizations of all sizes.
                </div>

                <h3>Priority 1: Critical Immediate Actions</h3>
                <div class="checklist">
                    <li><strong>Implement Rigorous Patch Management</strong> - Deploy critical patches within 72 hours for internet-facing systems, 14 days for internal systems</li>
                    <li><strong>Eliminate Legacy Operating Systems</strong> - Migrate all end-of-life systems to supported versions</li>
                    <li><strong>Disable SMBv1 Protocol</strong> - Remove this outdated and vulnerable protocol across all systems</li>
                    <li><strong>Implement Network Segmentation</strong> - Separate networks by security zone and isolate critical systems</li>
                    <li><strong>Block Unnecessary Lateral Movement</strong> - Restrict SMB traffic and enable host firewalls</li>
                </div>

                <h3>Priority 2: Essential Security Controls</h3>
                <div class="checklist">
                    <li><strong>Deploy Robust Backup Systems</strong> - Follow 3-2-1-1 rule: 3 copies, 2 media types, 1 offsite, 1 offline/immutable</li>
                    <li><strong>Implement EDR Solutions</strong> - Deploy endpoint detection and response on all systems</li>
                    <li><strong>Enable Comprehensive Logging</strong> - Implement SIEM and monitor for suspicious activities</li>
                    <li><strong>Implement Application Whitelisting</strong> - Use default-deny approach for executable execution</li>
                    <li><strong>Enforce Least Privilege Access</strong> - Remove unnecessary administrative rights</li>
                </div>

                <h3>Priority 3: Organizational Improvements</h3>
                <div class="checklist">
                    <li><strong>Develop Incident Response Plan</strong> - Document procedures and conduct regular tabletop exercises</li>
                    <li><strong>Implement Security Awareness Training</strong> - Mandatory training for all employees</li>
                    <li><strong>Establish Cybersecurity Governance</strong> - Board-level oversight and adequate budget</li>
                    <li><strong>Conduct Regular Testing</strong> - Vulnerability assessments and penetration testing</li>
                </div>

                <h3>Key Takeaways</h3>
                <div class="info-box info">
                    <ol>
                        <li><strong>Patch Management is Non-Negotiable:</strong> WannaCry exploited a vulnerability patched two months prior</li>
                        <li><strong>Legacy Systems Create Risk:</strong> End-of-life systems became single points of failure</li>
                        <li><strong>Defense in Depth:</strong> Layered defenses limited impact for prepared organizations</li>
                        <li><strong>Backups Must Be Resilient:</strong> Offline and immutable backups are essential</li>
                        <li><strong>Security is Business Priority:</strong> Requires board attention and adequate resources</li>
                    </ol>
                </div>
            </div>

            <!-- References Tab -->
            <div id="references-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-references">
                <h2>References and Resources</h2>

                <h3>Official Government and Vendor Advisories</h3>
                
                <h4>Microsoft Security Bulletins</h4>
                <ul>
                    <li><a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010" target="_blank" rel="noopener">MS17-010: Security Update for Microsoft Windows SMB Server (March 14, 2017)</a></li>
                    <li><a href="https://www.microsoft.com/en-us/security/blog/2017/05/12/wannacrypt-ransomware-worm-targets-out-of-date-systems/" target="_blank" rel="noopener">Microsoft Security Blog: WannaCrypt ransomware worm (May 12, 2017)</a></li>
                </ul>

                <h4>US Government Resources</h4>
                <ul>
                    <li><a href="https://www.cisa.gov/news-events/alerts/2017/05/12/multiple-vulnerabilities-microsoft-windows-smb-server" target="_blank" rel="noopener">CISA Alert (TA17-132A): WannaCry Ransomware</a></li>
                    <li><a href="https://www.justice.gov/opa/pr/north-korean-regime-backed-programmer-charged-conspiracy-conduct-multiple-cyber-attacks-and" target="_blank" rel="noopener">DOJ: North Korean Programmer Charged (September 2018)</a></li>
                </ul>

                <h4>UK Government Resources</h4>
                <ul>
                    <li><a href="https://www.ncsc.gov.uk/information/wannacry-ransomware" target="_blank" rel="noopener">NCSC: WannaCry ransomware guidance</a></li>
                    <li><a href="https://www.nao.org.uk/reports/investigation-wannacry-cyber-attack-and-the-nhs/" target="_blank" rel="noopener">National Audit Office: WannaCry Investigation (October 2017)</a></li>
                </ul>

                <h3>CVE and Vulnerability Databases</h3>
                <ul>
                    <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-0144" target="_blank" rel="noopener">CVE-2017-0144 (NVD)</a></li>
                    <li><a href="https://attack.mitre.org/software/S0366/" target="_blank" rel="noopener">MITRE ATT&CK: WannaCry (S0366)</a></li>
                </ul>

                <h3>Security Vendor Analysis</h3>
                <ul>
                    <li><a href="https://securelist.com/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/78351/" target="_blank" rel="noopener">Kaspersky Lab: WannaCry Analysis</a></li>
                    <li><a href="https://www.malwaretech.com/2017/05/how-to-accidentally-stop-a-global-cyber-attacks.html" target="_blank" rel="noopener">MalwareTech: Kill Switch Discovery</a></li>
                </ul>

                <h3>Best Practices and Guidelines</h3>
                <ul>
                    <li><a href="https://www.nist.gov/cyberframework" target="_blank" rel="noopener">NIST Cybersecurity Framework</a></li>
                    <li><a href="https://www.cisecurity.org/controls" target="_blank" rel="noopener">CIS Critical Security Controls</a></li>
                    <li><a href="https://www.cisa.gov/stopransomware" target="_blank" rel="noopener">CISA StopRansomware.gov</a></li>
                </ul>

                <h3>Contact Information for Reporting</h3>
                <h4>United States</h4>
                <ul>
                    <li><strong>CISA:</strong> <a href="https://www.cisa.gov/report" target="_blank" rel="noopener">cisa.gov/report</a> or 1-888-282-0870</li>
                    <li><strong>FBI IC3:</strong> <a href="https://www.ic3.gov/" target="_blank" rel="noopener">ic3.gov</a></li>
                </ul>

                <h4>United Kingdom</h4>
                <ul>
                    <li><strong>NCSC:</strong> <a href="https://www.ncsc.gov.uk/" target="_blank" rel="noopener">ncsc.gov.uk</a></li>
                    <li><strong>Action Fraud:</strong> 0300 123 2040</li>
                </ul>
            </div>

            <!-- Quiz Tab -->
            <div id="quiz-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-quiz">
                <h2>Knowledge Assessment Quiz</h2>
                <p>Test your understanding of the WannaCry ransomware attack. Select the best answer for each question and click "Submit Quiz" to see your score.</p>

                <div class="quiz-container">
                    <div class="question" id="q1">
                        <h4>Question 1: What was the primary vulnerability exploited by WannaCry?</h4>
                        <label class="quiz-option">
                            <input type="radio" name="q1" value="a">
                            A remote code execution vulnerability in Apache web server
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q1" value="b">
                            A buffer overflow in the SMBv1 protocol (CVE-2017-0144)
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q1" value="c">
                            A SQL injection vulnerability in Windows databases
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q1" value="d">
                            A phishing email attachment with malicious macros
                        </label>
                        <div class="quiz-feedback" id="feedback-q1"></div>
                    </div>

                    <div class="question" id="q2">
                        <h4>Question 2: How was the initial spread of WannaCry significantly slowed?</h4>
                        <label class="quiz-option">
                            <input type="radio" name="q2" value="a">
                            Microsoft released emergency patches for all Windows versions
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q2" value="b">
                            Internet service providers blocked all SMB traffic globally
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q2" value="c">
                            A security researcher registered an unregistered domain that acted as a kill switch
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q2" value="d">
                            Law enforcement seized the attacker's command and control servers
                        </label>
                        <div class="quiz-feedback" id="feedback-q2"></div>
                    </div>

                    <div class="question" id="q3">
                        <h4>Question 3: Which nation-state is WannaCry attributed to?</h4>
                        <label class="quiz-option">
                            <input type="radio" name="q3" value="a">
                            Russia
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q3" value="b">
                            China
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q3" value="c">
                            North Korea (Lazarus Group)
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q3" value="d">
                            Iran
                        </label>
                        <div class="quiz-feedback" id="feedback-q3"></div>
                    </div>

                    <div class="question" id="q4">
                        <h4>Question 4: What was the estimated global economic impact of WannaCry?</h4>
                        <label class="quiz-option">
                            <input type="radio" name="q4" value="a">
                            $500 million to $1 billion
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q4" value="b">
                            $4 billion to $8 billion
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q4" value="c">
                            $20 billion to $30 billion
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q4" value="d">
                            $100 million to $200 million
                        </label>
                        <div class="quiz-feedback" id="feedback-q4"></div>
                    </div>

                    <div class="question" id="q5">
                        <h4>Question 5: Which is NOT a recommended mitigation against WannaCry-style attacks?</h4>
                        <label class="quiz-option">
                            <input type="radio" name="q5" value="a">
                            Disable SMBv1 protocol on all systems
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q5" value="b">
                            Implement network segmentation to limit lateral movement
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q5" value="c">
                            Pay the ransom immediately to recover files faster
                        </label>
                        <label class="quiz-option">
                            <input type="radio" name="q5" value="d">
                            Maintain offline, immutable backups and test restoration regularly
                        </label>
                        <div class="quiz-feedback" id="feedback-q5"></div>
                    </div>

                    <button class="submit-quiz" onclick="submitQuiz()">Submit Quiz</button>

                    <div class="quiz-results" id="quiz-results">
                        <h3>Quiz Results</h3>
                        <div class="quiz-score" id="quiz-score"></div>
                        <p id="quiz-message"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p><strong>WannaCry Ransomware Attack: Interactive Learning Module</strong></p>
            <p>Created for educational purposes | May 2017 Global Cyber Incident Analysis</p>
            <p>&copy; 2024 | All information sourced from publicly available reports and documentation</p>
        </footer>
    </div>

    <script>
        // Tab Navigation
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        function switchTab(tabName) {
            tabContents.forEach(content => content.classList.remove('active'));
            tabButtons.forEach(button => {
                button.classList.remove('active');
                button.setAttribute('aria-selected', 'false');
            });

            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) selectedTab.classList.add('active');

            const selectedButton = document.getElementById('tab-' + tabName);
            if (selectedButton) {
                selectedButton.classList.add('active');
                selectedButton.setAttribute('aria-selected', 'true');
            }

            history.pushState(null, null, '#' + tabName);
        }

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                switchTab(button.getAttribute('data-tab'));
            });
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            const activeButton = document.activeElement;
            if (activeButton.classList.contains('tab-button')) {
                const currentIndex = Array.from(tabButtons).indexOf(activeButton);
                if (e.key === 'ArrowRight') {
                    e.preventDefault();
                    tabButtons[(currentIndex + 1) % tabButtons.length].click();
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    tabButtons[(currentIndex - 1 + tabButtons.length) % tabButtons.length].click();
                }
            }
        });

        // Deep linking
        window.addEventListener('load', () => {
            const hash = window.location.hash.substring(1);
            if (hash) switchTab(hash);
        });

        // Collapsible sections
        document.querySelectorAll('.collapsible').forEach(collapsible => {
            collapsible.addEventListener('click', function() {
                this.classList.toggle('active');
                const content = this.nextElementSibling;
                content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + 'px';
            });
        });

        // Map regions
        document.querySelectorAll('.region').forEach(region => {
            region.addEventListener('click', function() {
                const info = {
                    'europe': 'Europe: Heavily affected with major incidents in UK (NHS), Spain (Telefónica), Germany (Deutsche Bahn), France (Renault). Estimated 10,000+ infections.',
                    'asia': 'Asia: Heavily affected with widespread infections in Russia (~50,000), China (~30,000), India (~10,000).',
                    'northamerica': 'North America: Moderately affected with notable impact on FedEx (TNT Express). Estimated 10,000-15,000 infections.',
                    'southamerica': 'South America: Less affected with scattered infections across the region.',
                    'africa': 'Africa: Moderately affected with infections in various countries.',
                    'australia': 'Australia: Less affected with limited infections reported.'
                };
                alert(info[this.id] || 'Region information not available');
            });
        });

        // Quiz functionality
        const quizAnswers = {q1: 'b', q2: 'c', q3: 'c', q4: 'b', q5: 'c'};
        const quizExplanations = {
            q1: {
                correct: 'Correct! WannaCry exploited CVE-2017-0144, a buffer overflow in the SMBv1 protocol.',
                incorrect: 'Incorrect. WannaCry exploited CVE-2017-0144, a buffer overflow in the SMBv1 protocol.'
            },
            q2: {
                correct: 'Correct! Marcus Hutchins registered the kill switch domain, preventing newly infected systems from encrypting files.',
                incorrect: 'Incorrect. The primary factor was the registration of the kill switch domain by Marcus Hutchins.'
            },
            q3: {
                correct: 'Correct! Multiple governments attributed WannaCry to North Korea\'s Lazarus Group.',
                incorrect: 'Incorrect. WannaCry has been attributed to North Korea\'s Lazarus Group.'
            },
            q4: {
                correct: 'Correct! The global economic impact is estimated at $4-8 billion.',
                incorrect: 'Incorrect. The estimated impact was $4-8 billion.'
            },
            q5: {
                correct: 'Correct! Security experts universally recommend NOT paying ransoms.',
                incorrect: 'Incorrect. Paying ransom is NOT recommended and should be avoided.'
            }
        };

        function submitQuiz() {
            let score = 0;
            const totalQuestions = Object.keys(quizAnswers).length;

            for (let question in quizAnswers) {
                const selected = document.querySelector(`input[name="${question}"]:checked`);
                const feedback = document.getElementById(`feedback-${question}`);
                
                if (!selected) {
                    feedback.className = 'quiz-feedback incorrect';
                    feedback.style.display = 'block';
                    feedback.textContent = 'Please select an answer.';
                    continue;
                }

                if (selected.value === quizAnswers[question]) {
                    score++;
                    feedback.className = 'quiz-feedback correct';
                    feedback.textContent = '✓ ' + quizExplanations[question].correct;
                } else {
                    feedback.className = 'quiz-feedback incorrect';
                    feedback.textContent = '✗ ' + quizExplanations[question].incorrect;
                }
                feedback.style.display = 'block';
            }

            const percentage = (score / totalQuestions) * 100;
            const resultsDiv = document.getElementById('quiz-results');
            const scoreDiv = document.getElementById('quiz-score');
            const messageDiv = document.getElementById('quiz-message');

            scoreDiv.textContent = `${score} / ${totalQuestions}`;
            
            if (percentage === 100) {
                messageDiv.textContent = '🎉 Perfect score! Excellent understanding!';
                scoreDiv.style.color = '#27ae60';
            } else if (percentage >= 80) {
                messageDiv.textContent = '👏 Great job! Strong grasp of key concepts.';
                scoreDiv.style.color = '#27ae60';
            } else if (percentage >= 60) {
                messageDiv.textContent = '👍 Good effort! Review missed questions.';
                scoreDiv.style.color = '#f39c12';
            } else {
                messageDiv.textContent = '📚 Keep learning! Review the content and try again.';
                scoreDiv.style.color = '#e74c3c';
            }

            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Keyboard navigation class
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Tab') document.body.classList.add('keyboard-nav');
        });
        document.addEventListener('mousedown', () => {
            document.body.classList.remove('keyboard-nav');
        });
    </script>
</body>
</html>
