<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NTP Protocol | Network Security</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:         #f0f4f8;
    --bg2:        #e2e9f0;
    --surface:    #ffffff;
    --surface2:   #f5f8fb;
    --accent:     #0077aa;
    --accent2:    #d94f00;
    --accent3:    #1a7f37;
    --text:       #0f1e2e;
    --text-muted: #4a6580;
    --border:     #c4d4e2;
    --danger:     #cc2233;
    --warning:    #b07800;
    --safe:       #1a7f37;
    --teal:       #007a7a;
    --purple:     #7744bb;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,100,160,0.05) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,100,160,0.05) 1px, transparent 1px);
    background-size: 40px 40px;
    animation: gridMove 25s linear infinite;
    pointer-events: none;
    z-index: 0;
  }
  @keyframes gridMove {
    0%   { background-position: 0 0; }
    100% { background-position: 40px 40px; }
  }

  /* â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .hero {
    position: relative;
    z-index: 1;
    padding: 80px 40px 60px;
    text-align: center;
    background: radial-gradient(ellipse 80% 60% at 50% 0%, rgba(0,119,170,0.10) 0%, transparent 70%);
    border-bottom: 1px solid var(--border);
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(0,119,170,0.08);
    border: 1px solid rgba(0,119,170,0.25);
    border-radius: 100px;
    padding: 6px 16px;
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    color: var(--accent);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 24px;
    animation: fadeInDown 0.6s ease both;
  }
  .hero-badge::before {
    content: '';
    width: 6px; height: 6px;
    background: var(--accent);
    border-radius: 50%;
    animation: pulse 2s infinite;
  }
  @keyframes pulse {
    0%,100% { opacity:1; transform:scale(1); }
    50%      { opacity:.4; transform:scale(.8); }
  }

  .hero-icon {
    display: block;
    font-size: 3rem;
    margin-bottom: 12px;
    animation: fadeInDown .5s ease both, iconSpin 8s 1s linear infinite;
  }
  @keyframes iconSpin {
    0%   { filter: drop-shadow(0 0 0px rgba(0,119,170,0)); }
    50%  { filter: drop-shadow(0 0 14px rgba(0,119,170,0.45)); }
    100% { filter: drop-shadow(0 0 0px rgba(0,119,170,0)); }
  }

  h1 {
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: clamp(2.5rem, 6vw, 4.5rem);
    line-height: 1.05;
    letter-spacing: -0.03em;
    animation: fadeInDown 0.6s 0.1s ease both;
  }
  h1 span {
    background: linear-gradient(135deg, var(--accent), #3a6fd8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .hero p {
    max-width: 700px;
    margin: 20px auto 0;
    color: var(--text-muted);
    font-size: 1.05rem;
    line-height: 1.7;
    font-weight: 300;
    animation: fadeInDown 0.6s 0.2s ease both;
  }
  @keyframes fadeInDown {
    from { opacity:0; transform:translateY(-16px); }
    to   { opacity:1; transform:translateY(0); }
  }

  /* â”€â”€ STATS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .stats-bar {
    display: flex;
    justify-content: center;
    gap: 40px;
    padding: 24px 40px;
    border-bottom: 1px solid var(--border);
    background: var(--bg2);
    position: relative;
    z-index: 1;
    flex-wrap: wrap;
    animation: fadeInDown 0.6s 0.3s ease both;
  }
  .stat { text-align: center; }
  .stat-num {
    font-family: 'Space Mono', monospace;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--accent);
    display: block;
    line-height: 1;
  }
  .stat-num.green  { color: var(--safe); }
  .stat-num.orange { color: var(--accent2); }
  .stat-num.purple { color: var(--purple); }
  .stat-label {
    font-size: 0.72rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-top: 4px;
  }

  /* â”€â”€ CONTAINER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 50px 30px;
    position: relative;
    z-index: 1;
  }

  /* â”€â”€ SECTION HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .section-header {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-bottom: 28px;
  }
  .section-icon {
    width: 38px; height: 38px;
    background: rgba(0,119,170,0.08);
    border: 1px solid rgba(0,119,170,0.2);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.1rem;
    flex-shrink: 0;
  }
  .section-title {
    font-family: 'Syne', sans-serif;
    font-size: 1.3rem;
    font-weight: 600;
    letter-spacing: -0.01em;
  }
  .section-title small {
    display: block;
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-top: 2px;
  }

  /* â”€â”€ PACKET DIAGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .packet-section { margin-bottom: 60px; }

  .packet-diagram {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 4px 24px rgba(0,0,0,0.06);
  }
  .packet-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 20px;
    background: var(--bg2);
    border-bottom: 1px solid var(--border);
    gap: 12px;
    flex-wrap: wrap;
  }
  .packet-toolbar-title {
    font-family: 'Syne', sans-serif;
    font-weight: 600;
    font-size: 0.9rem;
  }
  .packet-toolbar-hint {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
  }
  .packet-body { padding: 28px 24px; }

  /* Row label showing bit-width */
  .row-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 6px;
    margin-top: 16px;
  }
  .row-label:first-child { margin-top: 0; }

  /* Multi-field row (for the first 32-bit row) */
  .field-row {
    display: flex;
    gap: 6px;
    margin-bottom: 6px;
  }
  .field-row .header-field { flex: 1; margin-bottom: 0; }

  /* Individual clickable field */
  .header-field {
    display: flex;
    align-items: center;
    margin-bottom: 6px;
    border-radius: 10px;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.34,1.4,0.64,1);
    overflow: hidden;
    position: relative;
    user-select: none;
  }
  .header-field:hover {
    transform: translateX(4px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  }
  .header-field.active {
    border-color: var(--accent);
    box-shadow: 0 4px 20px rgba(0,119,170,0.15);
    transform: translateX(6px);
  }
  /* Suppress translateX on multi-field rows */
  .field-row .header-field:hover  { transform: translateY(-2px); }
  .field-row .header-field.active { transform: translateY(-2px); }

  .field-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    padding: 10px 14px;
    white-space: nowrap;
    color: #fff;
    letter-spacing: 0.03em;
    display: flex;
    align-items: center;
    gap: 6px;
    min-width: 0;
  }
  /* Wide labels for standalone full-width rows */
  .header-field.wide .field-label { min-width: 220px; }

  .field-label .field-icon { font-size: 0.95rem; }

  .field-bar {
    flex: 1;
    height: 42px;
    position: relative;
    overflow: hidden;
  }
  .field-bar-fill {
    position: absolute;
    inset: 0;
    opacity: 0.12;
    transition: opacity 0.2s;
  }
  .header-field.active .field-bar-fill { opacity: 0.22; }

  /* â”€â”€ KEY FIX: white text on colored bars â”€â”€â”€â”€â”€â”€â”€â”€ */
  .field-variable {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    color: rgba(255,255,255,0.75);
    letter-spacing: 0.05em;
    white-space: nowrap;
  }
  .field-bytes {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 0.76rem;
    color: rgba(255,255,255,0.92);
    font-weight: 400;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: calc(100% - 100px);
  }

  /* Field color palette */
  .hf-leap       { background: #0077aa; }
  .hf-version    { background: #2563a8; }
  .hf-mode       { background: #7744bb; }
  .hf-stratum    { background: #007a7a; }
  .hf-poll       { background: #1a7f37; }
  .hf-precision  { background: #3a6f30; }
  .hf-rootdelay  { background: #b07800; }
  .hf-rootdisp   { background: #9c6000; }
  .hf-refid      { background: #d94f00; }
  .hf-reftimestamp  { background: #c03a00; }
  .hf-origtimestamp { background: #7744bb; }
  .hf-recvtimestamp { background: #5c2fa0; }
  .hf-transtimestamp{ background: #3a1e80; }

  .hf-leap       .field-bar-fill { background: #0077aa; }
  .hf-version    .field-bar-fill { background: #2563a8; }
  .hf-mode       .field-bar-fill { background: #7744bb; }
  .hf-stratum    .field-bar-fill { background: #007a7a; }
  .hf-poll       .field-bar-fill { background: #1a7f37; }
  .hf-precision  .field-bar-fill { background: #3a6f30; }
  .hf-rootdelay  .field-bar-fill { background: #b07800; }
  .hf-rootdisp   .field-bar-fill { background: #9c6000; }
  .hf-refid      .field-bar-fill { background: #d94f00; }
  .hf-reftimestamp  .field-bar-fill { background: #c03a00; }
  .hf-origtimestamp .field-bar-fill { background: #7744bb; }
  .hf-recvtimestamp .field-bar-fill { background: #5c2fa0; }
  .hf-transtimestamp.field-bar-fill { background: #3a1e80; }

  /* Detail panel */
  .detail-panel {
    margin-top: 20px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 22px 24px;
    display: none;
    animation: slideDown 0.25s ease;
  }
  .detail-panel.show { display: block; }
  @keyframes slideDown {
    from { opacity:0; transform:translateY(-8px); }
    to   { opacity:1; transform:translateY(0); }
  }
  .detail-panel-title {
    font-family: 'Syne', sans-serif;
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 10px;
  }
  .detail-panel p {
    color: var(--text-muted);
    font-size: 0.9rem;
    line-height: 1.7;
    margin-bottom: 12px;
  }
  .example-label {
    font-family: 'DM Sans', sans-serif;
    font-size: 0.72rem;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 6px;
    font-weight: 500;
  }
  .example-box {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    color: var(--accent);
    line-height: 1.7;
    overflow-x: auto;
  }

  /* â”€â”€ NTP SYNC ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .sync-section { margin-bottom: 60px; }

  .sync-diagram {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 32px 28px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.06);
  }

  .sync-grid {
    display: grid;
    grid-template-columns: 160px 1fr 160px;
    align-items: start;
    gap: 0;
  }

  .sync-actor { text-align: center; }
  .sync-actor-icon {
    width: 64px; height: 64px;
    background: var(--surface2);
    border: 2px solid var(--border);
    border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.8rem;
    margin: 0 auto 10px;
  }
  .sync-actor-name {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.07em;
    line-height: 1.4;
  }

  .sync-steps {
    padding: 0 8px;
    position: relative;
  }
  .sync-steps::before {
    content: '';
    position: absolute;
    left: 50%; top: 0; bottom: 0;
    width: 1px;
    background: var(--border);
    transform: translateX(-50%);
  }

  .sync-step {
    display: flex;
    align-items: center;
    margin-bottom: 18px;
    opacity: 0;
    transform: translateY(8px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  .sync-step.visible { opacity: 1; transform: translateY(0); }
  .sync-step.c2s { flex-direction: row; }
  .sync-step.s2c { flex-direction: row-reverse; }

  .sync-arrow { flex: 1; display: flex; align-items: center; height: 38px; }
  .sync-line  { flex: 1; height: 2px; position: relative; }

  .sync-step.c2s .sync-line { background: linear-gradient(90deg, var(--accent), transparent 80%); }
  .sync-step.s2c .sync-line { background: linear-gradient(270deg, var(--teal), transparent 80%); }

  .sync-arrowhead { width:0; height:0; flex-shrink:0; }
  .sync-step.c2s .sync-arrowhead {
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-left: 9px solid var(--accent);
  }
  .sync-step.s2c .sync-arrowhead {
    border-top: 6px solid transparent;
    border-bottom: 6px solid transparent;
    border-right: 9px solid var(--teal);
  }

  .sync-label {
    position: absolute;
    top: -21px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Space Mono', monospace;
    font-size: 0.62rem;
    font-weight: 700;
    white-space: nowrap;
    padding: 3px 8px;
    border-radius: 100px;
    letter-spacing: 0.04em;
  }
  .sync-step.c2s .sync-label {
    background: rgba(0,119,170,0.10);
    color: var(--accent);
    border: 1px solid rgba(0,119,170,0.22);
  }
  .sync-step.s2c .sync-label {
    background: rgba(0,122,122,0.10);
    color: var(--teal);
    border: 1px solid rgba(0,122,122,0.22);
  }

  .sync-num {
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    color: var(--text-muted);
    width: 20px;
    text-align: center;
    flex-shrink: 0;
  }

  .sync-legend {
    display: flex;
    gap: 20px;
    margin-top: 20px;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
  }
  .sync-legend-items { display: flex; gap: 20px; flex-wrap: wrap; }
  .sync-legend-item {
    display: flex; align-items: center; gap: 7px;
    font-size: 0.78rem; color: var(--text-muted);
  }
  .sync-legend-dot { width:10px; height:10px; border-radius:50%; flex-shrink:0; }

  .replay-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 18px;
    background: rgba(0,119,170,0.08);
    border: 1px solid rgba(0,119,170,0.25);
    border-radius: 100px;
    color: var(--accent);
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.05em;
  }
  .replay-btn:hover { background: rgba(0,119,170,0.16); transform: scale(1.03); }

  /* â”€â”€ STRATUM TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .stratum-section { margin-bottom: 60px; }

  .stratum-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px,1fr));
    gap: 12px;
  }
  .stratum-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 18px 20px;
    display: flex;
    align-items: flex-start;
    gap: 14px;
    transition: all 0.2s;
    border-left: 4px solid transparent;
  }
  .stratum-card:hover { box-shadow: 0 4px 18px rgba(0,0,0,0.08); transform: translateY(-2px); }

  .stratum-card.s0  { border-left-color: #cc2233; }
  .stratum-card.s1  { border-left-color: #d94f00; }
  .stratum-card.s2  { border-left-color: #b07800; }
  .stratum-card.s3  { border-left-color: #1a7f37; }
  .stratum-card.s15 { border-left-color: #7744bb; }
  .stratum-card.s16 { border-left-color: #4a6580; }

  .stratum-num {
    font-family: 'Space Mono', monospace;
    font-size: 1.4rem;
    font-weight: 700;
    line-height: 1;
    flex-shrink: 0;
    width: 42px;
    text-align: center;
  }
  .s0  .stratum-num { color: #cc2233; }
  .s1  .stratum-num { color: #d94f00; }
  .s2  .stratum-num { color: #b07800; }
  .s3  .stratum-num { color: #1a7f37; }
  .s15 .stratum-num { color: #7744bb; }
  .s16 .stratum-num { color: #4a6580; }

  .stratum-info { flex:1; }
  .stratum-name {
    font-family: 'Syne', sans-serif;
    font-weight: 600;
    font-size: 0.92rem;
    margin-bottom: 4px;
  }
  .stratum-desc {
    font-size: 0.8rem;
    color: var(--text-muted);
    line-height: 1.5;
    font-weight: 300;
  }

  /* â”€â”€ COMPARISON TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .compare-section { margin-bottom: 60px; }

  .compare-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 24px rgba(0,0,0,0.05);
    font-size: 0.875rem;
  }
  .compare-table thead { background: var(--bg2); }
  .compare-table th {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    padding: 14px 20px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }
  .compare-table th.ntp-col   { color: var(--accent); }
  .compare-table th.sntp-col  { color: var(--teal); }
  .compare-table th.ptp-col   { color: var(--accent2); }
  .compare-table td {
    padding: 14px 20px;
    border-bottom: 1px solid rgba(196,212,226,0.5);
    vertical-align: top;
    line-height: 1.55;
    color: var(--text-muted);
  }
  .compare-table tr:last-child td { border-bottom: none; }
  .compare-table tr:hover td { background: rgba(0,119,170,0.03); }
  .compare-table td:first-child {
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--text);
    white-space: nowrap;
  }
  .good { color: var(--safe); font-weight: 500; }
  .bad  { color: var(--danger); font-weight: 500; }
  .warn { color: var(--warning); font-weight: 500; }

  /* â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .quiz-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 18px;
    overflow: hidden;
    margin-bottom: 60px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.05);
  }
  .quiz-header {
    background: linear-gradient(135deg, rgba(0,119,170,0.07), rgba(0,122,122,0.07));
    border-bottom: 1px solid var(--border);
    padding: 20px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
  }
  .quiz-title { font-family: 'Syne', sans-serif; font-size: 1.15rem; font-weight: 600; }
  .quiz-score {
    font-family: 'Space Mono', monospace;
    font-size: 0.85rem;
    color: var(--text-muted);
  }
  .quiz-score span { color: var(--safe); font-weight: 700; }
  .quiz-body { padding: 28px 24px; }

  .progress-bar {
    height: 3px;
    background: var(--border);
    border-radius: 100px;
    overflow: hidden;
    margin-bottom: 24px;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), #5080dc);
    border-radius: 100px;
    transition: width 0.4s ease;
  }

  .question-text {
    font-size: 1.05rem;
    font-weight: 400;
    margin-bottom: 20px;
    line-height: 1.6;
  }
  .question-text em {
    color: var(--accent);
    font-style: normal;
    font-family: 'Space Mono', monospace;
  }

  .options { display: flex; flex-direction: column; gap: 10px; }
  .option {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 18px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.9rem;
    line-height: 1.4;
    color: var(--text);
  }
  .option:hover:not(.disabled) { border-color: var(--accent); background: rgba(0,119,170,0.06); }
  .option.correct  { background: rgba(26,127,55,0.08);  border-color: var(--safe);   color: #145e2a; }
  .option.wrong    { background: rgba(204,34,51,0.08);   border-color: var(--danger); color: #a01828; }
  .option.disabled { cursor: default; }

  .option-letter {
    width: 28px; height: 28px;
    background: rgba(0,0,0,0.06);
    border-radius: 6px;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    font-weight: 700;
    flex-shrink: 0;
    color: var(--text-muted);
  }
  .option.correct .option-letter { background: var(--safe);   color: #fff; }
  .option.wrong   .option-letter { background: var(--danger); color: #fff; }

  .quiz-feedback {
    margin-top: 18px;
    padding: 14px 18px;
    border-radius: 12px;
    font-size: 0.88rem;
    line-height: 1.6;
    display: none;
  }
  .quiz-feedback.show    { display: block; animation: slideDown 0.2s ease; }
  .quiz-feedback.correct { background: rgba(26,127,55,0.07);  border: 1px solid rgba(26,127,55,0.25);  color: #145e2a; }
  .quiz-feedback.wrong   { background: rgba(204,34,51,0.07);  border: 1px solid rgba(204,34,51,0.25);  color: #a01828; }

  .quiz-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 24px;
  }
  .q-counter {
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    color: var(--text-muted);
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 10px 20px;
    border-radius: 10px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
    outline: none;
  }
  .btn-primary { background: var(--accent); color: #fff; font-weight: 700; }
  .btn-primary:hover { background: #0060a0; transform: translateY(-1px); }

  /* â”€â”€ SCROLL REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .reveal {
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  .reveal.visible { opacity:1; transform:translateY(0); }

  /* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  footer {
    text-align: center;
    padding: 32px 20px;
    color: var(--text-muted);
    font-size: 0.8rem;
    border-top: 1px solid var(--border);
    position: relative;
    z-index: 1;
    font-family: 'Space Mono', monospace;
    background: var(--bg2);
  }

  /* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  @media (max-width: 700px) {
    .hero { padding: 50px 20px 40px; }
    .container { padding: 30px 16px; }
    .field-label { font-size: 0.64rem; padding: 8px 8px; }
    .sync-grid { grid-template-columns: 70px 1fr 70px; }
    .sync-actor-icon { width:44px; height:44px; font-size:1.2rem; }
    .sync-actor-name { font-size:0.58rem; }
    .stratum-grid { grid-template-columns: 1fr; }
    .field-row { flex-direction: column; }
  }
</style>
</head>
<body>

<!-- â”€â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<header class="hero">
  <div class="hero-badge">Application Layer Protocol Â· UDP Port 123</div>
  <span class="hero-icon">ğŸ•</span>
  <h1><span>NTP</span> Protocol</h1>
  <p>Network Time Protocol â€” synchronizes clocks across computer networks to within a few milliseconds of Coordinated Universal Time (UTC). Designed by David L. Mills, NTP is one of the oldest internet protocols still in active use.</p>
</header>

<!-- â”€â”€â”€ STATS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="stats-bar">
  <div class="stat">
    <span class="stat-num">123</span>
    <div class="stat-label">UDP Port</div>
  </div>
  <div class="stat">
    <span class="stat-num green">Â±1 ms</span>
    <div class="stat-label">LAN Accuracy</div>
  </div>
  <div class="stat">
    <span class="stat-num purple">NTPv4</span>
    <div class="stat-label">Current Version</div>
  </div>
  <div class="stat">
    <span class="stat-num orange">16</span>
    <div class="stat-label">Stratum Levels</div>
  </div>
</div>

<div class="container">

  <!-- â”€â”€â”€ INTERACTIVE PACKET DIAGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="packet-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ“¦</div>
      <div class="section-title">
        NTP Header Fields
        <small>Click any field to expand its description and see bit-level details</small>
      </div>
    </div>

    <div class="packet-diagram">
      <div class="packet-toolbar">
        <div class="packet-toolbar-title">NTP Packet Structure (48 bytes)</div>
        <div class="packet-toolbar-hint">â†™ Click a field row to inspect it</div>
      </div>
      <div class="packet-body">

        <!-- Row 1: 32 bits â€” LI + VN + Mode + Stratum -->
        <div class="row-label">Row 1 â€” Bits 0â€“31</div>
        <div class="field-row">
          <div class="header-field hf-leap" id="hf-leap" onclick="toggleField('leap')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">âš¡</span> LI</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">2 bits</span>
              <span class="field-variable">Leap Indicator</span>
            </div>
          </div>
          <div class="header-field hf-version" id="hf-version" onclick="toggleField('version')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ“‹</span> VN</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">3 bits</span>
              <span class="field-variable">Version Number</span>
            </div>
          </div>
          <div class="header-field hf-mode" id="hf-mode" onclick="toggleField('mode')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ”€</span> Mode</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">3 bits</span>
              <span class="field-variable">Mode</span>
            </div>
          </div>
          <div class="header-field hf-stratum" id="hf-stratum" onclick="toggleField('stratum')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ—ï¸</span> Stratum</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">8 bits</span>
              <span class="field-variable">Stratum Level</span>
            </div>
          </div>
        </div>

        <!-- Row 2: Poll + Precision + Root Delay -->
        <div class="row-label">Row 2 â€” Bits 32â€“63</div>
        <div class="field-row">
          <div class="header-field hf-poll" id="hf-poll" onclick="toggleField('poll')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ”</span> Poll</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">8 bits</span>
              <span class="field-variable">Poll Interval</span>
            </div>
          </div>
          <div class="header-field hf-precision" id="hf-precision" onclick="toggleField('precision')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ¯</span> Precision</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">8 bits</span>
              <span class="field-variable">Clock Precision</span>
            </div>
          </div>
          <div class="header-field hf-rootdelay" id="hf-rootdelay" onclick="toggleField('rootdelay')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ“¡</span> Root Delay</div>
            <div class="field-bar">
              <div class="field-bar-fill"></div>
              <span class="field-bytes">16 bits</span>
              <span class="field-variable">32-bit total</span>
            </div>
          </div>
        </div>

        <!-- Row 3â€“5: full-width 32/64-bit fields -->
        <div class="row-label">Row 3 â€” Bits 64â€“95 (32 bits)</div>
        <div class="header-field hf-rootdisp wide" id="hf-rootdisp" onclick="toggleField('rootdisp')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ“Š</span> Root Dispersion</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">Max error relative to primary reference</span>
            <span class="field-variable">32 bits</span>
          </div>
        </div>

        <div class="row-label">Row 4 â€” Bits 96â€“127 (32 bits)</div>
        <div class="header-field hf-refid wide" id="hf-refid" onclick="toggleField('refid')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ”–</span> Reference ID</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">Reference clock identifier (ASCII or IP)</span>
            <span class="field-variable">32 bits</span>
          </div>
        </div>

        <div class="row-label">Row 5â€“6 â€” Bits 128â€“191 (64 bits)</div>
        <div class="header-field hf-reftimestamp wide" id="hf-reftimestamp" onclick="toggleField('reftimestamp')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ•“</span> Reference Timestamp</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">When the system clock was last set or corrected</span>
            <span class="field-variable">64 bits</span>
          </div>
        </div>

        <div class="row-label">Row 7â€“8 â€” Bits 192â€“255 (64 bits)</div>
        <div class="header-field hf-origtimestamp wide" id="hf-origtimestamp" onclick="toggleField('origtimestamp')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸš€</span> Originate Timestamp</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">Time request left the client (T1)</span>
            <span class="field-variable">64 bits</span>
          </div>
        </div>

        <div class="row-label">Row 9â€“10 â€” Bits 256â€“319 (64 bits)</div>
        <div class="header-field hf-recvtimestamp wide" id="hf-recvtimestamp" onclick="toggleField('recvtimestamp')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ“¥</span> Receive Timestamp</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">Time request arrived at the server (T2)</span>
            <span class="field-variable">64 bits</span>
          </div>
        </div>

        <div class="row-label">Row 11â€“12 â€” Bits 320â€“383 (64 bits)</div>
        <div class="header-field hf-transtimestamp wide" id="hf-transtimestamp" onclick="toggleField('transtimestamp')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ“¤</span> Transmit Timestamp</div>
          <div class="field-bar">
            <div class="field-bar-fill"></div>
            <span class="field-bytes">Time reply left the server (T3)</span>
            <span class="field-variable">64 bits</span>
          </div>
        </div>

        <!-- Detail panel -->
        <div class="detail-panel" id="field-detail">
          <div class="detail-panel-title" id="detail-title"></div>
          <p id="detail-desc"></p>
          <div class="example-label">Values / Example</div>
          <div class="example-box" id="detail-example"></div>
        </div>

      </div><!-- packet-body -->
    </div><!-- packet-diagram -->
  </div><!-- packet-section -->

  <!-- â”€â”€â”€ NTP SYNC ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="sync-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ”„</div>
      <div class="section-title">
        NTP Clock Synchronization
        <small>How a client calculates offset and delay using four timestamps</small>
      </div>
    </div>

    <div class="sync-diagram">
      <div class="sync-grid">

        <div class="sync-actor">
          <div class="sync-actor-icon">ğŸ’»</div>
          <div class="sync-actor-name">NTP Client</div>
        </div>

        <div class="sync-steps" id="sync-steps">
          <div class="sync-step c2s" id="ss1">
            <span class="sync-num">1</span>
            <div class="sync-arrow">
              <div class="sync-line"><span class="sync-label">Request (T1 = Originate Timestamp)</span></div>
              <div class="sync-arrowhead"></div>
            </div>
            <span class="sync-num"></span>
          </div>
          <div class="sync-step s2c" id="ss2">
            <span class="sync-num"></span>
            <div class="sync-arrow">
              <div class="sync-line"><span class="sync-label">Response (T2=Receive, T3=Transmit)</span></div>
              <div class="sync-arrowhead"></div>
            </div>
            <span class="sync-num">2</span>
          </div>
          <div class="sync-step c2s" id="ss3">
            <span class="sync-num">3</span>
            <div class="sync-arrow">
              <div class="sync-line"><span class="sync-label">T4 = Client records arrival time</span></div>
              <div class="sync-arrowhead"></div>
            </div>
            <span class="sync-num"></span>
          </div>
          <div class="sync-step s2c" id="ss4">
            <span class="sync-num"></span>
            <div class="sync-arrow">
              <div class="sync-line"><span class="sync-label">Offset = ((T2âˆ’T1)+(T3âˆ’T4)) / 2</span></div>
              <div class="sync-arrowhead"></div>
            </div>
            <span class="sync-num">4</span>
          </div>
          <div class="sync-step c2s" id="ss5">
            <span class="sync-num">5</span>
            <div class="sync-arrow">
              <div class="sync-line"><span class="sync-label">Client adjusts local clock by offset</span></div>
              <div class="sync-arrowhead"></div>
            </div>
            <span class="sync-num"></span>
          </div>
        </div>

        <div class="sync-actor">
          <div class="sync-actor-icon">ğŸ›°ï¸</div>
          <div class="sync-actor-name">NTP Server<br>(Stratum 1/2)</div>
        </div>
      </div>

      <div class="sync-legend">
        <div class="sync-legend-items">
          <div class="sync-legend-item"><div class="sync-legend-dot" style="background:var(--accent)"></div> Client â†’ Server</div>
          <div class="sync-legend-item"><div class="sync-legend-dot" style="background:var(--teal)"></div> Server â†’ Client / Calculation</div>
        </div>
        <button class="replay-btn" onclick="replaySync()">â†º Replay Animation</button>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€ STRATUM LEVELS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="stratum-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ—ï¸</div>
      <div class="section-title">
        NTP Stratum Levels
        <small>The hierarchy that determines clock accuracy and trust</small>
      </div>
    </div>

    <div class="stratum-grid">
      <div class="stratum-card s0">
        <div class="stratum-num">0</div>
        <div class="stratum-info">
          <div class="stratum-name">Reference Clock (Stratum 0)</div>
          <div class="stratum-desc">Highly accurate timekeeping devices â€” atomic clocks, GPS receivers, radio clocks. Not directly accessible on the network.</div>
        </div>
      </div>
      <div class="stratum-card s1">
        <div class="stratum-num">1</div>
        <div class="stratum-info">
          <div class="stratum-name">Primary Time Server (Stratum 1)</div>
          <div class="stratum-desc">Directly connected to a Stratum 0 device. Highest accuracy NTP servers; the root of the time hierarchy.</div>
        </div>
      </div>
      <div class="stratum-card s2">
        <div class="stratum-num">2</div>
        <div class="stratum-info">
          <div class="stratum-name">Secondary Server (Stratum 2)</div>
          <div class="stratum-desc">Synchronizes with Stratum 1 servers. These are the most commonly used public NTP servers (e.g., pool.ntp.org).</div>
        </div>
      </div>
      <div class="stratum-card s3">
        <div class="stratum-num">3</div>
        <div class="stratum-info">
          <div class="stratum-name">Tertiary Server (Stratum 3)</div>
          <div class="stratum-desc">Syncs with Stratum 2. Common in enterprise networks as local time servers for end devices.</div>
        </div>
      </div>
      <div class="stratum-card s15">
        <div class="stratum-num">15</div>
        <div class="stratum-info">
          <div class="stratum-name">Maximum Stratum (15)</div>
          <div class="stratum-desc">Highest valid stratum. Indicates increasing distance from the reference clock and lower accuracy.</div>
        </div>
      </div>
      <div class="stratum-card s16">
        <div class="stratum-num">16</div>
        <div class="stratum-info">
          <div class="stratum-name">Unsynchronized (Stratum 16)</div>
          <div class="stratum-desc">A stratum of 16 means the server is unsynchronized and its time should not be trusted.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€ COMPARISON TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="compare-section reveal">
    <div class="section-header">
      <div class="section-icon">âš–ï¸</div>
      <div class="section-title">
        NTP vs SNTP vs PTP
        <small>Comparing time synchronization protocols</small>
      </div>
    </div>

    <table class="compare-table">
      <thead>
        <tr>
          <th>Feature</th>
          <th class="ntp-col">ğŸ• NTP</th>
          <th class="sntp-col">âš¡ SNTP</th>
          <th class="ptp-col">ğŸ¯ PTP (IEEE 1588)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Full Name</td>
          <td>Network Time Protocol</td>
          <td>Simple NTP</td>
          <td>Precision Time Protocol</td>
        </tr>
        <tr>
          <td>Accuracy</td>
          <td><span class="good">Â±1â€“50 ms (LAN)</span></td>
          <td><span class="warn">Â±100 ms typical</span></td>
          <td><span class="good">Sub-microsecond</span></td>
        </tr>
        <tr>
          <td>Protocol</td>
          <td>UDP Port 123</td>
          <td>UDP Port 123</td>
          <td>UDP / Ethernet (hardware)</td>
        </tr>
        <tr>
          <td>Complexity</td>
          <td><span class="warn">Moderate</span></td>
          <td><span class="good">Low / Simple</span></td>
          <td><span class="bad">High</span></td>
        </tr>
        <tr>
          <td>Use Case</td>
          <td>General network time sync</td>
          <td>Embedded / IoT devices</td>
          <td>Financial, telecom, industrial</td>
        </tr>
        <tr>
          <td>Authentication</td>
          <td>Symmetric key / NTS</td>
          <td>None typically</td>
          <td>Optional</td>
        </tr>
        <tr>
          <td>DDoS Risk</td>
          <td><span class="bad">Monlist amplification</span></td>
          <td><span class="warn">Lower risk</span></td>
          <td><span class="good">Not typically</span></td>
        </tr>
        <tr>
          <td>Stratum Hierarchy</td>
          <td><span class="good">Full (0â€“15)</span></td>
          <td>Subset</td>
          <td>Master/Slave model</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- â”€â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div class="reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ§ </div>
      <div class="section-title">
        Knowledge Check Quiz
        <small>Test your understanding of NTP and time synchronization</small>
      </div>
    </div>

    <div class="quiz-section">
      <div class="quiz-header">
        <div class="quiz-title">NTP Protocol Quiz</div>
        <div class="quiz-score">Score: <span id="score-display">0</span> / <span id="total-display">0</span></div>
      </div>
      <div class="quiz-body">
        <div class="progress-bar"><div class="progress-fill" id="quiz-progress" style="width:0%"></div></div>
        <div class="question-text" id="question-text"></div>
        <div class="options" id="options-container"></div>
        <div class="quiz-feedback" id="quiz-feedback"></div>
        <div class="quiz-nav">
          <div class="q-counter" id="q-counter"></div>
          <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" style="display:none;">Next Question â†’</button>
        </div>
      </div>
    </div>
  </div>

</div><!-- /.container -->

<footer>Â© 2024 NTP Protocol Analysis Â· Moraine Valley Community College &nbsp;|&nbsp; Network Security Curriculum</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€ FIELD DETAIL DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const fieldData = {
  leap: {
    title: 'âš¡ Leap Indicator (LI) â€” 2 bits',
    color: '#0077aa',
    desc: 'A 2-bit code warning of an impending leap second to be inserted or deleted in the last minute of the current day. The leap second is an occasional one-second adjustment applied to Coordinated Universal Time (UTC) to keep it close to mean solar time. Security note: attackers can manipulate the LI field to disrupt time-dependent authentication and logging systems.',
    example: '00 â€” No warning (normal operation)\n01 â€” Last minute of the day has 61 seconds\n10 â€” Last minute of the day has 59 seconds\n11 â€” Clock is unsynchronized / unknown'
  },
  version: {
    title: 'ğŸ“‹ Version Number (VN) â€” 3 bits',
    color: '#2563a8',
    desc: 'Indicates the NTP version number currently in use. NTPv4 (value 4) is the current standard defined in RFC 5905. It added support for IPv6, improved security extensions, and better handling of leap seconds. NTPv3 (RFC 1305) is still widely encountered on older systems.',
    example: '3 â€” NTPv3 (RFC 1305, legacy)\n4 â€” NTPv4 (RFC 5905, current standard)\n\n# Most modern deployments use NTPv4\n# Value encoded in 3 bits: 0â€“7 possible'
  },
  mode: {
    title: 'ğŸ”€ Mode â€” 3 bits',
    color: '#7744bb',
    desc: 'Indicates the operational mode of the NTP entity sending the packet. Client/server mode is most common in everyday deployments. Broadcast mode is efficient for large local networks but lacks authentication by default, making it a security risk.',
    example: '0 â€” Reserved\n1 â€” Symmetric Active\n2 â€” Symmetric Passive\n3 â€” Client\n4 â€” Server\n5 â€” Broadcast\n6 â€” NTP Control Message\n7 â€” Reserved for private use'
  },
  stratum: {
    title: 'ğŸ—ï¸ Stratum â€” 8 bits',
    color: '#007a7a',
    desc: 'Indicates the stratum level of the reference clock. Stratum 0 is the highest-quality hardware reference (atomic clock, GPS); Stratum 1 servers are directly connected to Stratum 0; each subsequent level adds one hop. Stratum 16 means the server is unsynchronized. Low stratum = higher accuracy and trust.',
    example: '0  â€” Unspecified or reference clock\n1  â€” Primary reference (GPS, atomic clock)\n2  â€” Secondary reference (syncs with Stratum 1)\n3â€“15 â€” Further removed from reference\n16 â€” Unsynchronized (do not use)'
  },
  poll: {
    title: 'ğŸ” Poll Interval â€” 8 bits',
    color: '#1a7f37',
    desc: 'The maximum interval between successive NTP messages, expressed as a power of 2 (logâ‚‚ seconds). A value of 6 means 2â¶ = 64 seconds between polls; a value of 10 means 2Â¹â° = 1024 seconds (~17 minutes). Shorter poll intervals provide better accuracy but increase network traffic.',
    example: '4  â€” 2â´ = 16 seconds (minimum typical)\n6  â€” 2â¶ = 64 seconds\n8  â€” 2â¸ = 256 seconds (~4 min)\n10 â€” 2Â¹â° = 1024 seconds (~17 min, typical max)'
  },
  precision: {
    title: 'ğŸ¯ Precision â€” 8 bits',
    color: '#3a6f30',
    desc: 'Indicates the precision of the local clock in logâ‚‚ seconds (a signed 8-bit integer). For instance, âˆ’18 means 2â»Â¹â¸ â‰ˆ 3.8 microseconds precision. Modern system clocks typically report values between âˆ’20 and âˆ’6. This helps NTP clients weigh different server responses appropriately.',
    example: '-6  â€” 2â»â¶ â‰ˆ 15.6 ms (low precision, e.g. modem)\n-10 â€” 2â»Â¹â° â‰ˆ 1 ms  (typical software clock)\n-18 â€” 2â»Â¹â¸ â‰ˆ 3.8 Âµs (high-precision hardware)\n-20 â€” 2â»Â²â° â‰ˆ 1 Âµs  (atomic / GPS reference)'
  },
  rootdelay: {
    title: 'ğŸ“¡ Root Delay â€” 32 bits',
    color: '#b07800',
    desc: 'The total round-trip delay to the primary reference source, in NTP short format (16 bits integer + 16 bits fraction, in seconds). This value is the sum of network delays along the entire chain from the server to its Stratum 0 reference. A low root delay indicates a well-connected, low-latency time source.',
    example: '0x00000000 â€” Zero delay (local reference)\n0x00000064 â€” ~100 ms round-trip delay\n\n# Format: 16-bit integer.16-bit fraction\n# e.g. 0x00010000 = 1.000 seconds of delay'
  },
  rootdisp: {
    title: 'ğŸ“Š Root Dispersion â€” 32 bits',
    color: '#9c6000',
    desc: 'The maximum error relative to the primary reference source, expressed in NTP short format. Root dispersion accumulates across stratum levels â€” each hop adds jitter and drift. High root dispersion indicates degraded time quality. NTP clients should prefer servers with lower root dispersion values.',
    example: '0x00000010 â€” ~15 ms dispersion (very good)\n0x00000100 â€” ~256 ms dispersion (poor quality)\n\n# Dispersion increases with each stratum hop\n# Used by clients to select the best server'
  },
  refid: {
    title: 'ğŸ”– Reference ID â€” 32 bits',
    color: '#d94f00',
    desc: 'Identifies the particular reference clock. For Stratum 1 servers, this is a 4-character ASCII code identifying the reference source (e.g., GPS, ATOM, PPS). For Stratum 2+ servers, it is the IP address of the upstream NTP server. Used by NTP clients to detect and prevent synchronization loops.',
    example: '"GPS " â€” GPS satellite receiver\n"ATOM" â€” Atomic clock\n"PPS " â€” Pulse-Per-Second signal\n"ACTS" â€” NIST dial-up service\n"USNO" â€” U.S. Naval Observatory\n192.168.1.1 â€” IP of upstream server (S2+)'
  },
  reftimestamp: {
    title: 'ğŸ•“ Reference Timestamp â€” 64 bits',
    color: '#c03a00',
    desc: 'The time at which the local clock was last set or corrected, in NTP timestamp format. This 64-bit value consists of a 32-bit unsigned integer (seconds since Jan 1, 1900) and a 32-bit fraction. A missing or zero reference timestamp indicates the server has never been synchronized.',
    example: '# NTP Timestamp Format:\n# 32-bit seconds since 01-Jan-1900\n# 32-bit fractional seconds\n\nExample (UTC): 2024-03-15 14:30:00.123456\nSeconds: 3921868200 (since NTP epoch)\nFraction: 530000000 / 2Â³Â² â‰ˆ 0.123 sec'
  },
  origtimestamp: {
    title: 'ğŸš€ Originate Timestamp (T1) â€” 64 bits',
    color: '#7744bb',
    desc: 'The time at which the request departed the client for the server (T1). This is recorded by the client when it sends the request and echoed back in the server\'s response. Used along with T2, T3, and T4 to calculate round-trip delay and clock offset. Security note: NTP reflection attacks forge this field.',
    example: '# Used in clock offset formula:\n# Offset  = ((T2 - T1) + (T3 - T4)) / 2\n# Delay   = (T4 - T1) - (T3 - T2)\n\nT1 = Client send time (Originate)\nT2 = Server receive time\nT3 = Server send time (Transmit)\nT4 = Client receive time (recorded locally)'
  },
  recvtimestamp: {
    title: 'ğŸ“¥ Receive Timestamp (T2) â€” 64 bits',
    color: '#5c2fa0',
    desc: 'The time at which the NTP request arrived at the server (T2). Recorded by the server\'s clock as accurately as possible. The difference between T2 and T1 represents the one-way network delay from client to server, plus the clock offset between the two systems.',
    example: '# T2 is set by the NTP server\n# It reflects server local time of packet arrival\n\nT2 - T1 = (network delay clientâ†’server)\n          + (clock offset)\n\n# High-accuracy servers timestamp at the\n# hardware/driver level for minimal jitter'
  },
  transtimestamp: {
    title: 'ğŸ“¤ Transmit Timestamp (T3) â€” 64 bits',
    color: '#3a1e80',
    desc: 'The time at which the NTP reply departed the server (T3). This is the most critical timestamp in the NTP packet â€” it is set as late as possible (just before transmission) to minimize error. Clients use T3 as the primary reference for computing the clock offset. Manipulation of T3 is the key attack vector in NTP-based time spoofing.',
    example: '# T3 is set by server immediately before sending\n# This minimizes "send timestamp" error\n\nClock Offset formula:\nÎ¸ = ((T2 âˆ’ T1) + (T3 âˆ’ T4)) / 2\n\nRound-trip Delay:\nÎ´ = (T4 âˆ’ T1) âˆ’ (T3 âˆ’ T2)\n\n# If Î´ < 0, it indicates a network anomaly'
  }
};

let activeField = null;

function toggleField(id) {
  const panel  = document.getElementById('field-detail');
  const field  = document.getElementById('hf-' + id);

  if (activeField === id) {
    panel.classList.remove('show');
    field.classList.remove('active');
    activeField = null;
    return;
  }
  if (activeField) {
    document.getElementById('hf-' + activeField).classList.remove('active');
  }
  activeField = id;
  const data = fieldData[id];
  field.classList.add('active');

  document.getElementById('detail-title').innerHTML = `<span style="color:${data.color}">${data.title}</span>`;
  document.getElementById('detail-desc').textContent = data.desc;
  document.getElementById('detail-example').innerHTML = data.example
    .replace(/\n/g, '<br>')
    .replace(/#.*/g, m => `<span style="color:var(--text-muted)">${m}</span>`);

  panel.classList.remove('show');
  void panel.offsetWidth;
  panel.classList.add('show');

  setTimeout(() => panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 50);
}

document.querySelectorAll('.header-field').forEach(el => {
  el.addEventListener('keydown', e => {
    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); el.click(); }
  });
});

// â”€â”€ NTP SYNC ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const syncSteps = document.querySelectorAll('.sync-step');

function runSync() {
  syncSteps.forEach((s, i) => {
    setTimeout(() => s.classList.add('visible'), 300 + i * 700);
  });
}
function replaySync() {
  syncSteps.forEach(s => s.classList.remove('visible'));
  setTimeout(runSync, 100);
}

const syncObserver = new IntersectionObserver(entries => {
  if (entries[0].isIntersecting) { runSync(); syncObserver.disconnect(); }
}, { threshold: 0.2 });
const syncSection = document.querySelector('.sync-section');
if (syncSection) syncObserver.observe(syncSection);

// â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const questions = [
  {
    q: "What transport protocol and port does <em>NTP</em> use?",
    opts: ["TCP port 80", "UDP port 123", "TCP port 443", "UDP port 161"],
    ans: 1,
    exp: "NTP uses UDP port 123. UDP is preferred because NTP messages are small and low latency is more important than guaranteed delivery."
  },
  {
    q: "A Stratum <em>1</em> NTP server gets its time from:",
    opts: [
      "Another NTP server on the internet",
      "A Stratum 2 server upstream",
      "A directly connected hardware reference clock (GPS, atomic clock)",
      "The local system clock"
    ],
    ans: 2,
    exp: "Stratum 1 servers are directly connected to Stratum 0 devices â€” high-precision hardware clocks like GPS receivers or atomic clocks. They are the most accurate NTP time sources."
  },
  {
    q: "What does a <em>Stratum 16</em> value indicate in an NTP packet?",
    opts: [
      "Highest possible accuracy",
      "The server is connected to a GPS clock",
      "The server clock is unsynchronized â€” do not use",
      "Maximum poll interval reached"
    ],
    ans: 2,
    exp: "Stratum 16 is a special value meaning the NTP server is unsynchronized. Clients should ignore time from a Stratum 16 source."
  },
  {
    q: "Which NTP attack exploits the <em>monlist</em> command to amplify DDoS traffic?",
    opts: [
      "NTP cache poisoning",
      "NTP reflection / amplification attack",
      "Man-in-the-middle time spoofing",
      "NTP stratum loop attack"
    ],
    ans: 1,
    exp: "NTP amplification exploits the monlist command (which returns a list of the last 600 clients) to generate massive traffic from small requests, amplifying DDoS attacks significantly."
  },
  {
    q: "In NTP's four-timestamp algorithm, what does T3 represent?",
    opts: [
      "Time the client sent the request",
      "Time the server received the request",
      "Time the server sent the reply",
      "Time the client received the reply"
    ],
    ans: 2,
    exp: "T3 is the Transmit Timestamp â€” when the NTP reply left the server. It is set as late as possible before transmission to minimize error. T1=client send, T2=server receive, T3=server send, T4=client receive."
  },
  {
    q: "The <em>Leap Indicator</em> field value of <strong>11</strong> (binary) signals:",
    opts: [
      "Last minute will have 61 seconds",
      "Last minute will have 59 seconds",
      "Clock is unsynchronized / alarm condition",
      "No leap second adjustment needed"
    ],
    ans: 2,
    exp: "LI = 11 (decimal 3) is an alarm condition meaning the clock is unsynchronized. LI=01 adds a second, LI=10 removes a second, LI=00 is normal."
  },
  {
    q: "Which security mechanism does <em>NTS (Network Time Security)</em> add to NTPv4?",
    opts: [
      "Encryption of timestamps using AES",
      "Authenticated key exchange using TLS to secure NTP messages",
      "A firewall rule blocking UDP port 123",
      "Stratum verification via DNS"
    ],
    ans: 1,
    exp: "NTS (RFC 8915) uses TLS/AEAD to provide authenticated key exchange for NTP, protecting against man-in-the-middle and replay attacks without requiring pre-shared keys."
  },
  {
    q: "How is the <em>clock offset</em> calculated from NTP's four timestamps?",
    opts: [
      "Î¸ = (T2 âˆ’ T1) + (T4 âˆ’ T3)",
      "Î¸ = ((T2 âˆ’ T1) + (T3 âˆ’ T4)) / 2",
      "Î¸ = (T4 âˆ’ T1) âˆ’ (T3 âˆ’ T2)",
      "Î¸ = T3 âˆ’ T2"
    ],
    ans: 1,
    exp: "Clock offset Î¸ = ((T2 âˆ’ T1) + (T3 âˆ’ T4)) / 2. This formula accounts for asymmetric network delays to estimate the true time difference between client and server."
  }
];

let current = 0, score = 0, answered = 0;

function renderQuestion() {
  const q = questions[current];
  document.getElementById('question-text').innerHTML = `<strong>Q${current + 1}.</strong> ${q.q}`;
  document.getElementById('q-counter').textContent = `Question ${current + 1} of ${questions.length}`;
  document.getElementById('quiz-progress').style.width = `${(current / questions.length) * 100}%`;
  document.getElementById('next-btn').style.display = 'none';
  const fb = document.getElementById('quiz-feedback');
  fb.className = 'quiz-feedback'; fb.textContent = '';

  const container = document.getElementById('options-container');
  container.innerHTML = '';
  ['A','B','C','D'].forEach((letter, i) => {
    if (q.opts[i] === undefined) return;
    const btn = document.createElement('div');
    btn.className = 'option';
    btn.innerHTML = `<span class="option-letter">${letter}</span><span>${q.opts[i]}</span>`;
    btn.onclick = () => selectAnswer(i, q.ans, q.exp);
    container.appendChild(btn);
  });
}

function selectAnswer(selected, correct, explanation) {
  document.querySelectorAll('.option').forEach((opt, i) => {
    opt.classList.add('disabled');
    opt.onclick = null;
    if (i === correct) opt.classList.add('correct');
    else if (i === selected) opt.classList.add('wrong');
  });
  answered++;
  if (selected === correct) score++;
  document.getElementById('score-display').textContent = score;
  document.getElementById('total-display').textContent = answered;

  const fb = document.getElementById('quiz-feedback');
  fb.className = `quiz-feedback show ${selected === correct ? 'correct' : 'wrong'}`;
  fb.textContent = (selected === correct ? 'âœ“ Correct! ' : 'âœ— Incorrect. ') + explanation;
  document.getElementById('quiz-progress').style.width = `${((current + 1) / questions.length) * 100}%`;

  const nextBtn = document.getElementById('next-btn');
  nextBtn.textContent = current < questions.length - 1 ? 'Next Question â†’' : 'ğŸ View Results';
  nextBtn.onclick    = current < questions.length - 1 ? nextQuestion : showResults;
  nextBtn.style.display = '';
}

function nextQuestion() { current++; renderQuestion(); }

function showResults() {
  const pct = Math.round((score / questions.length) * 100);
  const grade = pct >= 90 ? 'Excellent! ğŸ†' : pct >= 70 ? 'Good Job! ğŸ‘' : pct >= 50 ? 'Keep Studying! ğŸ“š' : 'Review the NTP materials ğŸ”';
  document.querySelector('.quiz-body').innerHTML = `
    <div style="text-align:center;padding:30px 0;">
      <div style="font-size:3.5rem;margin-bottom:16px;">${pct >= 80 ? 'ğŸ‰' : pct >= 60 ? 'ğŸ‘' : 'ğŸ“š'}</div>
      <div style="font-family:'Syne',sans-serif;font-size:2.5rem;font-weight:800;color:var(--accent);margin-bottom:8px;">${pct}%</div>
      <div style="font-size:1.1rem;color:var(--text);margin-bottom:8px;">${grade}</div>
      <div style="color:var(--text-muted);font-size:0.9rem;margin-bottom:28px;">You scored ${score} out of ${questions.length} questions correctly.</div>
      <button class="btn btn-primary" onclick="restartQuiz()">â†º Retake Quiz</button>
    </div>`;
}

function restartQuiz() {
  current = 0; score = 0; answered = 0;
  document.getElementById('score-display').textContent = '0';
  document.getElementById('total-display').textContent = '0';
  document.querySelector('.quiz-body').innerHTML = `
    <div class="progress-bar"><div class="progress-fill" id="quiz-progress" style="width:0%"></div></div>
    <div class="question-text" id="question-text"></div>
    <div class="options" id="options-container"></div>
    <div class="quiz-feedback" id="quiz-feedback"></div>
    <div class="quiz-nav">
      <div class="q-counter" id="q-counter"></div>
      <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" style="display:none;">Next Question â†’</button>
    </div>`;
  renderQuestion();
}

renderQuestion();

// â”€â”€ SCROLL REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const observer = new IntersectionObserver(entries => {
  entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold: 0.06 });
document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
</body>
</html>
