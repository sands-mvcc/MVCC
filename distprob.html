<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Probability Distributions: Interactive Lab</title>
    <style>
        :root {
            --primary-green: #2e7d32; /* Professional Forest Green */
            --accent-green: #4caf50;  /* Lighter Green for interactions */
            --text-black: #121212;
            --bg-white: #ffffff;
            --light-gray: #f5f5f5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-white);
            color: var(--text-black);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        /* Layout */
        header {
            background-color: var(--text-black);
            color: var(--bg-white);
            padding: 1.5rem;
            text-align: center;
            border-bottom: 5px solid var(--primary-green);
        }

        header h1 { margin: 0; font-weight: 300; letter-spacing: 1px; }
        header .subtitle { color: var(--accent-green); font-size: 0.9rem; text-transform: uppercase; font-weight: bold; }

        main {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Typography */
        h2 { color: var(--primary-green); border-bottom: 1px solid #ddd; padding-bottom: 0.5rem; }
        p { margin-bottom: 1rem; }

        /* Interactive Review Section (Accordions) */
        .concept-review {
            display: grid;
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .accordion {
            background-color: var(--bg-white);
            border: 1px solid #ddd;
            border-left: 5px solid var(--primary-green);
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }

        .accordion:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

        .accordion-header {
            padding: 1rem;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--light-gray);
        }

        .accordion-header::after { content: '+'; font-size: 1.5rem; color: var(--primary-green); }
        .accordion.active .accordion-header::after { content: '-'; }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding: 0 1rem;
        }

        .accordion.active .accordion-content {
            padding: 1rem;
            max-height: 200px; /* Arbitrary height for expansion */
        }

        /* Simulation Section */
        .sim-container {
            background-color: var(--bg-white);
            border: 2px solid var(--text-black);
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 1.5rem;
            background: var(--light-gray);
            padding: 1rem;
            border-radius: 4px;
        }

        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        input[type=range] {
            width: 100%;
            accent-color: var(--primary-green);
            cursor: pointer;
        }

        .readout {
            color: var(--primary-green);
            font-weight: bold;
            float: right;
        }

        canvas {
            width: 100%;
            height: 400px;
            background-color: #fafafa;
            border: 1px solid #ccc;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .legend-item { display: flex; align-items: center; gap: 0.5rem; }
        .box-binom { width: 15px; height: 15px; background-color: var(--accent-green); opacity: 0.6; border: 1px solid var(--primary-green); }
        .line-norm { width: 20px; height: 3px; background-color: var(--text-black); }

        footer {
            text-align: center;
            margin-top: 3rem;
            padding: 2rem;
            font-size: 0.8rem;
            color: #666;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>

<header>
    <div class="subtitle">Instructional Module</div>
    <h1>Distributions & Probability</h1>
</header>

<main>

    <section>
        <h2>01. Concept Review</h2>
        <p>Before entering the lab, review the fundamental differences between these two core statistical concepts.</p>
        
        <div class="concept-review">
            <div class="accordion">
                <div class="accordion-header">The Binomial Distribution</div>
                <div class="accordion-content">
                    <p><strong>Type:</strong> Discrete (Whole numbers only).</p>
                    <p><strong>Scenario:</strong> Used when counting "successes" in a fixed number of independent trials (e.g., flipping a coin 10 times).</p>
                    <p><strong>Key Parameters:</strong> <em>n</em> (number of trials) and <em>p</em> (probability of success).</p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header">The Normal Distribution</div>
                <div class="accordion-content">
                    <p><strong>Type:</strong> Continuous (Fluid, smooth data).</p>
                    <p><strong>Scenario:</strong> The famous "Bell Curve." Nature loves this distribution (heights, test scores, errors).</p>
                    <p><strong>Key Parameters:</strong> <em>&mu;</em> (Mean/Center) and <em>&sigma;</em> (Standard Deviation/Spread).</p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header">The Central Limit Theorem</div>
                <div class="accordion-content">
                    <p><strong>The Magic:</strong> Even if data starts as Binomial (discrete), if you have a large enough sample size (<em>n</em>), the graph will smooth out and begin to look exactly like a Normal Distribution.</p>
                </div>
            </div>
        </div>
    </section>

    <section>
        <h2>02. Convergence Lab</h2>
        <p>Use the sliders below to adjust the parameters of a Binomial experiment. Observe how the discrete bars (Binomial) align with the smooth bell curve (Normal approximation) as <strong>N</strong> increases.</p>
        
        <div class="sim-container">
            <div class="controls">
                <div class="control-group">
                    <label>Number of Trials (N) <span id="n-val" class="readout">20</span></label>
                    <input type="range" id="n-slider" min="5" max="100" value="20">
                </div>
                <div class="control-group">
                    <label>Probability of Success (p) <span id="p-val" class="readout">0.5</span></label>
                    <input type="range" id="p-slider" min="0.1" max="0.9" step="0.05" value="0.5">
                </div>
            </div>

            <canvas id="distCanvas"></canvas>

            <div class="legend">
                <div class="legend-item"><div class="box-binom"></div> Binomial (Discrete Bars)</div>
                <div class="legend-item"><div class="line-norm"></div> Normal Approximation (Continuous Curve)</div>
            </div>
        </div>
    </section>

</main>

<footer>
    <p>Professor's Module | Cybersecurity & AI Dept<br>Generated for Educational Use</p>
</footer>

<script>
    // --- Logic & Math Functions ---

    // Factorial with simple memoization for performance
    const factorial = (function() {
        const cache = [1, 1];
        return function(n) {
            if (cache[n]) return cache[n];
            let res = 1;
            for (let i = 2; i <= n; i++) res *= i;
            cache[n] = res;
            return res;
        };
    })();

    // nCr Combination Formula
    function nCr(n, r) {
        if (r < 0 || r > n) return 0;
        return factorial(n) / (factorial(r) * factorial(n - r));
    }

    // Binomial Probability Mass Function
    function binomialPMF(n, p, k) {
        return nCr(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);
    }

    // Normal Probability Density Function
    function normalPDF(x, mean, stdDev) {
        return (1 / (stdDev * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mean) / stdDev, 2));
    }

    // --- Visualization/Canvas Logic ---

    const canvas = document.getElementById('distCanvas');
    const ctx = canvas.getContext('2d');
    
    // Handle High DPI displays
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    ctx.scale(dpr, dpr);

    // Input Elements
    const nSlider = document.getElementById('n-slider');
    const pSlider = document.getElementById('p-slider');
    const nVal = document.getElementById('n-val');
    const pVal = document.getElementById('p-val');

    function draw() {
        const N = parseInt(nSlider.value);
        const P = parseFloat(pSlider.value);
        
        // Update Readouts
        nVal.textContent = N;
        pVal.textContent = P;

        // Clear Canvas
        ctx.clearRect(0, 0, rect.width, rect.height);

        // Calculate Stats for Normal Approximation
        const mean = N * P;
        const variance = N * P * (1 - P);
        const stdDev = Math.sqrt(variance);

        // Determine X-Axis Scale (Focus on the active area)
        // We want to show roughly mean +/- 4 stdDevs, or full 0 to N if N is small
        let minX = Math.floor(mean - 4 * stdDev);
        let maxX = Math.ceil(mean + 4 * stdDev);
        if (minX < 0) minX = 0;
        if (maxX > N) maxX = N;
        
        // Add a little padding to the view
        const rangeX = maxX - minX;
        
        // Dimensions
        const padding = 40;
        const graphW = rect.width - (padding * 2);
        const graphH = rect.height - (padding * 2);
        
        // Scale Functions
        const getX = (val) => padding + ((val - minX) / (rangeX + 1)) * graphW;
        
        // Determine Y-Scale based on the Peak Probability
        // The peak is usually around the mean.
        const maxProb = Math.max(binomialPMF(N, P, Math.floor(mean)), normalPDF(mean, mean, stdDev));
        const getY = (prob) => (rect.height - padding) - (prob / (maxProb * 1.1)) * graphH;

        // 1. Draw Binomial Bars
        const barWidth = (graphW / (rangeX + 1)) * 0.8; // 80% of slot width

        ctx.fillStyle = "rgba(76, 175, 80, 0.6)"; // Accent Green transparent
        ctx.strokeStyle = "#2e7d32"; // Dark Green border
        
        for (let k = minX; k <= maxX; k++) {
            const prob = binomialPMF(N, P, k);
            const xPos = getX(k);
            const yPos = getY(prob);
            const floorY = getY(0);

            // Draw Bar centered on integer k
            ctx.beginPath();
            ctx.rect(xPos - barWidth/2, yPos, barWidth, floorY - yPos);
            ctx.fill();
            ctx.stroke();
        }

        // 2. Draw Normal Curve Overlay
        ctx.beginPath();
        ctx.strokeStyle = "#000000";
        ctx.lineWidth = 3;
        
        // We draw small segments for smoothness
        const step = 0.1;
        let start = true;
        
        for (let x = minX; x <= maxX + 1; x += step) {
            const prob = normalPDF(x, mean, stdDev);
            const xPos = getX(x);
            const yPos = getY(prob);
            
            if (start) {
                ctx.moveTo(xPos, yPos);
                start = false;
            } else {
                ctx.lineTo(xPos, yPos);
            }
        }
        ctx.stroke();

        // 3. Draw Axis Lines
        ctx.beginPath();
        ctx.strokeStyle = "#333";
        ctx.lineWidth = 1;
        // X-axis
        ctx.moveTo(padding, rect.height - padding);
        ctx.lineTo(rect.width - padding, rect.height - padding);
        // Y-axis
        ctx.moveTo(padding, rect.height - padding);
        ctx.lineTo(padding, padding);
        ctx.stroke();
        
        // 4. Draw X-Axis Labels (Integers)
        ctx.fillStyle = "#000";
        ctx.font = "12px Arial";
        ctx.textAlign = "center";
        
        // Only draw some labels to avoid crowding
        const labelStep = Math.ceil((rangeX) / 10); 
        for (let k = minX; k <= maxX; k += labelStep) {
            ctx.fillText(k, getX(k), rect.height - padding + 20);
        }
    }

    // Interaction Listeners
    nSlider.addEventListener('input', draw);
    pSlider.addEventListener('input', draw);
    
    // Accordion Logic
    document.querySelectorAll('.accordion-header').forEach(header => {
        header.addEventListener('click', () => {
            const item = header.parentElement;
            item.classList.toggle('active');
        });
    });

    // Initial Draw
    draw();

</script>
</body>
</html>
