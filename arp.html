<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ARP Protocol | Network Security</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:         #f0f4f8;
    --bg2:        #e2e9f0;
    --surface:    #ffffff;
    --surface2:   #f5f8fb;
    --accent:     #0077aa;
    --accent2:    #d94f00;
    --accent3:    #1a7f37;
    --text:       #0f1e2e;
    --text-muted: #4a6580;
    --border:     #c4d4e2;
    --danger:     #cc2233;
    --warning:    #b07800;
    --safe:       #1a7f37;
    --purple:     #7744bb;
    --teal:       #007a7a;
    --poison:     #aa0033;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(0,100,160,0.05) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,100,160,0.05) 1px, transparent 1px);
    background-size: 40px 40px;
    animation: gridMove 25s linear infinite;
    pointer-events: none; z-index: 0;
  }
  @keyframes gridMove { 0%{background-position:0 0} 100%{background-position:40px 40px} }

  /* â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .hero {
    position: relative; z-index: 1;
    padding: 80px 40px 60px; text-align: center;
    background: radial-gradient(ellipse 80% 60% at 50% 0%, rgba(0,119,170,0.10) 0%, transparent 70%);
    border-bottom: 1px solid var(--border);
  }
  .hero-badge {
    display: inline-flex; align-items: center; gap: 8px;
    background: rgba(0,119,170,0.08); border: 1px solid rgba(0,119,170,0.25);
    border-radius: 100px; padding: 6px 16px;
    font-family: 'Space Mono', monospace; font-size: 0.7rem;
    color: var(--accent); letter-spacing: 0.1em; text-transform: uppercase;
    margin-bottom: 24px; animation: fadeInDown .6s ease both;
  }
  .hero-badge::before {
    content: ''; width: 6px; height: 6px;
    background: var(--accent); border-radius: 50%; animation: pulse 2s infinite;
  }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.4;transform:scale(.8)} }
  .hero-icon { display: block; font-size: 3rem; margin-bottom: 12px; animation: fadeInDown .5s ease both; }
  h1 {
    font-family: 'Syne', sans-serif; font-weight: 800;
    font-size: clamp(2.5rem,6vw,4.5rem); line-height: 1.05;
    letter-spacing: -0.03em; animation: fadeInDown .6s .1s ease both;
  }
  h1 span { background: linear-gradient(135deg,var(--accent),#3a6fd8); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
  .hero p { max-width: 700px; margin: 20px auto 0; color: var(--text-muted); font-size: 1.05rem; line-height: 1.7; font-weight: 300; animation: fadeInDown .6s .2s ease both; }
  @keyframes fadeInDown { from{opacity:0;transform:translateY(-16px)} to{opacity:1;transform:translateY(0)} }

  /* â”€â”€ STATS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .stats-bar {
    display: flex; justify-content: center; gap: 40px; padding: 24px 40px;
    border-bottom: 1px solid var(--border); background: var(--bg2);
    position: relative; z-index: 1; flex-wrap: wrap;
    animation: fadeInDown .6s .3s ease both;
  }
  .stat { text-align: center; }
  .stat-num { font-family: 'Space Mono', monospace; font-size: 1.8rem; font-weight: 700; color: var(--accent); display: block; line-height: 1; }
  .stat-num.green  { color: var(--safe); }
  .stat-num.orange { color: var(--accent2); }
  .stat-num.red    { color: var(--danger); }
  .stat-num.purple { color: var(--purple); }
  .stat-label { font-size: .72rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .1em; margin-top: 4px; }

  /* â”€â”€ CONTAINER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .container { max-width: 1200px; margin: 0 auto; padding: 50px 30px; position: relative; z-index: 1; }

  .section-header { display: flex; align-items: center; gap: 14px; margin-bottom: 28px; }
  .section-icon { width: 38px; height: 38px; background: rgba(0,119,170,0.08); border: 1px solid rgba(0,119,170,0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; flex-shrink: 0; }
  .section-title { font-family: 'Syne', sans-serif; font-size: 1.3rem; font-weight: 600; letter-spacing: -0.01em; }
  .section-title small { display: block; font-family: 'DM Sans', sans-serif; font-weight: 300; font-size: .8rem; color: var(--text-muted); margin-top: 2px; }

  /* â”€â”€ PACKET DIAGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .packet-section { margin-bottom: 60px; }
  .packet-diagram { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; overflow: hidden; box-shadow: 0 4px 24px rgba(0,0,0,.06); }
  .packet-toolbar { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; background: var(--bg2); border-bottom: 1px solid var(--border); gap: 12px; flex-wrap: wrap; }
  .packet-toolbar-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: .9rem; }
  .packet-toolbar-hint { font-size: .75rem; color: var(--text-muted); font-style: italic; }
  .packet-body { padding: 28px 24px; }

  .row-label { font-family: 'Space Mono', monospace; font-size: .65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .08em; margin-bottom: 6px; margin-top: 14px; }
  .row-label:first-child { margin-top: 0; }

  .field-row { display: flex; gap: 6px; margin-bottom: 6px; }
  .field-row .header-field { flex: 1; margin-bottom: 0; }

  .header-field { display: flex; align-items: center; margin-bottom: 6px; border-radius: 10px; border: 2px solid transparent; cursor: pointer; transition: all .2s cubic-bezier(.34,1.4,.64,1); overflow: hidden; position: relative; user-select: none; }
  .header-field:hover { transform: translateX(4px); box-shadow: 0 4px 16px rgba(0,0,0,.08); }
  .header-field.active { border-color: var(--accent); box-shadow: 0 4px 20px rgba(0,119,170,.15); transform: translateX(6px); }
  .field-row .header-field:hover  { transform: translateY(-2px); }
  .field-row .header-field.active { transform: translateY(-2px); border-color: var(--accent); }

  .field-label { font-family: 'Space Mono', monospace; font-size: .73rem; font-weight: 700; padding: 11px 14px; white-space: nowrap; color: #fff; letter-spacing: .03em; display: flex; align-items: center; gap: 6px; }
  .header-field.wide .field-label { min-width: 240px; }
  .field-label .field-icon { font-size: .95rem; }
  .field-bar { flex: 1; height: 43px; position: relative; overflow: hidden; }
  .field-bar-fill { position: absolute; inset: 0; opacity: .13; transition: opacity .2s; }
  .header-field.active .field-bar-fill { opacity: .24; }

  /* WHITE TEXT on colored bars */
  .field-variable { position: absolute; right: 14px; top: 50%; transform: translateY(-50%); font-family: 'Space Mono', monospace; font-size: .65rem; color: rgba(255,255,255,.78); letter-spacing: .05em; white-space: nowrap; }
  .field-bytes    { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); font-size: .76rem; color: rgba(255,255,255,.93); font-weight: 400; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: calc(100% - 120px); }

  /* Field colours */
  .hf-htype { background: #0077aa; } .hf-htype .field-bar-fill { background: #0077aa; }
  .hf-ptype { background: #2563a8; } .hf-ptype .field-bar-fill { background: #2563a8; }
  .hf-hlen  { background: #007a7a; } .hf-hlen  .field-bar-fill { background: #007a7a; }
  .hf-plen  { background: #3a8080; } .hf-plen  .field-bar-fill { background: #3a8080; }
  .hf-oper  { background: #7744bb; } .hf-oper  .field-bar-fill { background: #7744bb; }
  .hf-sha   { background: #1a7f37; } .hf-sha   .field-bar-fill { background: #1a7f37; }
  .hf-spa   { background: #3a7030; } .hf-spa   .field-bar-fill { background: #3a7030; }
  .hf-tha   { background: #d94f00; } .hf-tha   .field-bar-fill { background: #d94f00; }
  .hf-tpa   { background: #b03a00; } .hf-tpa   .field-bar-fill { background: #b03a00; }

  /* Detail panel */
  .detail-panel { margin-top: 20px; background: var(--surface2); border: 1px solid var(--border); border-radius: 12px; padding: 22px 24px; display: none; animation: slideDown .25s ease; }
  .detail-panel.show { display: block; }
  @keyframes slideDown { from{opacity:0;transform:translateY(-8px)} to{opacity:1;transform:translateY(0)} }
  .detail-panel-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: 1rem; margin-bottom: 10px; }
  .detail-panel p { color: var(--text-muted); font-size: .9rem; line-height: 1.7; margin-bottom: 12px; }
  .example-label { font-family: 'DM Sans', sans-serif; font-size: .72rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .08em; margin-bottom: 6px; font-weight: 500; }
  .example-box { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; font-family: 'Space Mono', monospace; font-size: .78rem; color: var(--accent); line-height: 1.7; overflow-x: auto; }

  /* â”€â”€ ARP EXCHANGE ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .exchange-section { margin-bottom: 60px; }
  .exchange-diagram { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; padding: 32px 28px; box-shadow: 0 4px 24px rgba(0,0,0,.06); }
  .exchange-grid { display: grid; grid-template-columns: 180px 1fr 180px; align-items: start; }

  .ex-actor { text-align: center; }
  .ex-actor-icon { width: 64px; height: 64px; background: var(--surface2); border: 2px solid var(--border); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; margin: 0 auto 10px; }
  .ex-actor-name { font-family: 'Space Mono', monospace; font-size: .72rem; font-weight: 700; color: var(--text-muted); text-transform: uppercase; letter-spacing: .07em; line-height: 1.4; }
  .ex-actor-ip   { font-family: 'Space Mono', monospace; font-size: .65rem; color: var(--accent); margin-top: 4px; }

  .ex-steps { padding: 0 8px; position: relative; }
  .ex-steps::before { content: ''; position: absolute; left: 50%; top: 0; bottom: 0; width: 1px; background: var(--border); transform: translateX(-50%); }

  .ex-step { display: flex; align-items: center; margin-bottom: 20px; opacity: 0; transform: translateY(8px); transition: opacity .4s ease, transform .4s ease; }
  .ex-step.visible { opacity: 1; transform: translateY(0); }
  .ex-step.c2s { flex-direction: row; }
  .ex-step.s2c { flex-direction: row-reverse; }
  .ex-step.broadcast { flex-direction: row; }

  .ex-arrow { flex: 1; display: flex; align-items: center; height: 40px; }
  .ex-line  { flex: 1; height: 2px; position: relative; }
  .ex-step.c2s       .ex-line { background: linear-gradient(90deg,var(--accent),transparent 80%); }
  .ex-step.s2c       .ex-line { background: linear-gradient(270deg,var(--accent2),transparent 80%); }
  .ex-step.broadcast .ex-line { background: linear-gradient(90deg,var(--purple),transparent 80%); animation: broadcastPulse 1.5s ease-in-out infinite; }
  @keyframes broadcastPulse { 0%,100%{opacity:1} 50%{opacity:.45} }

  .ex-arrowhead { width:0; height:0; flex-shrink:0; }
  .ex-step.c2s       .ex-arrowhead, .ex-step.broadcast .ex-arrowhead { border-top:6px solid transparent; border-bottom:6px solid transparent; border-left:9px solid var(--accent); }
  .ex-step.broadcast .ex-arrowhead { border-left-color: var(--purple); }
  .ex-step.s2c       .ex-arrowhead { border-top:6px solid transparent; border-bottom:6px solid transparent; border-right:9px solid var(--accent2); }

  .ex-label { position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-family: 'Space Mono', monospace; font-size: .62rem; font-weight: 700; white-space: nowrap; padding: 3px 8px; border-radius: 100px; letter-spacing: .04em; }
  .ex-step.c2s       .ex-label { background: rgba(0,119,170,.10); color: var(--accent); border: 1px solid rgba(0,119,170,.22); }
  .ex-step.s2c       .ex-label { background: rgba(217,79,0,.10);  color: var(--accent2); border: 1px solid rgba(217,79,0,.22); }
  .ex-step.broadcast .ex-label { background: rgba(119,68,187,.10); color: var(--purple); border: 1px solid rgba(119,68,187,.22); }
  .ex-step-num { font-family: 'Space Mono', monospace; font-size: .65rem; color: var(--text-muted); width: 20px; text-align: center; flex-shrink: 0; }

  .ex-legend { display: flex; gap: 20px; margin-top: 20px; flex-wrap: wrap; align-items: center; justify-content: space-between; }
  .ex-legend-items { display: flex; gap: 20px; flex-wrap: wrap; }
  .ex-legend-item { display: flex; align-items: center; gap: 7px; font-size: .78rem; color: var(--text-muted); }
  .ex-legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
  .replay-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 18px; background: rgba(0,119,170,.08); border: 1px solid rgba(0,119,170,.25); border-radius: 100px; color: var(--accent); font-family: 'Space Mono', monospace; font-size: .72rem; font-weight: 700; cursor: pointer; transition: all .2s; letter-spacing: .05em; }
  .replay-btn:hover { background: rgba(0,119,170,.16); transform: scale(1.03); }

  /* â”€â”€ ARP CACHE SIMULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .sim-section { margin-bottom: 60px; }
  .sim-wrap { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; overflow: hidden; box-shadow: 0 4px 24px rgba(0,0,0,.06); }
  .sim-toolbar { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; background: var(--bg2); border-bottom: 1px solid var(--border); gap: 12px; flex-wrap: wrap; }
  .sim-toolbar-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: .9rem; }
  .sim-body { padding: 24px; }

  .sim-controls { display: grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap: 14px; align-items: end; margin-bottom: 24px; }
  .ctrl-group label { display: block; font-family: 'Space Mono', monospace; font-size: .68rem; font-weight: 700; color: var(--text-muted); text-transform: uppercase; letter-spacing: .08em; margin-bottom: 6px; }
  .ctrl-select, .ctrl-input { width: 100%; padding: 9px 12px; background: var(--surface); border: 1px solid var(--border); border-radius: 9px; color: var(--text); font-family: 'DM Sans', sans-serif; font-size: .88rem; outline: none; transition: border-color .2s; }
  .ctrl-select:focus, .ctrl-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(0,119,170,.08); }

  .btn { display: inline-flex; align-items: center; justify-content: center; gap: 6px; padding: 10px 18px; border-radius: 10px; font-family: 'DM Sans', sans-serif; font-size: .875rem; font-weight: 600; cursor: pointer; transition: all .2s; border: none; outline: none; white-space: nowrap; }
  .btn-primary   { background: var(--accent); color: #fff; }
  .btn-primary:hover { background: #0060a0; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,119,170,.25); }
  .btn-danger    { background: rgba(170,0,51,.10); color: var(--poison); border: 1px solid rgba(170,0,51,.3); }
  .btn-danger:hover { background: rgba(170,0,51,.18); transform: translateY(-1px); }
  .btn-ghost     { background: transparent; color: var(--text-muted); border: 1px solid var(--border); }
  .btn-ghost:hover { color: var(--text); border-color: rgba(0,0,0,.2); }
  .btn-auto      { background: rgba(26,127,55,.10); color: var(--safe); border: 1px solid rgba(26,127,55,.25); }
  .btn-auto:hover { background: rgba(26,127,55,.18); }
  .btn-auto.running { background: rgba(204,34,51,.10); color: var(--danger); border-color: rgba(204,34,51,.25); }

  /* Result card */
  .lookup-result { background: var(--surface2); border: 1px solid var(--border); border-radius: 14px; padding: 20px 22px; margin-bottom: 24px; display: none; animation: slideDown .3s ease; }
  .lookup-result.show { display: block; }
  .lookup-result.hit     { border-color: rgba(26,127,55,.35); background: rgba(26,127,55,.04); }
  .lookup-result.miss    { border-color: rgba(217,79,0,.35);  background: rgba(217,79,0,.04); }
  .lookup-result.poison  { border-color: rgba(170,0,51,.4);   background: rgba(170,0,51,.04); }
  .result-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: .95rem; margin-bottom: 12px; }
  .result-title.hit     { color: var(--safe); }
  .result-title.miss    { color: var(--accent2); }
  .result-title.poison  { color: var(--poison); }

  .result-flow { display: flex; align-items: center; gap: 14px; flex-wrap: wrap; font-family: 'Space Mono', monospace; font-size: .82rem; }
  .result-box { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 12px 16px; text-align: center; }
  .result-box-label { font-size: .62rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .08em; margin-bottom: 4px; }
  .result-box-val { font-weight: 700; font-size: .88rem; }
  .val-ip   { color: var(--accent); }
  .val-mac  { color: var(--safe); }
  .val-poison { color: var(--poison); }
  .result-arrow { font-size: 1.2rem; color: var(--border); display: flex; flex-direction: column; align-items: center; gap: 2px; }
  .result-arrow span { font-family: 'Space Mono', monospace; font-size: .58rem; color: var(--text-muted); }

  /* ARP Cache table */
  .cache-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: .9rem; margin-bottom: 10px; margin-top: 20px; }
  .cache-wrap { overflow-x: auto; }
  .arp-cache-table { width: 100%; border-collapse: collapse; font-family: 'Space Mono', monospace; font-size: .78rem; }
  .arp-cache-table th { font-size: .63rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: var(--text-muted); padding: 9px 14px; text-align: left; background: var(--bg2); border-bottom: 1px solid var(--border); white-space: nowrap; }
  .arp-cache-table td { padding: 9px 14px; border-bottom: 1px solid rgba(196,212,226,.4); vertical-align: middle; }
  .arp-cache-table tr:last-child td { border-bottom: none; }
  .arp-cache-table tr:hover td { background: rgba(0,119,170,.03); }
  .arp-cache-table tr.new-row td  { animation: rowHighlight 1.8s ease; }
  .arp-cache-table tr.poison-row td { animation: poisonHighlight 2s ease; background: rgba(170,0,51,.04); }
  @keyframes rowHighlight   { 0%{background:rgba(0,119,170,.12)} 100%{background:transparent} }
  @keyframes poisonHighlight{ 0%{background:rgba(170,0,51,.22)}  100%{background:rgba(170,0,51,.04)} }

  .ip-cell    { color: var(--accent); font-weight: 700; }
  .mac-cell   { color: var(--safe); font-weight: 700; }
  .mac-cell.poisoned { color: var(--poison); }
  .type-pill  { font-size: .62rem; padding: 2px 8px; border-radius: 100px; font-weight: 700; }
  .type-dyn   { background: rgba(0,119,170,.10); color: var(--accent); border: 1px solid rgba(0,119,170,.25); }
  .type-static{ background: rgba(26,127,55,.10);  color: var(--safe);   border: 1px solid rgba(26,127,55,.25); }
  .type-poison{ background: rgba(170,0,51,.12);   color: var(--poison); border: 1px solid rgba(170,0,51,.3); }

  .ttl-bar-wrap { display: flex; align-items: center; gap: 8px; }
  .ttl-bar { height: 6px; border-radius: 3px; background: var(--border); flex: 1; min-width: 60px; overflow: hidden; }
  .ttl-fill { height: 100%; border-radius: 3px; background: linear-gradient(90deg,var(--safe),var(--accent)); transition: width .5s ease; }
  .ttl-val  { font-size: .65rem; color: var(--text-muted); white-space: nowrap; }

  /* Log */
  .log-section-title { font-family: 'Syne', sans-serif; font-weight: 600; font-size: .9rem; margin-bottom: 10px; margin-top: 20px; }
  .arp-log { background: var(--surface2); border: 1px solid var(--border); border-radius: 10px; max-height: 220px; overflow-y: auto; font-family: 'Space Mono', monospace; font-size: .74rem; }
  .arp-log-entry { display: flex; align-items: center; gap: 10px; padding: 8px 14px; border-bottom: 1px solid rgba(196,212,226,.35); animation: logIn .3s ease; }
  .arp-log-entry:last-child { border-bottom: none; }
  @keyframes logIn { from{opacity:0;transform:translateX(-6px)} to{opacity:1;transform:translateX(0)} }
  .log-time  { color: var(--text-muted); font-size: .65rem; flex-shrink: 0; }
  .log-badge { font-size: .62rem; padding: 2px 7px; border-radius: 4px; font-weight: 700; flex-shrink: 0; white-space: nowrap; }
  .badge-req   { background: rgba(119,68,187,.10); color: var(--purple); border: 1px solid rgba(119,68,187,.2); }
  .badge-rep   { background: rgba(26,127,55,.10);  color: var(--safe);   border: 1px solid rgba(26,127,55,.25); }
  .badge-hit   { background: rgba(0,119,170,.10);  color: var(--accent); border: 1px solid rgba(0,119,170,.2); }
  .badge-poison{ background: rgba(170,0,51,.12);   color: var(--poison); border: 1px solid rgba(170,0,51,.3); }
  .badge-expired{ background: rgba(176,120,0,.10); color: var(--warning);border: 1px solid rgba(176,120,0,.25); }
  .log-msg   { color: var(--text-muted); flex: 1; }
  .log-empty { padding: 24px; text-align: center; color: var(--text-muted); }

  /* â”€â”€ ARP SECURITY SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .security-section { margin-bottom: 60px; }
  .security-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(300px,1fr)); gap: 14px; }
  .sec-card { background: var(--surface); border: 1px solid var(--border); border-radius: 14px; padding: 20px; transition: all .2s; border-left: 4px solid transparent; }
  .sec-card:hover { box-shadow: 0 6px 22px rgba(0,0,0,.08); transform: translateY(-2px); }
  .sec-card.threat    { border-left-color: var(--danger); }
  .sec-card.defense   { border-left-color: var(--safe); }
  .sec-card.detection { border-left-color: var(--accent); }
  .sec-icon { font-size: 1.8rem; margin-bottom: 10px; }
  .sec-badge { display: inline-block; font-family: 'Space Mono', monospace; font-size: .62rem; font-weight: 700; padding: 3px 9px; border-radius: 100px; text-transform: uppercase; letter-spacing: .05em; margin-bottom: 10px; }
  .badge-threat    { background: rgba(204,34,51,.10);  color: var(--danger); border: 1px solid rgba(204,34,51,.25); }
  .badge-defense   { background: rgba(26,127,55,.10);  color: var(--safe);   border: 1px solid rgba(26,127,55,.25); }
  .badge-detection { background: rgba(0,119,170,.10);  color: var(--accent); border: 1px solid rgba(0,119,170,.25); }
  .sec-name { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 1rem; margin-bottom: 6px; }
  .threat    .sec-name { color: var(--danger); }
  .defense   .sec-name { color: var(--safe); }
  .detection .sec-name { color: var(--accent); }
  .sec-desc { font-size: .85rem; color: var(--text-muted); line-height: 1.6; margin-bottom: 10px; font-weight: 300; }
  .sec-example { background: var(--surface2); border: 1px solid var(--border); border-radius: 7px; padding: 8px 12px; font-family: 'Space Mono', monospace; font-size: .7rem; line-height: 1.7; color: var(--text-muted); }
  .sec-example .hi { color: var(--danger); }
  .sec-example .ok { color: var(--safe); }

  /* â”€â”€ COMPARE TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .compare-section { margin-bottom: 60px; }
  .compare-table { width: 100%; border-collapse: collapse; background: var(--surface); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; box-shadow: 0 4px 24px rgba(0,0,0,.05); font-size: .875rem; }
  .compare-table thead { background: var(--bg2); }
  .compare-table th { font-family: 'Space Mono', monospace; font-size: .7rem; font-weight: 700; text-transform: uppercase; letter-spacing: .1em; color: var(--text-muted); padding: 13px 18px; text-align: left; border-bottom: 1px solid var(--border); }
  .compare-table th.arp-col  { color: var(--accent); }
  .compare-table th.rarp-col { color: var(--accent2); }
  .compare-table th.garp-col { color: var(--purple); }
  .compare-table td { padding: 13px 18px; border-bottom: 1px solid rgba(196,212,226,.5); vertical-align: top; line-height: 1.55; color: var(--text-muted); }
  .compare-table tr:last-child td { border-bottom: none; }
  .compare-table tr:hover td { background: rgba(0,119,170,.03); }
  .compare-table td:first-child { font-family: 'Space Mono', monospace; font-size: .75rem; font-weight: 700; color: var(--text); white-space: nowrap; }
  .good { color: var(--safe); font-weight: 500; }
  .bad  { color: var(--danger); font-weight: 500; }
  .warn { color: var(--warning); font-weight: 500; }

  /* â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .quiz-section { background: var(--surface); border: 1px solid var(--border); border-radius: 18px; overflow: hidden; margin-bottom: 60px; box-shadow: 0 4px 24px rgba(0,0,0,.05); }
  .quiz-header { background: linear-gradient(135deg,rgba(0,119,170,.07),rgba(119,68,187,.07)); border-bottom: 1px solid var(--border); padding: 20px 24px; display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
  .quiz-title { font-family: 'Syne', sans-serif; font-size: 1.15rem; font-weight: 600; }
  .quiz-score { font-family: 'Space Mono', monospace; font-size: .85rem; color: var(--text-muted); }
  .quiz-score span { color: var(--safe); font-weight: 700; }
  .quiz-body { padding: 28px 24px; }
  .progress-bar { height: 3px; background: var(--border); border-radius: 100px; overflow: hidden; margin-bottom: 24px; }
  .progress-fill { height: 100%; background: linear-gradient(90deg,var(--accent),#5080dc); border-radius: 100px; transition: width .4s ease; }
  .question-text { font-size: 1.05rem; font-weight: 400; margin-bottom: 20px; line-height: 1.6; }
  .question-text em { color: var(--accent); font-style: normal; font-family: 'Space Mono', monospace; }
  .options { display: flex; flex-direction: column; gap: 10px; }
  .option { display: flex; align-items: center; gap: 12px; padding: 14px 18px; background: var(--surface2); border: 1px solid var(--border); border-radius: 12px; cursor: pointer; transition: all .2s; font-size: .9rem; line-height: 1.4; color: var(--text); }
  .option:hover:not(.disabled) { border-color: var(--accent); background: rgba(0,119,170,.06); }
  .option.correct { background: rgba(26,127,55,.08); border-color: var(--safe); color: #145e2a; }
  .option.wrong   { background: rgba(204,34,51,.08); border-color: var(--danger); color: #a01828; }
  .option.disabled{ cursor: default; }
  .option-letter { width: 28px; height: 28px; background: rgba(0,0,0,.06); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-family: 'Space Mono', monospace; font-size: .75rem; font-weight: 700; flex-shrink: 0; color: var(--text-muted); }
  .option.correct .option-letter { background: var(--safe); color: #fff; }
  .option.wrong   .option-letter { background: var(--danger); color: #fff; }
  .quiz-feedback { margin-top: 18px; padding: 14px 18px; border-radius: 12px; font-size: .88rem; line-height: 1.6; display: none; }
  .quiz-feedback.show    { display: block; animation: slideDown .2s ease; }
  .quiz-feedback.correct { background: rgba(26,127,55,.07); border: 1px solid rgba(26,127,55,.25); color: #145e2a; }
  .quiz-feedback.wrong   { background: rgba(204,34,51,.07); border: 1px solid rgba(204,34,51,.25); color: #a01828; }
  .quiz-nav { display: flex; justify-content: space-between; align-items: center; margin-top: 24px; }
  .q-counter { font-family: 'Space Mono', monospace; font-size: .78rem; color: var(--text-muted); }

  /* â”€â”€ SCROLL REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .reveal { opacity: 0; transform: translateY(24px); transition: opacity .5s ease, transform .5s ease; }
  .reveal.visible { opacity: 1; transform: translateY(0); }

  footer { text-align: center; padding: 32px 20px; color: var(--text-muted); font-size: .8rem; border-top: 1px solid var(--border); position: relative; z-index: 1; font-family: 'Space Mono', monospace; background: var(--bg2); }

  @media(max-width:700px){
    .hero{padding:50px 20px 40px}
    .container{padding:30px 16px}
    .exchange-grid{grid-template-columns:70px 1fr 70px}
    .ex-actor-icon{width:44px;height:44px;font-size:1.2rem}
    .ex-actor-name{font-size:.58rem}
    .field-label{font-size:.65rem;padding:8px 8px}
    .field-row{flex-direction:column}
    .result-flow{flex-direction:column;align-items:flex-start}
    .security-grid{grid-template-columns:1fr}
  }
</style>
</head>
<body>

<!-- HERO -->
<header class="hero">
  <div class="hero-badge">Link Layer Protocol Â· RFC 826</div>
  <span class="hero-icon">ğŸ”</span>
  <h1>Address <span>Resolution</span> Protocol</h1>
  <p>ARP maps known IPv4 addresses to unknown MAC addresses on a local network segment. It is the essential bridge between the Network Layer (Layer 3) and the Data Link Layer (Layer 2), operating only within a single broadcast domain and never crossing IP routers.</p>
</header>

<!-- STATS BAR -->
<div class="stats-bar">
  <div class="stat"><span class="stat-num">1982</span><div class="stat-label">RFC 826 Published</div></div>
  <div class="stat"><span class="stat-num">Eth 0x0806</span><div class="stat-label">EtherType</div></div>
  <div class="stat"><span class="stat-num green">28 bytes</span><div class="stat-label">Header Size</div></div>
  <div class="stat"><span class="stat-num red">Op 1/2</span><div class="stat-label">Request / Reply</div></div>
</div>

<div class="container">

  <!-- â•â• PACKET DIAGRAM â•â• -->
  <div class="packet-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ“¦</div>
      <div class="section-title">ARP Header Fields
        <small>Click any field to expand its description and see values</small>
      </div>
    </div>
    <div class="packet-diagram">
      <div class="packet-toolbar">
        <div class="packet-toolbar-title">ARP Packet Structure (28 bytes)</div>
        <div class="packet-toolbar-hint">â†™ Click a field to inspect it</div>
      </div>
      <div class="packet-body">

        <div class="row-label">Row 1 â€” Bits 0â€“31 (32 bits)</div>
        <div class="field-row">
          <div class="header-field hf-htype" id="hf-htype" onclick="toggleField('htype')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ”Œ</span> Hardware Type</div>
            <div class="field-bar"><div class="field-bar-fill"></div>
              <span class="field-bytes">Ethernet = 1</span>
              <span class="field-variable">16 bits</span>
            </div>
          </div>
          <div class="header-field hf-ptype" id="hf-ptype" onclick="toggleField('ptype')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸŒ</span> Protocol Type</div>
            <div class="field-bar"><div class="field-bar-fill"></div>
              <span class="field-bytes">IPv4 = 0x0800</span>
              <span class="field-variable">16 bits</span>
            </div>
          </div>
        </div>

        <div class="row-label">Row 2 â€” Bits 32â€“63 (32 bits)</div>
        <div class="field-row">
          <div class="header-field hf-hlen" id="hf-hlen" onclick="toggleField('hlen')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ“</span> HLen</div>
            <div class="field-bar"><div class="field-bar-fill"></div>
              <span class="field-bytes">Ethernet = 6</span>
              <span class="field-variable">8 bits</span>
            </div>
          </div>
          <div class="header-field hf-plen" id="hf-plen" onclick="toggleField('plen')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">ğŸ“</span> PLen</div>
            <div class="field-bar"><div class="field-bar-fill"></div>
              <span class="field-bytes">IPv4 = 4</span>
              <span class="field-variable">8 bits</span>
            </div>
          </div>
          <div class="header-field hf-oper" id="hf-oper" onclick="toggleField('oper')" role="button" tabindex="0">
            <div class="field-label"><span class="field-icon">âš¡</span> Operation</div>
            <div class="field-bar"><div class="field-bar-fill"></div>
              <span class="field-bytes">1 = Request Â· 2 = Reply</span>
              <span class="field-variable">16 bits</span>
            </div>
          </div>
        </div>

        <div class="row-label">Row 3â€“4 â€” Bits 64â€“111 (48 bits)</div>
        <div class="header-field hf-sha wide" id="hf-sha" onclick="toggleField('sha')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ–¥ï¸</span> Sender Hardware Address (SHA)</div>
          <div class="field-bar"><div class="field-bar-fill"></div>
            <span class="field-bytes">MAC address of the sender â€” e.g. AA:BB:CC:DD:EE:01</span>
            <span class="field-variable">48 bits (6 bytes)</span>
          </div>
        </div>

        <div class="row-label">Row 5 â€” Bits 112â€“143 (32 bits)</div>
        <div class="header-field hf-spa wide" id="hf-spa" onclick="toggleField('spa')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ“</span> Sender Protocol Address (SPA)</div>
          <div class="field-bar"><div class="field-bar-fill"></div>
            <span class="field-bytes">IP address of sender â€” always known</span>
            <span class="field-variable">32 bits (4 bytes)</span>
          </div>
        </div>

        <div class="row-label">Row 6â€“7 â€” Bits 144â€“191 (48 bits)</div>
        <div class="header-field hf-tha wide" id="hf-tha" onclick="toggleField('tha')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">ğŸ¯</span> Target Hardware Address (THA)</div>
          <div class="field-bar"><div class="field-bar-fill"></div>
            <span class="field-bytes">00:00:00:00:00:00 in request (unknown) Â· filled in reply</span>
            <span class="field-variable">48 bits (6 bytes)</span>
          </div>
        </div>

        <div class="row-label">Row 8 â€” Bits 192â€“223 (32 bits)</div>
        <div class="header-field hf-tpa wide" id="hf-tpa" onclick="toggleField('tpa')" role="button" tabindex="0">
          <div class="field-label"><span class="field-icon">âœ‰ï¸</span> Target Protocol Address (TPA)</div>
          <div class="field-bar"><div class="field-bar-fill"></div>
            <span class="field-bytes">IP address being resolved â€” what we're looking up</span>
            <span class="field-variable">32 bits (4 bytes)</span>
          </div>
        </div>

        <div class="detail-panel" id="field-detail">
          <div class="detail-panel-title" id="detail-title"></div>
          <p id="detail-desc"></p>
          <div class="example-label">Values / Example</div>
          <div class="example-box" id="detail-example"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â• ARP EXCHANGE ANIMATION â•â• -->
  <div class="exchange-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ”„</div>
      <div class="section-title">ARP Request / Reply Exchange
        <small>How a host resolves an IP address to a MAC address before sending a frame</small>
      </div>
    </div>
    <div class="exchange-diagram">
      <div class="exchange-grid">
        <div class="ex-actor">
          <div class="ex-actor-icon">ğŸ’»</div>
          <div class="ex-actor-name">Host A<br>(Requester)</div>
          <div class="ex-actor-ip">IP: 192.168.1.10<br>MAC: AA:BB:CC:DD:EE:01</div>
        </div>
        <div class="ex-steps" id="ex-steps">
          <div class="ex-step broadcast" id="es1">
            <span class="ex-step-num">1</span>
            <div class="ex-arrow"><div class="ex-line"><span class="ex-label">ARP Request (broadcast FF:FF:FF:FF:FF:FF) â€” "Who has 192.168.1.20? Tell 192.168.1.10"</span></div><div class="ex-arrowhead"></div></div>
            <span class="ex-step-num"></span>
          </div>
          <div class="ex-step c2s" id="es2">
            <span class="ex-step-num">2</span>
            <div class="ex-arrow"><div class="ex-line"><span class="ex-label">All devices receive request â€” only 192.168.1.20 responds</span></div><div class="ex-arrowhead"></div></div>
            <span class="ex-step-num"></span>
          </div>
          <div class="ex-step s2c" id="es3">
            <span class="ex-step-num"></span>
            <div class="ex-arrow"><div class="ex-line"><span class="ex-label">ARP Reply (unicast) â€” "192.168.1.20 is at AA:BB:CC:DD:EE:02"</span></div><div class="ex-arrowhead"></div></div>
            <span class="ex-step-num">3</span>
          </div>
          <div class="ex-step c2s" id="es4">
            <span class="ex-step-num">4</span>
            <div class="ex-arrow"><div class="ex-line"><span class="ex-label">Host A caches IPâ†’MAC mapping Â· begins sending frames to AA:BB:CC:DD:EE:02</span></div><div class="ex-arrowhead"></div></div>
            <span class="ex-step-num"></span>
          </div>
        </div>
        <div class="ex-actor">
          <div class="ex-actor-icon">ğŸ–¥ï¸</div>
          <div class="ex-actor-name">Host B<br>(Responder)</div>
          <div class="ex-actor-ip">IP: 192.168.1.20<br>MAC: AA:BB:CC:DD:EE:02</div>
        </div>
      </div>
      <div class="ex-legend">
        <div class="ex-legend-items">
          <div class="ex-legend-item"><div class="ex-legend-dot" style="background:var(--purple)"></div> Broadcast (all devices receive)</div>
          <div class="ex-legend-item"><div class="ex-legend-dot" style="background:var(--accent)"></div> Requester action</div>
          <div class="ex-legend-item"><div class="ex-legend-dot" style="background:var(--accent2)"></div> Unicast reply</div>
        </div>
        <button class="replay-btn" onclick="replayExchange()">â†º Replay Animation</button>
      </div>
    </div>
  </div>

  <!-- â•â• ARP CACHE SIMULATOR â•â• -->
  <div class="sim-section reveal">
    <div class="section-header">
      <div class="section-icon">âš¡</div>
      <div class="section-title">ARP Cache Simulator
        <small>Send ARP requests, observe cache lookups, and simulate ARP cache poisoning attacks</small>
      </div>
    </div>
    <div class="sim-wrap">
      <div class="sim-toolbar">
        <div class="sim-toolbar-title">ARP Cache â€” Host: 192.168.1.10 (AA:BB:CC:DD:EE:01)</div>
        <span style="font-size:.75rem;color:var(--text-muted);font-style:italic">Local subnet: 192.168.1.0/24</span>
      </div>
      <div class="sim-body">
        <div class="sim-controls">
          <div class="ctrl-group">
            <label>Target IP Address</label>
            <select class="ctrl-select" id="sim-ip">
              <option value="192.168.1.20">192.168.1.20 (Host-B)</option>
              <option value="192.168.1.30">192.168.1.30 (Host-C)</option>
              <option value="192.168.1.40">192.168.1.40 (Host-D)</option>
              <option value="192.168.1.1" >192.168.1.1  (Gateway)</option>
              <option value="192.168.1.99">192.168.1.99 (Unknown)</option>
            </select>
          </div>
          <div class="ctrl-group" style="display:flex;gap:8px;flex-wrap:wrap;align-items:flex-end;">
            <button class="btn btn-primary" onclick="sendArpRequest()">ğŸ“¡ ARP Request</button>
            <button class="btn btn-danger"  onclick="poisonCache()">â˜  Poison Cache</button>
            <button class="btn btn-auto"    id="auto-btn" onclick="toggleAuto()">âš¡ Auto-Demo</button>
            <button class="btn btn-ghost"   onclick="clearSim()">âœ• Clear</button>
          </div>
        </div>

        <div class="lookup-result" id="lookup-result"></div>

        <div class="cache-title">ğŸ—‚ï¸ ARP Cache Table</div>
        <div class="cache-wrap">
          <table class="arp-cache-table">
            <thead><tr>
              <th>IP Address</th><th>MAC Address</th><th>Type</th><th>TTL</th><th>Interface</th>
            </tr></thead>
            <tbody id="cache-tbody"></tbody>
          </table>
        </div>

        <div class="log-section-title">ğŸ“‹ ARP Transaction Log</div>
        <div class="arp-log" id="arp-log"><div class="log-empty">No transactions yet â€” send an ARP request to begin</div></div>
      </div>
    </div>
  </div>

  <!-- â•â• SECURITY â•â• -->
  <div class="security-section reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ”’</div>
      <div class="section-title">ARP Security Considerations
        <small>ARP has no authentication â€” making it a common target for network attacks</small>
      </div>
    </div>
    <div class="security-grid">
      <div class="sec-card threat">
        <div class="sec-icon">â˜ ï¸</div>
        <span class="sec-badge badge-threat">Threat</span>
        <div class="sec-name">ARP Cache Poisoning / Spoofing</div>
        <div class="sec-desc">An attacker sends gratuitous ARP replies associating their MAC address with a legitimate IP (e.g., the gateway). Victims update their ARP cache and send traffic to the attacker instead. Enables man-in-the-middle attacks, traffic interception, and denial of service.</div>
        <div class="sec-example">
          Legitimate: 192.168.1.1 â†’ <span class="ok">AA:BB:CC:DD:EE:FF</span> (real gateway)<br>
          Poisoned:   192.168.1.1 â†’ <span class="hi">DE:AD:BE:EF:00:01</span> (attacker MAC)
        </div>
      </div>
      <div class="sec-card threat">
        <div class="sec-icon">ğŸŒŠ</div>
        <span class="sec-badge badge-threat">Threat</span>
        <div class="sec-name">ARP Flood (DoS)</div>
        <div class="sec-desc">Flooding a network with ARP requests can overwhelm switches and hosts, causing them to process excessive broadcast traffic. Can also be used to fill a switch's MAC address table (CAM table overflow), forcing it to flood all traffic like a hub â€” enabling passive sniffing.</div>
        <div class="sec-example">
          Attack rate: thousands of ARP requests/sec<br>
          Result: <span class="hi">switch behaves as hub</span> â€” all traffic visible<br>
          Tool: arpspoof, ettercap, Scapy
        </div>
      </div>
      <div class="sec-card defense">
        <div class="sec-icon">ğŸ›¡ï¸</div>
        <span class="sec-badge badge-defense">Defense</span>
        <div class="sec-name">Dynamic ARP Inspection (DAI)</div>
        <div class="sec-desc">A Cisco switch feature that intercepts ARP packets and validates them against a DHCP snooping binding table (IP-to-MAC-to-port mappings). Packets that don't match the binding table are dropped. Trusted ports (uplinks) bypass inspection; untrusted ports (access) are inspected.</div>
        <div class="sec-example">
          <span class="ok">Trusted port</span>: ARP passes through unchecked<br>
          <span class="hi">Untrusted port</span>: ARP validated vs DHCP table<br>
          Config: ip arp inspection vlan [vlan-id]
        </div>
      </div>
      <div class="sec-card defense">
        <div class="sec-icon">ğŸ”</div>
        <span class="sec-badge badge-defense">Defense</span>
        <div class="sec-name">Static ARP Entries</div>
        <div class="sec-desc">Manually configuring permanent ARP entries for critical hosts (routers, servers, DNS) prevents those entries from being overwritten by malicious ARP replies. Less scalable but very effective for protecting high-value fixed-IP assets on the network.</div>
        <div class="sec-example">
          Windows: arp -s 192.168.1.1 AA-BB-CC-DD-EE-FF<br>
          Linux:   arp -s 192.168.1.1 AA:BB:CC:DD:EE:FF<br>
          <span class="ok">Static entries cannot be overwritten by ARP replies</span>
        </div>
      </div>
      <div class="sec-card detection">
        <div class="sec-icon">ğŸ”</div>
        <span class="sec-badge badge-detection">Detection</span>
        <div class="sec-name">ARP Anomaly Detection</div>
        <div class="sec-desc">Monitoring tools like ARPwatch, Wireshark, and IDS systems watch for suspicious ARP behavior: duplicate IP-to-MAC mappings, unsolicited ARP replies (gratuitous ARP floods), rapid cache changes, and MAC addresses claiming multiple IPs.</div>
        <div class="sec-example">
          Indicator: One MAC â†’ multiple IPs (spoofing)<br>
          Indicator: <span class="hi">Unsolicited ARP Reply</span> (gratuitous)<br>
          Tool: arpwatch, XArp, Wireshark arp filter
        </div>
      </div>
      <div class="sec-card detection">
        <div class="sec-icon">ğŸ“‹</div>
        <span class="sec-badge badge-detection">Detection</span>
        <div class="sec-name">Gratuitous ARP</div>
        <div class="sec-desc">A Gratuitous ARP is an ARP Reply sent without a preceding Request. Legitimate uses: announcing a new MAC after a NIC replacement, IP conflict detection at boot, and VRRP/HSRP failover. Malicious use: silently poisoning caches across the network segment.</div>
        <div class="sec-example">
          Legit: Host announcing new MAC after failover<br>
          <span class="hi">Malicious</span>: Attacker broadcasting fake IPâ†’MAC<br>
          THA = FF:FF:FF:FF:FF:FF (broadcast target)
        </div>
      </div>
    </div>
  </div>

  <!-- â•â• COMPARISON TABLE â•â• -->
  <div class="compare-section reveal">
    <div class="section-header">
      <div class="section-icon">âš–ï¸</div>
      <div class="section-title">ARP vs RARP vs Gratuitous ARP
        <small>The three main ARP-family operations compared</small>
      </div>
    </div>
    <table class="compare-table">
      <thead>
        <tr>
          <th>Feature</th>
          <th class="arp-col">ğŸ” ARP</th>
          <th class="rarp-col">â†©ï¸ RARP</th>
          <th class="garp-col">ğŸ“£ Gratuitous ARP</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Direction</td><td>IP â†’ MAC</td><td>MAC â†’ IP</td><td>Self-announcement</td></tr>
        <tr><td>Operation Code</td><td>1 (Request) / 2 (Reply)</td><td>3 (Request) / 4 (Reply)</td><td>2 (Reply, unsolicited)</td></tr>
        <tr><td>Who Sends</td><td>Any host needing MAC</td><td>Diskless workstation</td><td>Host announcing itself</td></tr>
        <tr><td>Broadcast?</td><td><span class="good">Request = broadcast</span></td><td><span class="good">Request = broadcast</span></td><td><span class="warn">Reply = broadcast</span></td></tr>
        <tr><td>SPA Value</td><td>Sender's known IP</td><td>0.0.0.0 (unknown)</td><td>Sender's IP (self)</td></tr>
        <tr><td>THA Value</td><td>00:00:00:00:00:00</td><td>Same as SHA</td><td>FF:FF:FF:FF:FF:FF</td></tr>
        <tr><td>TPA Value</td><td>IP being resolved</td><td>0.0.0.0 in req / filled in reply</td><td>Sender's own IP</td></tr>
        <tr><td>ARP Cache Update</td><td><span class="good">Yes â€” fills cache</span></td><td><span class="bad">No cache involvement</span></td><td><span class="warn">Forces cache update</span></td></tr>
        <tr><td>Security Risk</td><td><span class="warn">Can be poisoned</span></td><td><span class="bad">Obsolete â€” DHCP used instead</span></td><td><span class="bad">Primary poisoning vector</span></td></tr>
        <tr><td>Legitimate Use</td><td>Normal Layer-2 operation</td><td>Legacy diskless boot</td><td>Failover, IP conflict detection</td></tr>
      </tbody>
    </table>
  </div>

  <!-- â•â• QUIZ â•â• -->
  <div class="reveal">
    <div class="section-header">
      <div class="section-icon">ğŸ§ </div>
      <div class="section-title">Knowledge Check Quiz
        <small>Test your understanding of ARP, cache poisoning, and address resolution</small>
      </div>
    </div>
    <div class="quiz-section">
      <div class="quiz-header">
        <div class="quiz-title">ARP Protocol Quiz</div>
        <div class="quiz-score">Score: <span id="score-display">0</span> / <span id="total-display">0</span></div>
      </div>
      <div class="quiz-body">
        <div class="progress-bar"><div class="progress-fill" id="quiz-progress" style="width:0%"></div></div>
        <div class="question-text" id="question-text"></div>
        <div class="options" id="options-container"></div>
        <div class="quiz-feedback" id="quiz-feedback"></div>
        <div class="quiz-nav">
          <div class="q-counter" id="q-counter"></div>
          <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" style="display:none;">Next Question â†’</button>
        </div>
      </div>
    </div>
  </div>

</div>

<footer>Â© 2024 ARP Protocol Analysis Â· Moraine Valley Community College &nbsp;|&nbsp; Network Security Curriculum</footer>

<script>
// â”€â”€ FIELD DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const fieldData = {
  htype: {
    title: 'ğŸ”Œ Hardware Type â€” 16 bits', color: '#0077aa',
    desc: 'Specifies the type of link-layer network hardware. For Ethernet (the dominant technology), this value is 1. The ARP specification is intentionally hardware-agnostic â€” the same packet format works over Token Ring, Wi-Fi, InfiniBand, and others by simply changing this value and HLen. The values are maintained by IANA.',
    example: '0x0001 â€” Ethernet (most common)\n0x0006 â€” IEEE 802 Networks\n0x000F â€” Frame Relay\n0x0011 â€” HDLC\n0x0017 â€” Serial Line\n\n# ARP EtherType in the Ethernet frame: 0x0806\n# (separate from Hardware Type field)'
  },
  ptype: {
    title: 'ğŸŒ Protocol Type â€” 16 bits', color: '#2563a8',
    desc: 'Specifies the protocol address type being resolved. Uses the same numbering as Ethernet EtherType values. For IPv4, this is 0x0800. IPv6 uses NDP (Neighbor Discovery Protocol) instead of ARP, though some implementations use 0x86DD here. This field tells the recipient how to interpret the SPA and TPA fields.',
    example: '0x0800 â€” IPv4 (standard ARP use)\n0x0805 â€” X.25\n0x8100 â€” 802.1Q VLAN (rare)\n\n# IPv6 does NOT use ARP â€” uses ICMPv6 NDP\n# ARP over IPv4 remains the only common use'
  },
  hlen: {
    title: 'ğŸ“ Hardware Length â€” 8 bits', color: '#007a7a',
    desc: 'The length in bytes of each hardware address in this packet. For Ethernet, MAC addresses are 6 bytes (48 bits), so HLen = 6. This value determines the size of the SHA and THA fields. The packet format supports variable-length hardware addresses, though Ethernet\'s 6-byte MAC is virtually universal.',
    example: '6  â€” Ethernet MAC (48 bits, 6 bytes)\n1  â€” Token Ring (1-byte addresses, historical)\n\n# Both SHA and THA are exactly HLen bytes\n# ARP packet total size = 8 + 2*HLen + 2*PLen\n# For Ethernet+IPv4: 8 + 12 + 8 = 28 bytes'
  },
  plen: {
    title: 'ğŸ“ Protocol Length â€” 8 bits', color: '#3a8080',
    desc: 'The length in bytes of each protocol address. For IPv4, addresses are 4 bytes (32 bits), so PLen = 4. This allows ARP to support protocols with different address sizes â€” for example, IPv6 addresses are 16 bytes (though IPv6 uses NDP rather than ARP). Both SPA and TPA are exactly PLen bytes.',
    example: '4  â€” IPv4 (32-bit addresses, 4 bytes)\n16 â€” IPv6 (128-bit addresses, 16 bytes â€” theoretical)\n\n# For standard ARP: HLen=6, PLen=4\n# Packet: [8 fixed bytes] + [6+4+6+4 = 20 bytes]\n# Total: 28 bytes'
  },
  oper: {
    title: 'âš¡ Operation (OPER) â€” 16 bits', color: '#7744bb',
    desc: 'Identifies whether this is an ARP Request (1) or ARP Reply (2). ARP Requests are broadcast to FF:FF:FF:FF:FF:FF â€” every device on the local segment receives them. Only the host whose IP matches TPA sends a Reply. ARP Replies are unicast directly to the requester\'s MAC. RARP uses codes 3 and 4.',
    example: '1 â€” ARP Request  (broadcast: "Who has TPA? Tell SPA")\n2 â€” ARP Reply    (unicast: "TPA is at [my MAC]")\n3 â€” RARP Request (legacy diskless boot)\n4 â€” RARP Reply   (legacy)\n\n# Gratuitous ARP uses Op=2 (Reply) without a request\n# Sent to broadcast to update everyone\'s ARP cache'
  },
  sha: {
    title: 'ğŸ–¥ï¸ Sender Hardware Address (SHA) â€” 48 bits', color: '#1a7f37',
    desc: 'The MAC address of the device sending this ARP packet. In a Request, SHA is the MAC of the requester â€” this allows the recipient to update their own ARP cache immediately upon receiving the request (a common optimization). In a Reply, SHA is the MAC being provided as the answer. In ARP poisoning attacks, a forged SHA is used to associate the attacker\'s MAC with a victim\'s IP.',
    example: '# ARP Request (from 192.168.1.10):\nSHA = AA:BB:CC:DD:EE:01   â† My MAC address\nSPA = 192.168.1.10         â† My IP address\n\n# ARP Reply (from 192.168.1.20):\nSHA = AA:BB:CC:DD:EE:02   â† THIS is the answer\nSPA = 192.168.1.20         â† My IP (confirming)\n\n# Cache poisoning:\nSHA = DE:AD:BE:EF:00:01   â† Attacker spoofs SHA'
  },
  spa: {
    title: 'ğŸ“ Sender Protocol Address (SPA) â€” 32 bits', color: '#3a7030',
    desc: 'The IPv4 address of the ARP packet sender. Unlike RARP, in ARP the sender always knows its own IP â€” SPA is always a known, valid address. When a host receives any ARP packet (including Requests), it may update its ARP cache with the SPAâ†’SHA mapping if it already has an entry for that IP, or if the packet is a Reply directed to it. This "passive learning" is also exploited in poisoning attacks.',
    example: '# In ARP Request:\nSPA = 192.168.1.10  â† Requester\'s IP (known)\n# Recipients who already have 192.168.1.10 in cache\n# will silently update it with SHA\'s MAC\n\n# Key for cache poisoning:\n# Attacker sets SPA = victim\'s IP\n# Recipients update cache: victim IP â†’ attacker MAC'
  },
  tha: {
    title: 'ğŸ¯ Target Hardware Address (THA) â€” 48 bits', color: '#d94f00',
    desc: 'The MAC address of the ARP target. In a Request, THA is set to 00:00:00:00:00:00 (unknown â€” that\'s what we\'re trying to find out). In a Reply, THA contains the MAC address of the original requester, so the reply is addressed back to the correct device. In a Gratuitous ARP, THA is FF:FF:FF:FF:FF:FF (broadcast) to update all devices on the segment.',
    example: '# ARP Request:\nTHA = 00:00:00:00:00:00   â† Unknown (being asked)\n\n# ARP Reply:\nTHA = AA:BB:CC:DD:EE:01   â† Addressed to requester\n\n# Gratuitous ARP:\nTHA = FF:FF:FF:FF:FF:FF   â† Broadcast to everyone\n# Forces all devices to update their ARP cache'
  },
  tpa: {
    title: 'âœ‰ï¸ Target Protocol Address (TPA) â€” 32 bits', color: '#b03a00',
    desc: 'The IPv4 address of the ARP target. In a Request, TPA is the IP address whose MAC we want to find â€” this is the core question being asked. Every device on the local segment receives the broadcast Request and compares TPA to its own IP. Only the matching host sends a Reply. In a Reply, TPA is the IP of the original requester. TPA in Gratuitous ARP is the announcer\'s own IP.',
    example: '# ARP Request (from 192.168.1.10):\nTPA = 192.168.1.20   â† "Who has THIS IP?"\n\n# ARP Reply (from 192.168.1.20):\nTPA = 192.168.1.10   â† "Sending reply to THIS IP"\n\n# Gratuitous ARP:\nTPA = 192.168.1.20   â† Announcer\'s own IP\n# = SPA (both fields = self IP)'
  }
};

let activeField = null;
function toggleField(id) {
  const panel = document.getElementById('field-detail');
  const field = document.getElementById('hf-' + id);
  if (activeField === id) { panel.classList.remove('show'); field.classList.remove('active'); activeField = null; return; }
  if (activeField) document.getElementById('hf-' + activeField).classList.remove('active');
  activeField = id;
  const d = fieldData[id];
  field.classList.add('active');
  document.getElementById('detail-title').innerHTML = `<span style="color:${d.color}">${d.title}</span>`;
  document.getElementById('detail-desc').textContent = d.desc;
  document.getElementById('detail-example').innerHTML = d.example.replace(/\n/g,'<br>').replace(/#.*/g, m=>`<span style="color:var(--text-muted)">${m}</span>`);
  panel.classList.remove('show'); void panel.offsetWidth; panel.classList.add('show');
  setTimeout(()=>panel.scrollIntoView({behavior:'smooth',block:'nearest'}),50);
}
document.querySelectorAll('.header-field').forEach(el=>{
  el.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){e.preventDefault();el.click();} });
});

// â”€â”€ EXCHANGE ANIMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const exSteps = document.querySelectorAll('.ex-step');
function runExchange() { exSteps.forEach((s,i)=>setTimeout(()=>s.classList.add('visible'),300+i*700)); }
function replayExchange() { exSteps.forEach(s=>s.classList.remove('visible')); setTimeout(runExchange,100); }
const exObs = new IntersectionObserver(entries=>{ if(entries[0].isIntersecting){runExchange();exObs.disconnect();} },{threshold:.2});
const exSection = document.querySelector('.exchange-section');
if(exSection) exObs.observe(exSection);

// â”€â”€ ARP CACHE SIMULATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ARP_DB = {
  '192.168.1.20': { mac:'AA:BB:CC:DD:EE:02', host:'Host-B',   iface:'eth0' },
  '192.168.1.30': { mac:'AA:BB:CC:DD:EE:03', host:'Host-C',   iface:'eth0' },
  '192.168.1.40': { mac:'AA:BB:CC:DD:EE:04', host:'Host-D',   iface:'eth0' },
  '192.168.1.1' : { mac:'00:11:22:33:44:55', host:'Gateway',  iface:'eth0' },
};
const ATTACKER_MAC = 'DE:AD:BE:EF:00:01';
const TTL_MAX = 300;

let arpCache = {};  // ip â†’ { mac, type, ttl, iface, poisoned }
let logEntries = [];
let autoTimer = null;
let logSeq = 0;

function timeStr() {
  const d = new Date();
  return [d.getHours(),d.getMinutes(),d.getSeconds()].map(n=>String(n).padStart(2,'0')).join(':');
}
function addLog(type, msg) {
  logEntries.push({type, msg, time: timeStr()});
  if(logEntries.length>120) logEntries.shift();
  renderLog();
}
function renderLog() {
  const el = document.getElementById('arp-log');
  if(!logEntries.length){ el.innerHTML='<div class="log-empty">No transactions yet</div>'; return; }
  el.innerHTML = [...logEntries].reverse().map(e=>
    `<div class="arp-log-entry">
      <span class="log-time">${e.time}</span>
      <span class="log-badge badge-${e.type}">${e.type.toUpperCase()}</span>
      <span class="log-msg">${e.msg}</span>
    </div>`
  ).join('');
}

function renderCache(highlight, poisonIp) {
  const tbody = document.getElementById('cache-tbody');
  const entries = Object.entries(arpCache);
  if(!entries.length){
    tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;padding:24px;color:var(--text-muted);font-family:'DM Sans',sans-serif">ARP cache is empty</td></tr>`;
    return;
  }
  tbody.innerHTML = entries.map(([ip, e])=>{
    const isNew    = ip === highlight && !e.poisoned;
    const isPoison = ip === poisonIp  &&  e.poisoned;
    const pct      = Math.round((e.ttl/TTL_MAX)*100);
    const ttlColor = pct>60?'var(--safe)':pct>30?'var(--warning)':'var(--danger)';
    return `<tr class="${isNew?'new-row':''} ${isPoison?'poison-row':''}">
      <td class="ip-cell">${ip}</td>
      <td class="mac-cell ${e.poisoned?'poisoned':''}">${e.mac}</td>
      <td><span class="type-pill ${e.poisoned?'type-poison':e.type==='static'?'type-static':'type-dyn'}">${e.poisoned?'POISON':e.type}</span></td>
      <td class="ttl-bar-wrap">
        <div class="ttl-bar"><div class="ttl-fill" style="width:${pct}%;background:${ttlColor}"></div></div>
        <span class="ttl-val">${e.ttl}s</span>
      </td>
      <td style="color:var(--text-muted);font-size:.72rem">${e.iface}</td>
    </tr>`;
  }).join('');
}

function sendArpRequest() {
  const ip = document.getElementById('sim-ip').value;
  const resultEl = document.getElementById('lookup-result');

  // Cache hit?
  if(arpCache[ip] && !arpCache[ip].poisoned){
    addLog('hit', `ARP cache HIT for ${ip} â†’ ${arpCache[ip].mac} (no broadcast needed)`);
    resultEl.className = 'lookup-result show hit';
    resultEl.innerHTML = `
      <div class="result-title hit">âœ“ ARP Cache HIT â€” No Broadcast Required</div>
      <div class="result-flow">
        <div class="result-box"><div class="result-box-label">Target IP</div><div class="result-box-val val-ip">${ip}</div></div>
        <div class="result-arrow">â†’<span>cache lookup</span></div>
        <div class="result-box"><div class="result-box-label">Resolved MAC</div><div class="result-box-val val-mac">${arpCache[ip].mac}</div></div>
        <div class="result-box"><div class="result-box-label">TTL Remaining</div><div class="result-box-val">${arpCache[ip].ttl}s</div></div>
      </div>
      <div style="margin-top:10px;font-size:.8rem;color:var(--text-muted)">The ARP cache already has an entry for <strong>${ip}</strong>. No ARP broadcast is needed â€” the frame can be sent immediately to <strong>${arpCache[ip].mac}</strong>.</div>`;
    renderCache(ip, null);
    return;
  }

  const entry = ARP_DB[ip];
  addLog('req', `ARP Request broadcast â€” "Who has ${ip}? Tell 192.168.1.10"`);

  setTimeout(()=>{
    if(entry){
      addLog('rep', `ARP Reply received â€” ${ip} is at ${entry.mac}`);
      arpCache[ip] = { mac: entry.mac, type: 'dynamic', ttl: TTL_MAX - Math.floor(Math.random()*30), iface: 'eth0', poisoned: false };
      resultEl.className = 'lookup-result show hit';
      resultEl.innerHTML = `
        <div class="result-title hit">âœ“ ARP Reply Received â€” Cache Updated</div>
        <div class="result-flow">
          <div class="result-box"><div class="result-box-label">Target IP (TPA)</div><div class="result-box-val val-ip">${ip}</div></div>
          <div class="result-arrow">â†’<span>ARP Request<br>broadcast</span></div>
          <div class="result-box"><div class="result-box-label">Resolved MAC (SHA)</div><div class="result-box-val val-mac">${entry.mac}</div></div>
          <div class="result-arrow">â†’<span>cached</span></div>
          <div class="result-box"><div class="result-box-label">Host</div><div class="result-box-val">${entry.host}</div></div>
        </div>
        <div style="margin-top:10px;font-size:.8rem;color:var(--text-muted)">
          <strong>${ip}</strong> replied with MAC <strong>${entry.mac}</strong>. This mapping is now cached for ${arpCache[ip].ttl} seconds. Future packets to ${ip} will use this MAC directly â€” no broadcast needed until the cache entry expires.
        </div>`;
      renderCache(ip, null);
    } else {
      addLog('req', `No ARP Reply for ${ip} â€” host unreachable or does not exist`);
      resultEl.className = 'lookup-result show miss';
      resultEl.innerHTML = `
        <div class="result-title miss">âœ— No ARP Reply â€” Host Unreachable</div>
        <div class="result-flow">
          <div class="result-box"><div class="result-box-label">Target IP</div><div class="result-box-val val-ip">${ip}</div></div>
          <div class="result-arrow">â†’<span>ARP Request broadcast</span></div>
          <div class="result-box"><div class="result-box-label">Response</div><div class="result-box-val" style="color:var(--danger)">No Reply</div></div>
        </div>
        <div style="margin-top:10px;font-size:.8rem;color:var(--text-muted)">No device on the local segment claimed ownership of <strong>${ip}</strong>. The ARP cache is not updated. The sending application will receive a "host unreachable" error.</div>`;
      renderCache(null, null);
    }
  }, 500);
}

function poisonCache() {
  const ip = document.getElementById('sim-ip').value;
  if(ip === '192.168.1.99'){ alert('Cannot poison an unknown/non-existent host.'); return; }

  addLog('poison', `âš  Gratuitous ARP (spoofed) â€” "${ip} is at ${ATTACKER_MAC}" [ATTACK]`);
  arpCache[ip] = { mac: ATTACKER_MAC, type: 'dynamic', ttl: TTL_MAX, iface: 'eth0', poisoned: true };

  const resultEl = document.getElementById('lookup-result');
  resultEl.className = 'lookup-result show poison';
  resultEl.innerHTML = `
    <div class="result-title poison">â˜  ARP Cache POISONED â€” Man-in-the-Middle Attack</div>
    <div class="result-flow">
      <div class="result-box"><div class="result-box-label">Legitimate IP</div><div class="result-box-val val-ip">${ip}</div></div>
      <div class="result-arrow">â†’<span>spoofed ARP reply</span></div>
      <div class="result-box"><div class="result-box-label">Forged MAC (Attacker)</div><div class="result-box-val val-poison">${ATTACKER_MAC}</div></div>
    </div>
    <div style="margin-top:10px;font-size:.8rem;color:var(--text-muted)">
      An attacker sent an unsolicited Gratuitous ARP Reply claiming <strong>${ip}</strong> is at <strong>${ATTACKER_MAC}</strong>. Your ARP cache now maps this IP to the attacker's MAC. All traffic destined for <strong>${ip}</strong> will be sent to the attacker instead â€” enabling a man-in-the-middle attack.<br><br>
      <strong>Defense:</strong> Dynamic ARP Inspection (DAI) or static ARP entries can prevent this.
    </div>`;
  renderCache(null, ip);
}

// Auto-demo cycles through lookups and occasionally poisons
const AUTO_IPS = ['192.168.1.20','192.168.1.30','192.168.1.40','192.168.1.1'];
let autoStep = 0;
function toggleAuto() {
  const btn = document.getElementById('auto-btn');
  if(autoTimer){
    clearInterval(autoTimer); autoTimer=null;
    btn.textContent='âš¡ Auto-Demo'; btn.classList.remove('running');
  } else {
    btn.textContent='â¹ Stop Auto'; btn.classList.add('running');
    autoTimer = setInterval(()=>{
      const ip = AUTO_IPS[autoStep % AUTO_IPS.length];
      document.getElementById('sim-ip').value = ip;
      if(autoStep > 0 && autoStep % 5 === 0 && Math.random() > .6) {
        poisonCache();
      } else {
        sendArpRequest();
      }
      autoStep++;
      // Tick down TTLs
      Object.keys(arpCache).forEach(k=>{ if(arpCache[k].ttl>0) arpCache[k].ttl-=8; if(arpCache[k].ttl<=0) delete arpCache[k]; });
      renderCache(null,null);
    }, 1800);
  }
}

function clearSim() {
  if(autoTimer){ clearInterval(autoTimer); autoTimer=null; document.getElementById('auto-btn').textContent='âš¡ Auto-Demo'; document.getElementById('auto-btn').classList.remove('running'); }
  arpCache={}; logEntries=[]; autoStep=0;
  renderLog(); renderCache(null,null);
  document.getElementById('lookup-result').className='lookup-result';
}

renderCache(null,null);

// â”€â”€ QUIZ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const questions = [
  {
    q: "What is the primary purpose of ARP (Address Resolution Protocol)?",
    opts: [
      "Assign IP addresses dynamically to hosts on a network",
      "Resolve a known IP address to its corresponding MAC address on a local segment",
      "Route packets between different IP subnets",
      "Encrypt traffic between two hosts on the same LAN"
    ],
    ans: 1,
    exp: "ARP resolves a known IP address to an unknown MAC address. Before a host can send an Ethernet frame to another device, it must know that device's MAC address â€” ARP discovers it via a broadcast."
  },
  {
    q: "An ARP Request is sent as a <em>broadcast</em>. What is the destination MAC in the Ethernet frame?",
    opts: [
      "00:00:00:00:00:00 (null MAC)",
      "The target host's known MAC",
      "FF:FF:FF:FF:FF:FF (broadcast address)",
      "The gateway's MAC address"
    ],
    ans: 2,
    exp: "ARP Requests use the Ethernet broadcast address FF:FF:FF:FF:FF:FF so every device on the local segment receives and processes the request. Only the device whose IP matches TPA responds."
  },
  {
    q: "In an ARP Request, what value is placed in the <em>Target Hardware Address (THA)</em> field?",
    opts: [
      "FF:FF:FF:FF:FF:FF (broadcast)",
      "The sender's own MAC address",
      "00:00:00:00:00:00 (unknown/zeroes)",
      "The gateway's MAC address"
    ],
    ans: 2,
    exp: "THA is set to all zeroes (00:00:00:00:00:00) in a Request because the purpose of the ARP Request is to discover this unknown MAC address. The receiving host fills in SHA of its Reply with the answer."
  },
  {
    q: "What is <em>ARP Cache Poisoning</em>?",
    opts: [
      "Flooding the network with excessive ARP Requests to degrade performance",
      "An attacker sending forged ARP Replies to associate their MAC with a legitimate IP, enabling man-in-the-middle attacks",
      "Corrupting the ARP protocol header checksum to cause packet drops",
      "Overloading the ARP server with requests until it crashes"
    ],
    ans: 1,
    exp: "ARP Cache Poisoning (ARP Spoofing) involves sending unsolicited Gratuitous ARP Replies with a forged SHA, tricking victims into updating their cache to map a legitimate IP to the attacker's MAC. Traffic is then redirected to the attacker."
  },
  {
    q: "What Cisco switch security feature validates ARP packets against a DHCP snooping table to prevent ARP poisoning?",
    opts: [
      "Port Security",
      "Storm Control",
      "Dynamic ARP Inspection (DAI)",
      "DHCP Option 82"
    ],
    ans: 2,
    exp: "Dynamic ARP Inspection (DAI) intercepts ARP packets on untrusted ports and validates the IP-to-MAC mapping against the DHCP snooping binding table. Packets that don't match are dropped, blocking ARP poisoning attacks."
  },
  {
    q: "A <em>Gratuitous ARP</em> is sent when:",
    opts: [
      "A host needs to look up the MAC of a new gateway",
      "A host sends an ARP Reply without a preceding Request, announcing its own IP-to-MAC mapping",
      "A host receives an ARP Request it cannot answer",
      "A DHCP server assigns a new IP address to a client"
    ],
    ans: 1,
    exp: "A Gratuitous ARP is an unsolicited ARP Reply sent by a host to announce its own IP-to-MAC mapping to all devices on the segment. Legitimate uses include failover detection and IP conflict checking. Malicious use: cache poisoning."
  },
  {
    q: "ARP operates at which layers of the OSI model?",
    opts: [
      "Layer 7 (Application) only",
      "Layer 3 (Network) only",
      "Layer 4 (Transport) and Layer 3 (Network)",
      "Between Layer 2 (Data Link) and Layer 3 (Network)"
    ],
    ans: 3,
    exp: "ARP bridges Layer 2 (Data Link / MAC addresses) and Layer 3 (Network / IP addresses). It resolves Layer-3 IP addresses to Layer-2 MAC addresses, and is technically a Layer 2.5 or inter-layer protocol."
  },
  {
    q: "How does ARP differ from RARP in the direction of address resolution?",
    opts: [
      "ARP resolves MAC â†’ IP; RARP resolves IP â†’ MAC",
      "ARP resolves IP â†’ MAC; RARP resolves MAC â†’ IP",
      "Both protocols resolve IP â†’ MAC but use different operation codes",
      "ARP works across routers; RARP is limited to a single host"
    ],
    ans: 1,
    exp: "ARP resolves a known IP address to an unknown MAC address (IPâ†’MAC). RARP does the reverse: a diskless device broadcasts its known MAC address to discover its unknown IP address (MACâ†’IP). RARP has been replaced by DHCP."
  }
];

let current=0, score=0, answered=0;
function renderQuestion(){
  const q=questions[current];
  document.getElementById('question-text').innerHTML=`<strong>Q${current+1}.</strong> ${q.q}`;
  document.getElementById('q-counter').textContent=`Question ${current+1} of ${questions.length}`;
  document.getElementById('quiz-progress').style.width=`${(current/questions.length)*100}%`;
  document.getElementById('next-btn').style.display='none';
  const fb=document.getElementById('quiz-feedback'); fb.className='quiz-feedback'; fb.textContent='';
  const c=document.getElementById('options-container'); c.innerHTML='';
  ['A','B','C','D'].forEach((l,i)=>{
    if(q.opts[i]===undefined) return;
    const b=document.createElement('div'); b.className='option';
    b.innerHTML=`<span class="option-letter">${l}</span><span>${q.opts[i]}</span>`;
    b.onclick=()=>selectAnswer(i,q.ans,q.exp);
    c.appendChild(b);
  });
}
function selectAnswer(sel,correct,exp){
  document.querySelectorAll('.option').forEach((o,i)=>{ o.classList.add('disabled'); o.onclick=null; if(i===correct) o.classList.add('correct'); else if(i===sel) o.classList.add('wrong'); });
  answered++; if(sel===correct) score++;
  document.getElementById('score-display').textContent=score;
  document.getElementById('total-display').textContent=answered;
  const fb=document.getElementById('quiz-feedback');
  fb.className=`quiz-feedback show ${sel===correct?'correct':'wrong'}`;
  fb.textContent=(sel===correct?'âœ“ Correct! ':'âœ— Incorrect. ')+exp;
  document.getElementById('quiz-progress').style.width=`${((current+1)/questions.length)*100}%`;
  const nb=document.getElementById('next-btn');
  nb.textContent=current<questions.length-1?'Next Question â†’':'ğŸ View Results';
  nb.onclick=current<questions.length-1?nextQuestion:showResults;
  nb.style.display='';
}
function nextQuestion(){ current++; renderQuestion(); }
function showResults(){
  const pct=Math.round((score/questions.length)*100);
  const grade=pct>=90?'Excellent! ğŸ†':pct>=70?'Good Job! ğŸ‘':pct>=50?'Keep Studying! ğŸ“š':'Review the ARP materials ğŸ”';
  document.querySelector('.quiz-body').innerHTML=`
    <div style="text-align:center;padding:30px 0">
      <div style="font-size:3.5rem;margin-bottom:16px">${pct>=80?'ğŸ‰':pct>=60?'ğŸ‘':'ğŸ“š'}</div>
      <div style="font-family:'Syne',sans-serif;font-size:2.5rem;font-weight:800;color:var(--accent);margin-bottom:8px">${pct}%</div>
      <div style="font-size:1.1rem;color:var(--text);margin-bottom:8px">${grade}</div>
      <div style="color:var(--text-muted);font-size:.9rem;margin-bottom:28px">You scored ${score} out of ${questions.length} questions correctly.</div>
      <button class="btn btn-primary" onclick="restartQuiz()">â†º Retake Quiz</button>
    </div>`;
}
function restartQuiz(){
  current=0;score=0;answered=0;
  document.getElementById('score-display').textContent='0';
  document.getElementById('total-display').textContent='0';
  document.querySelector('.quiz-body').innerHTML=`
    <div class="progress-bar"><div class="progress-fill" id="quiz-progress" style="width:0%"></div></div>
    <div class="question-text" id="question-text"></div>
    <div class="options" id="options-container"></div>
    <div class="quiz-feedback" id="quiz-feedback"></div>
    <div class="quiz-nav">
      <div class="q-counter" id="q-counter"></div>
      <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" style="display:none;">Next Question â†’</button>
    </div>`;
  renderQuestion();
}
renderQuestion();

// â”€â”€ SCROLL REVEAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const observer=new IntersectionObserver(entries=>{entries.forEach(e=>{if(e.isIntersecting) e.target.classList.add('visible');});},{threshold:.05});
document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));
</script>
</body>
</html>
